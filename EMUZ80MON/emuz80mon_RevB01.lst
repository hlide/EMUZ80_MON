 AS V1.42 Beta [Bld 227] - Source File emuz80mon_RevB01.asm - Page 1 - 10/4/2022 8:52:20


       1/       0 :                     	page	0
       2/       0 :                     	cpu	z80
       3/       0 :                     ;;; 
       4/       0 :                     ;;; Universal Monitor for Zilog Z80
       5/       0 :                     ;;;   Copyright (C) 2019,2020,2021 Haruo Asano
       6/       0 :                     ;;;
       7/       0 :                     
       8/       0 :                     ;;; 2022.10.1 It was added functions by A.honda
       9/       0 :                     ;;; Rev.B01
      10/       0 :                     
      11/       0 :                     ;;; Constants
      12/       0 : =0DH                 CR	EQU	0DH
      13/       0 : =0AH                 LF	EQU	0AH
      14/       0 : =8H                  BS	EQU	08H
      15/       0 : =7FH                 DEL	EQU	7FH
      16/       0 : =20H                 BUFLEN	equ	32	
      17/       0 : =8H                  F_bitSize	equ	8
      18/       0 :                     ;;;
      19/       0 :                     ;;; Memory switch
      20/       0 :                     ;;;
      21/       0 :                     
      22/       0 : =1H                  RAM12K = 1
      23/       0 : =0H                  RAM8K = 0
      24/       0 : =0H                  RAM4K = 0
      25/       0 :                     
      26/       0 : =>TRUE               	IF	RAM12K
      27/       0 :                     ;; ROM48K RAM12K for PIC18F47Q84
      28/       0 : =0FF00H              UARTDR	EQU	0FF00H	; UART DATA REGISTOR
      29/       0 : =0FF01H              UARTCR	EQU	0FF01H	; UART CONTROL REGISTOR
      30/       0 : =0EF00H              WORK_B	equ	0EF00H	; work area EF00-EFFF
      31/       0 : =0EF00H              STACKM	equ	0EF00H	; monitor stack
      32/       0 : =0EEC0H              STACK	equ	0EEC0H	; user stack
      33/       0 : =0H                  ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      34/       0 : =0C000H              RAM_B	equ	0C000H	;EMUZ80_Q84 RAM base address
      35/       0 : =0EFFFH              RAM_E	equ	0EFFFH	;EMUZ80_Q84 RAM END address
      36/       0 : =0F000H              IO_B	equ	0F000H	;EMUZ80_Q84 I/O base address
      37/       0 : [26]                 	ENDIF
      38/       0 :                     
      39/       0 : =>FALSE              	IF	RAM8K
      40/       0 :                     ; ORIGINAL MEMORY MAP for PIC18F47Q84
      41/       0 :                     UARTDR	EQU	0E000H	; UART DATA REGISTOR
      42/       0 :                     UARTCR	EQU	0E001H	; UART CONTROL REGISTOR
      43/       0 :                     WORK_B	equ	9F00H	; work area 9F00-9FFF
      44/       0 :                     STACKM	equ	9F00H	; monitor stack
      45/       0 :                     STACK	equ	8EC0H	; user stack
      46/       0 :                     ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      47/       0 :                     RAM_B	equ	8000H	;EMUZ80_Q84 RAM base address
      48/       0 :                     RAM_E	equ	9FFFH	;EMUZ80_Q84 RAM END address
      49/       0 :                     IO_B	equ	0E000H	;EMUZ80_Q84 I/O base address
      50/       0 : [39]                 	ENDIF
      51/       0 :                     
      52/       0 : =>FALSE              	IF	RAM4K
      53/       0 :                     ; ORIGINAL MEMORY MAP for PIC18F47Q43
      54/       0 :                     
      55/       0 :                     UARTDR	EQU	0E000H	; UART DATA REGISTOR
      56/       0 :                     UARTCR	EQU	0E001H	; UART CONTROL REGISTOR
      57/       0 :                     WORK_B	equ	8F00H	; work area 8F00-8FFF
      58/       0 :                     STACKM	equ	8F00H	; monitor stack
      59/       0 :                     STACK	equ	8EC0H	; user stack
      60/       0 :                     ROM_B	equ	0000H	;EMUZ80_Q43 ROM base address
      61/       0 :                     RAM_B	equ	8000H	;EMUZ80_Q43 RAM base address
      62/       0 :                     RAM_E	equ	9FFFH	;EMUZ80_Q43 RAM END address
      63/       0 :                     IO_B	equ	0E000H	;EMUZ80_Q43 I/O base address
      64/       0 : [52]                 	ENDIF
      65/       0 :                     
      66/       0 : =2000H               BASIC_TOP	equ	2000H
      67/       0 : =2000H               BASIC_CST	equ	2000H	; basic cold start
      68/       0 : =2003H               BASIC_WST	equ	2003H	; basic warm start
      69/       0 :                     
      70/       0 : =>TRUE               	IF	RAM12K
      71/       0 : =0F800H              TIM0_CTL0	equ	0F800H	; timer0 control0 register
      72/       0 : =0F801H              TIM0_CTL1	equ	0F801H	; timer0 control1 register
      73/       0 : =0F810H              TIMER0_CNTL	equ	0F810H	; timer0 16bit counter LSB
      74/       0 : =0F811H              TIMER0_CNTH	equ	0F811H	; timer0 16bit counter MSB
      75/       0 : =0F820H              TIMER0_SCTL	equ	0F820H	; timer0 seconds counter LSB
      76/       0 : =0F821H              TIMER0_SCTH	equ	0F821H	; timer0 seconds counter MSB
      77/       0 : =87E1H               TIMER0_INITC	equ	87e1h	; timer adjust count number
      78/       0 : [70]                 	ENDIF
      79/       0 :                     
      80/       0 : =40H                 ENTRY	EQU	0040H		; Entry point
      81/       0 :                     
      82/       0 :                     ;;; 
      83/       0 :                     ;;; ROM area
      84/       0 :                     ;;;
      85/       0 :                     start:
      86/       0 :                     
      87/       0 :                     	ORG	ROM_B	; (RST 00H)
      88/       0 :                     
      89/       0 :                     E_CSTART:
      90/       0 : C3 7B 00            	JP	CSTART
      91/       3 :                     
      92/       3 :                     E_WSTART:
      93/       3 : C3 39 0D            	JP	API01
      94/       6 :                     
      95/       6 : 00 00               	db	0008H - $ dup(00H)
      96/       8 :                     ;	ORG	0008H	; (RST 08H)
      97/       8 : C3 40 00            	JP	RST08H
      98/       B :                     
      99/       B : 00 00 00 00 00      	db	0010H - $ dup(00H)
     100/      10 :                     ;	ORG	0010H	; (RST 10H)
     101/      10 : C3 48 00            	JP	RST10H
     102/      13 :                     
     103/      13 : 00 00 00 00 00      	db	0018H - $ dup(00H)	; nop
     104/      18 :                     ;	ORG	0018H	; (RST 18H)
     105/      18 : C3 50 00            	JP	RST18H
     106/      1B :                     
     107/      1B : 00 00 00 00 00      	db	0020H - $ dup(00H)	; nop
     108/      20 :                     ;	ORG	0020H	; (RST 20H)
     109/      20 : C3 58 00            	JP	RST20H
     110/      23 :                     
     111/      23 : 00 00 00 00 00      	db	0028H - $ dup(00H)	; nop
     112/      28 :                     ;	ORG	0028H	; (RST 28H)
     113/      28 : C3 60 00            	JP	RST28H
     114/      2B :                     
     115/      2B : 00 00 00 00 00      	db	0030H - $ dup(00H)	; nop
     116/      30 :                     ;	ORG	0030H
     117/      30 : C3 68 00            	JP	RST30H
     118/      33 :                     
     119/      33 : 00 00 00 00 00      	db	0038H - $ dup(00H)	; nop
     120/      38 :                     ;	ORG	0038H
     121/      38 : C3 70 00            	JP	RST38H
     122/      3B :                     
     123/      3B :                     	;;
     124/      3B :                     	;; Entry point
     125/      3B :                     	;;
     126/      3B :                     
     127/      3B : 00 00 00 00 00      	db	ENTRY - $ dup(00H)
     128/      40 :                     	;	ORG	ENTRY
     129/      40 :                     ;;;
     130/      40 :                     ;;; RST 08H Handler
     131/      40 :                     ;;;
     132/      40 :                     RST08H:
     133/      40 :                     
     134/      40 : 22 0E EF            	ld	(save_hl), hl	; save hl
     135/      43 : 2A 00 EF            	ld	hl, (stealRST08)
     136/      46 : 18 2E               	jr	jmp_rst
     137/      48 :                     
     138/      48 :                     ;;;
     139/      48 :                     ;;; RST 10H Handler
     140/      48 :                     ;;;
     141/      48 :                     RST10H:
     142/      48 :                     
     143/      48 : 22 0E EF            	ld	(save_hl), hl	; save hl
     144/      4B : 2A 02 EF            	ld	hl, (stealRST10)
     145/      4E : 18 26               	jr	jmp_rst
     146/      50 :                     
     147/      50 :                     ;;;
     148/      50 :                     ;;; RST 18H Handler
     149/      50 :                     ;;;
     150/      50 :                     RST18H:
     151/      50 :                     
     152/      50 : 22 0E EF            	ld	(save_hl), hl	; save hl
     153/      53 : 2A 04 EF            	ld	hl, (stealRST18)
     154/      56 : 18 1E               	jr	jmp_rst
     155/      58 :                     
     156/      58 :                     ;;;
     157/      58 :                     ;;; RST 20H Handler
     158/      58 :                     ;;;
     159/      58 :                     RST20H:
     160/      58 :                     
     161/      58 : 22 0E EF            	ld	(save_hl), hl	; save hl
     162/      5B : 2A 06 EF            	ld	hl, (stealRST20)
     163/      5E : 18 16               	jr	jmp_rst
     164/      60 :                     
     165/      60 :                     ;;;
     166/      60 :                     ;;; RST 28H Handler
     167/      60 :                     ;;;
     168/      60 :                     RST28H:
     169/      60 :                     
     170/      60 : 22 0E EF            	ld	(save_hl), hl	; save hl
     171/      63 : 2A 08 EF            	ld	hl, (stealRST28)
     172/      66 : 18 0E               	jr	jmp_rst
     173/      68 :                     
     174/      68 :                     ;;;
     175/      68 :                     ;;; RST 30H Handler
     176/      68 :                     ;;;
     177/      68 :                     RST30H:
     178/      68 :                     
     179/      68 : 22 0E EF            	ld	(save_hl), hl	; save hl
     180/      6B : 2A 0A EF            	ld	hl, (stealRST30)
     181/      6E : 18 06               	jr	jmp_rst
     182/      70 :                     
     183/      70 :                     ;;;
     184/      70 :                     ;;; RST 38H Handler
     185/      70 :                     ;;;
     186/      70 :                     RST38H:
     187/      70 :                     
     188/      70 : 22 0E EF            	ld	(save_hl), hl	; save hl
     189/      73 : 2A 0C EF            	ld	hl, (stealRST38)
     190/      76 :                     jmp_rst:
     191/      76 : E5                  	push	hl		; set jump address
     192/      77 : 2A 0E EF            	ld	hl, (save_hl)	; restore hl
     193/      7A :                     RST20H_IN:
     194/      7A :                     RST28H_IN:
     195/      7A : C9                  	ret			; jump (stealRST38)
     196/      7B :                     
     197/      7B :                     ;;;
     198/      7B :                     ;;; Universal Monitor Z80 Cold start
     199/      7B :                     ;;;
     200/      7B :                     
     201/      7B :                     CSTART:
     202/      7B : F3                  	DI
     203/      7C : 31 00 EF            	LD	SP,STACKM	; monitor stask defines STACKM
     204/      7F :                     
     205/      7F : 21 00 C0            	LD	HL,RAM_B
     206/      82 : 22 30 EF            	LD	(DSADDR),HL
     207/      85 : 22 37 EF            	LD	(SADDR),HL
     208/      88 : 22 35 EF            	LD	(GADDR),HL
     209/      8B : 3E 49               	LD	A,'I'
     210/      8D : 32 39 EF            	LD	(HEXMOD),A
     211/      90 :                     	
     212/      90 :                     	; init back door RST XXH entory point
     213/      90 : 21 34 14            	ld	hl, CONOUT		; RST 08H : CONOUT
     214/      93 : 22 00 EF            	ld	(stealRST08), hl
     215/      96 : 21 23 14            	ld	hl, CONIN
     216/      99 : 22 02 EF            	ld	(stealRST10), hl	; RST 10H : CONIN
     217/      9C : 21 2E 14            	ld	hl, CONST
     218/      9F : 22 04 EF            	ld	(stealRST18), hl	; RST 18H : CONST
     219/      A2 : 21 7A 00            	ld	hl, RST20H_IN
     220/      A5 : 22 06 EF            	ld	(stealRST20), hl
     221/      A8 : 21 7A 00            	ld	hl, RST28H_IN
     222/      AB : 22 08 EF            	ld	(stealRST28), hl
     223/      AE : 21 FE 0C            	ld	hl, RST30H_IN
     224/      B1 : 22 0A EF            	ld	(stealRST30), hl
     225/      B4 : 21 7D 0D            	ld	hl, RST38H_IN
     226/      B7 : 22 0C EF            	ld	(stealRST38), hl
     227/      BA :                     
     228/      BA :                     	;; Initialize register value
     229/      BA : AF                  	XOR	A
     230/      BB : 21 3C EF            	LD	HL,REG_B
     231/      BE : 06 1A               	LD	B,REG_E-REG_B
     232/      C0 :                     IR0:
     233/      C0 : 77                  	LD	(HL),A
     234/      C1 : 23                  	INC	HL
     235/      C2 : 10 FC               	DJNZ	IR0
     236/      C4 :                     
     237/      C4 : 21 C0 EE            	LD	HL,STACK		; user stack define STACK
     238/      C7 : 22 50 EF            	LD	(REGSP),HL
     239/      CA : 21 00 C0            	ld	hl, RAM_B
     240/      CD : 22 52 EF            	ld	(REGPC), HL		; set program counter
     241/      D0 :                     
     242/      D0 : 06 08               	ld	b, F_bitSize
     243/      D2 : 3E 2E               	ld	a, '.'
     244/      D4 : 21 81 EF            	ld	hl, F_bit
     245/      D7 :                     ir00:
     246/      D7 : 77                  	ld	(hl), a
     247/      D8 : 23                  	inc	hl
     248/      D9 : 10 FC               	djnz	ir00		; init F_bit string
     249/      DB : AF                  	xor	a
     250/      DC : 77                  	ld	(hl), a		; delimiter
     251/      DD :                     ;
     252/      DD :                     ;	LD	B,100
     253/      DD :                     ;TL:	
     254/      DD :                     ;	XOR	A
     255/      DD :                     ;	CALL	CONOUT
     256/      DD :                     ;	DJNZ	TL
     257/      DD :                     ;
     258/      DD :                     	
     259/      DD :                     ; init dbg work area
     260/      DD :                     
     261/      DD : 06 14               	LD	B, dbg_wend - dbg_wtop
     262/      DF : 21 6D EF            	ld	hl,dbg_wtop	
     263/      E2 : AF                  	XOR	A
     264/      E3 :                     
     265/      E3 :                     dbg_wini:
     266/      E3 : 77                  	ld	(hl), a
     267/      E4 : 23                  	inc	hl
     268/      E5 : 10 FC               	DJNZ	dbg_wini
     269/      E7 :                     
     270/      E7 : 3E 49               	ld	a, 'I'
     271/      E9 : 32 67 EF            	ld	(TM_mode), a	; default call_in mode
     272/      EC : 3E 4E               	ld	a, 'N'
     273/      EE : 32 66 EF            	ld	(TP_mode), a	; default display reg mode
     274/      F1 : 2E 00               	ld	l, 0
     275/      F3 : 26 00               	ld	h, 0
     276/      F5 : 22 68 EF            	ld	(TC_cnt), hl	; clear trace step counter to 0
     277/      F8 : AF                  	xor	a
     278/      F9 : 32 6C EF            	ld	(fever_t), a	; clear flag trace forever
     279/      FC :                     	; init bp, tp, gstop address & opcode
     280/      FC : 21 00 C0            	ld	hl, RAM_B
     281/      FF : 22 6F EF            	ld	(tpt1_adr), hl
     282/     102 : 22 73 EF            	ld	(tpt2_adr), hl
     283/     105 : 22 77 EF            	ld	(bpt1_adr), hl
     284/     108 : 22 7B EF            	ld	(bpt2_adr), hl
     285/     10B : 22 7F EF            	ld	(tmpb_adr), hl
     286/     10E : 7E                  	ld	a, (hl)
     287/     10F : 32 6E EF            	ld	(tpt1_op), a
     288/     112 : 32 72 EF            	ld	(tpt2_op), a
     289/     115 : 32 76 EF            	ld	(bpt1_op), a
     290/     118 : 32 7A EF            	ld	(bpt2_op), a
     291/     11B : 32 7E EF            	ld	(tmpb_op), a
     292/     11E :                     	
     293/     11E :                     ;; Opening message
     294/     11E :                     
     295/     11E : 21 8E 11            	LD	HL,OPNMSG
     296/     121 : CD F0 0B            	CALL	STROUT
     297/     124 :                     ;	EI
     298/     124 :                     
     299/     124 :                     WSTART:
     300/     124 : 21 CB 11            	LD	HL,PROMPT
     301/     127 : CD F0 0B            	CALL	STROUT
     302/     12A : CD 58 0C            	CALL	GETLIN
     303/     12D : CD A9 0C            	CALL	SKIPSP
     304/     130 : CD B0 0C            	CALL	UPPER
     305/     133 : B7                  	OR	A
     306/     134 : 28 EE               	JR	Z, WSTART
     307/     136 :                     
     308/     136 : FE 44               	CP	'D'
     309/     138 : CA DC 06            	JP	Z, DUMP
     310/     13B : FE 47               	CP	'G'
     311/     13D : CA E0 07            	JP	Z, GO
     312/     140 : FE 53               	CP	'S'
     313/     142 : CA AA 08            	JP	Z, SETM
     314/     145 :                     
     315/     145 : FE 4C               	CP	'L'
     316/     147 : CA 20 09            	JP	Z, LOADH
     317/     14A : FE 50               	CP	'P'
     318/     14C : CA FD 09            	JP	Z, SAVEH
     319/     14F :                     
     320/     14F : FE 52               	CP	'R'
     321/     151 : CA D8 0A            	JP	Z, REG
     322/     154 :                     
     323/     154 : FE 23               	cp	'#'
     324/     156 : CA 77 01            	jp	Z, Launcher
     325/     159 :                     
     326/     159 : FE 42               	cp	'B'
     327/     15B : CA 91 02            	jp	z, brk_cmd	; break point command
     328/     15E :                     	
     329/     15E : FE 54               	cp	'T'
     330/     160 : CA 4F 03            	jp	z, trace_cmd	; trace point command
     331/     163 :                     
     332/     163 : FE 3F               	cp	'?'
     333/     165 : 28 08               	jr	z, command_hlp	; command help message
     334/     167 :                     
     335/     167 :                     ERR:
     336/     167 : 21 E8 11            	LD	HL,ERRMSG
     337/     16A : CD F0 0B            	CALL	STROUT
     338/     16D : 18 B5               	JR	WSTART
     339/     16F :                     
     340/     16F :                     ;;
     341/     16F :                     ;; command help
     342/     16F :                     ;;
     343/     16F :                     command_hlp:
     344/     16F :                     
     345/     16F : 21 EE 0F            	LD	HL, cmd_hlp
     346/     172 : CD F0 0B            	CALL	STROUT
     347/     175 : 18 AD               	JR	WSTART
     348/     177 :                     
     349/     177 :                     ;;
     350/     177 :                     ;; Launch appended program
     351/     177 :                     ;;
     352/     177 :                     Launcher:
     353/     177 : 23                  	INC	HL
     354/     178 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     355/     17B : CD B0 0C            	CALL	UPPER
     356/     17E : B7                  	OR	A
     357/     17F : 28 E6               	JR	Z,ERR
     358/     181 :                     
     359/     181 :                     	; check L or number
     360/     181 :                     	
     361/     181 : FE 4C               	cp	'L'
     362/     183 : 28 25               	JR	Z,LST_PRG	; list append program
     363/     185 :                     
     364/     185 :                     	; check number
     365/     185 :                     
     366/     185 : CD 22 02            	call	GET_NUM		; return BC : number
     367/     188 : 38 DD               	JR	C, ERR
     368/     18A :                     
     369/     18A :                     	; check number
     370/     18A : 79                  	LD	A, C
     371/     18B : FE 11               	CP	(lanch1 - ApendTBL)/2 +1	; a < 17 ?
     372/     18D : D2 67 01            	JP	NC, ERR
     373/     190 : B7                  	OR	A				; check '0'
     374/     191 : CA 67 01            	JP	Z, ERR
     375/     194 :                     
     376/     194 :                     	; A <- append program No.
     377/     194 :                     
     378/     194 : 3D                  	DEC	A	; 0 <= A <= 0FH
     379/     195 : 17                  	RLA		; A = A * 2
     380/     196 : 16 00               	LD	D, 0
     381/     198 : 5F                  	LD	E, A
     382/     199 : 21 C8 01            	LD	HL, ApendTBL
     383/     19C : 19                  	ADD	HL, DE	; get lanch address point
     384/     19D : 5E                  	LD	E, (HL)
     385/     19E : 23                  	INC	HL
     386/     19F : 56                  	LD	D, (HL)	; DE : JUMP POINT
     387/     1A0 :                     
     388/     1A0 :                     	; Jump to append program
     389/     1A0 :                     	
     390/     1A0 : EB                  	EX	DE, HL
     391/     1A1 : 5E                  	LD	E, (HL)
     392/     1A2 : 23                  	INC	HL
     393/     1A3 : 56                  	LD	D, (HL)	; DE : jump address
     394/     1A4 : 7A                  	LD	A, D
     395/     1A5 : B3                  	OR	E	; address check
     396/     1A6 : 28 BF               	JR	Z,ERR	; jump address NULL
     397/     1A8 : EB                  	EX	DE, HL
     398/     1A9 : E9                  	JP	(HL)	; lanch append program
     399/     1AA :                     	
     400/     1AA :                     	; List out append program
     401/     1AA :                     LST_PRG:
     402/     1AA :                     	; get address to DE
     403/     1AA : 21 C8 01            	LD	HL, ApendTBL
     404/     1AD :                     
     405/     1AD :                     LST_PRG1:
     406/     1AD : 5E                  	LD	E, (HL)
     407/     1AE : 23                  	INC	HL
     408/     1AF : 56                  	LD	D, (HL)
     409/     1B0 : 23                  	INC	HL
     410/     1B1 :                     
     411/     1B1 : D5                  	PUSH	DE
     412/     1B2 : DD E1               	POP	IX	; IX <-DE
     413/     1B4 : DD 7E 00            	LD	A, (IX+0)
     414/     1B7 : DD B6 01            	OR	(IX+1)
     415/     1BA : 28 09               	JR	Z, LST_END
     416/     1BC : 13                  	INC	DE
     417/     1BD : 13                  	INC	DE	; get string address
     418/     1BE :                     	
     419/     1BE : EB                  	EX	DE, HL
     420/     1BF : CD F0 0B            	CALL	STROUT
     421/     1C2 : EB                  	EX	DE, HL
     422/     1C3 : 18 E8               	JR	LST_PRG1
     423/     1C5 :                     
     424/     1C5 :                     LST_END:
     425/     1C5 : C3 24 01            	JP	WSTART
     426/     1C8 :                     	
     427/     1C8 :                     ; Append program launch table
     428/     1C8 :                     ;
     429/     1C8 :                     ApendTBL:
     430/     1C8 : E8 01               	dw	lanch1
     431/     1CA : 04 02               	dw	lanch2
     432/     1CC : 20 02               	dw	lanch3
     433/     1CE : 20 02               	dw	lanch4
     434/     1D0 : 20 02               	dw	lanch5
     435/     1D2 : 20 02               	dw	lanch6
     436/     1D4 : 20 02               	dw	lanch7
     437/     1D6 : 20 02               	dw	lanch8
     438/     1D8 : 20 02               	dw	lanch9
     439/     1DA : 20 02               	dw	lanch10
     440/     1DC : 20 02               	dw	lanch11
     441/     1DE : 20 02               	dw	lanch12
     442/     1E0 : 20 02               	dw	lanch13
     443/     1E2 : 20 02               	dw	lanch14
     444/     1E4 : 20 02               	dw	lanch15
     445/     1E6 : 20 02               	dw	lanch16
     446/     1E8 :                     	
     447/     1E8 :                     lanch1:
     448/     1E8 : 00 20               	dw	BASIC_CST
     449/     1EA : 31 2E 20 42 41 53   	DB	"1. BASIC4.7b Cold Start",CR,LF,00H
              1F0 : 49 43 34 2E 37 62 
              1F6 : 20 43 6F 6C 64 20 
              1FC : 53 74 61 72 74 0D 
              202 : 0A 00             
     450/     204 :                     lanch2:
     451/     204 : 03 20               	dw	BASIC_WST
     452/     206 : 32 2E 20 42 41 53   	DB	"2. BASIC4.7b Warm Start",CR,LF,00H
              20C : 49 43 34 2E 37 62 
              212 : 20 57 61 72 6D 20 
              218 : 53 74 61 72 74 0D 
              21E : 0A 00             
     453/     220 :                     
     454/     220 :                     lanch3:
     455/     220 :                     lanch4:
     456/     220 :                     lanch5:
     457/     220 :                     lanch6:
     458/     220 :                     lanch7:
     459/     220 :                     lanch8:
     460/     220 :                     lanch9:
     461/     220 :                     lanch10:
     462/     220 :                     lanch11:
     463/     220 :                     lanch12:
     464/     220 :                     lanch13:
     465/     220 :                     lanch14:
     466/     220 :                     lanch15:
     467/     220 :                     lanch16:
     468/     220 : 00 00               	dw	0
     469/     222 :                     
     470/     222 :                     	; get number
     471/     222 :                     	; input HL : string buffer
     472/     222 :                     	;
     473/     222 :                     	; Return
     474/     222 :                     	; CF =1 : Error
     475/     222 :                     	; BC: Calculation result
     476/     222 :                     
     477/     222 :                     GET_NUM:
     478/     222 : AF                  	XOR	A		; Initialize C
     479/     223 : 47                  	LD	B, A
     480/     224 : 4F                  	LD	C, A		; clear BC
     481/     225 :                     	
     482/     225 :                     GET_NUM0:
     483/     225 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     484/     228 : CD B0 0C            	CALL	UPPER
     485/     22B : B7                  	OR	A
     486/     22C : C8                  	RET	Z		; ZF=1, ok! buffer end
     487/     22D :                     
     488/     22D : CD 43 02            	CALL	GET_BI
     489/     230 : D8                  	RET	C
     490/     231 :                     
     491/     231 : F5                  	push	af
     492/     232 : 08                  	EX	AF, AF'		;'AF <> AF: save A
     493/     233 : F1                  	pop	af
     494/     234 : CD 52 02            	CALL	MUL_10		; BC = BC * 10
     495/     237 : D8                  	RET	C		; overflow error
     496/     238 : 08                  	EX	AF, AF'		;'AF <> AF: restor A
     497/     239 :                     
     498/     239 : 16 00               	ld	d, 0
     499/     23B : 5F                  	ld	e, a
     500/     23C : CD 69 02            	CALL	BC_PLUS_DE	; BC = BC + A
     501/     23F : D8                  	RET	C		; overflow error
     502/     240 :                     				; result: BC = BC * 10 + A
     503/     240 : 23                  	INC	HL
     504/     241 : 18 E2               	JR	GET_NUM0
     505/     243 :                     ;
     506/     243 :                     ; Make binary to A
     507/     243 :                     ; ERROR if CF=1
     508/     243 :                     ;
     509/     243 :                     GET_BI:
     510/     243 : B7                  	OR	A
     511/     244 : 28 0A               	JR	Z, UP_BI
     512/     246 : FE 30               	CP	'0'
     513/     248 : D8                  	RET	C
     514/     249 :                     	
     515/     249 : FE 3A               	CP	'9'+1	; ASCII':'
     516/     24B : 30 03               	JR	NC, UP_BI
     517/     24D : D6 30               	SUB	'0'	; Make binary to A
     518/     24F : C9                  	RET
     519/     250 :                     
     520/     250 :                     UP_BI:
     521/     250 : 37                  	SCF		; Set CF
     522/     251 : C9                  	RET
     523/     252 :                     
     524/     252 :                     ;
     525/     252 :                     ; multiply by 10
     526/     252 :                     ; BC = BC * 10
     527/     252 :                     MUL_10:
     528/     252 : C5                  	push	bc
     529/     253 : CB 21               	SLA	C
     530/     255 : CB 10               	RL	B		; 2BC
     531/     257 : CB 21               	SLA	C
     532/     259 : CB 10               	RL	B		; 4BC
     533/     25B : CB 21               	SLA	C
     534/     25D : CB 10               	RL	B		; 8BC
     535/     25F : D1                  	pop	de		; de = bc
     536/     260 : D8                  	ret	c
     537/     261 : CD 69 02            	CALL	BC_PLUS_DE	; 9BC
     538/     264 : D8                  	ret	c
     539/     265 : CD 69 02            	CALL	BC_PLUS_DE	; 10BC
     540/     268 : C9                  	RET			; result : BC = BC * 10
     541/     269 :                     ;
     542/     269 :                     ; BC = BC + DE
     543/     269 :                     BC_PLUS_DE:
     544/     269 : E5                  	push	hl
     545/     26A :                     
     546/     26A : D5                  	push	de
     547/     26B : E1                  	pop	hl
     548/     26C :                     
     549/     26C : 09                  	add	hl, bc
     550/     26D :                     
     551/     26D : E5                  	push	hl
     552/     26E : C1                  	pop	bc
     553/     26F :                     
     554/     26F : E1                  	pop	hl
     555/     270 : C9                  	RET
     556/     271 :                     
     557/     271 :                     ;
     558/     271 :                     ; list break point
     559/     271 :                     ;
     560/     271 :                     b_list:
     561/     271 : 3A 75 EF            	ld	a, (bpt1_f)
     562/     274 : B7                  	or	a
     563/     275 : 28 08               	jr	z, b_list1
     564/     277 :                     
     565/     277 : 2A 77 EF            	ld	hl, (bpt1_adr)
     566/     27A : 3E 31               	ld	a, '1'
     567/     27C : CD 35 03            	call	b_msg_out
     568/     27F :                     
     569/     27F :                     b_list1:
     570/     27F : 3A 79 EF            	ld	a, (bpt2_f)
     571/     282 : B7                  	or	a
     572/     283 : CA 24 01            	jp	z, WSTART
     573/     286 :                     
     574/     286 : 2A 7B EF            	ld	hl, (bpt2_adr)
     575/     289 : 3E 32               	ld	a, '2'
     576/     28B : CD 35 03            	call	b_msg_out
     577/     28E : C3 24 01            	JP	WSTART
     578/     291 :                     
     579/     291 :                     
     580/     291 :                     ;;; 
     581/     291 :                     ;;; break point command
     582/     291 :                     ;;; 
     583/     291 :                     brk_cmd:
     584/     291 : 23                  	INC	HL
     585/     292 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     586/     295 : CD B0 0C            	CALL	UPPER
     587/     298 : B7                  	OR	A
     588/     299 : 28 D6               	JR	Z,b_list	; only type "B"
     589/     29B :                     
     590/     29B : 01 75 EF            	ld	bc, bpt1_f
     591/     29E : FE 31               	cp	'1'
     592/     2A0 : 28 0E               	jr	z, set_bp1
     593/     2A2 :                     
     594/     2A2 : 01 79 EF            	ld	bc, bpt2_f
     595/     2A5 : FE 32               	cp	'2'
     596/     2A7 : 28 07               	jr	z, set_bp1
     597/     2A9 :                     
     598/     2A9 : FE 43               	cp	'C'	;clear?
     599/     2AB : 28 41               	jr	z, bp_clr
     600/     2AD : C3 67 01            	jp	ERR
     601/     2B0 :                     
     602/     2B0 :                     set_bp1:
     603/     2B0 : 08                  	EX	AF, AF'
     604/     2B1 :                     
     605/     2B1 : 23                  	INC	HL
     606/     2B2 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     607/     2B5 : CD B0 0C            	CALL	UPPER
     608/     2B8 : B7                  	OR	A
     609/     2B9 : 28 5D               	JR	Z, bp_LOT 	;; No address input -> list out
     610/     2BB : FE 2C               	cp	','
     611/     2BD : C2 67 01            	jp	nz, ERR
     612/     2C0 :                     
     613/     2C0 : 23                  	INC	HL
     614/     2C1 : CD A9 0C            	CALL	SKIPSP
     615/     2C4 : C5                  	push	bc
     616/     2C5 : CD B9 0C            	CALL	RDHEX		; 1st arg.
     617/     2C8 : E1                  	pop	hl		; hl <- bc
     618/     2C9 : DA 67 01            	jp	c, ERR
     619/     2CC :                     
     620/     2CC : CD D5 02            	call	setbpadr
     621/     2CF : DA 67 01            	jp	c, ERR
     622/     2D2 : C3 24 01            	JP	WSTART
     623/     2D5 :                     
     624/     2D5 :                     
     625/     2D5 :                     ; hl : point of bp flag( bpt1_f or bpt2_f)
     626/     2D5 :                     ; de : break point address
     627/     2D5 :                     
     628/     2D5 :                     ; check ram area, and set berak point
     629/     2D5 :                     ; 
     630/     2D5 :                     setbpadr:
     631/     2D5 : 7A                  	ld	a, d
     632/     2D6 : FE C0               	cp	RAM_B >> 8	; a - 0C0H
     633/     2D8 : DA EC 02            	jp	c, chkERR	; ROM area
     634/     2DB : FE F0               	cp	IO_B >> 8	; a - 0F0H
     635/     2DD : D2 EC 02            	jp	nc, chkERR	; I/O area
     636/     2E0 : 3E 01               	ld	a,1
     637/     2E2 : 77                  	ld	(hl), a	; set flag
     638/     2E3 : 23                  	inc	hl
     639/     2E4 : 1A                  	ld	a, (de)		; get opcode
     640/     2E5 : 77                  	ld	(hl), a		; save opcode
     641/     2E6 : 23                  	inc	hl
     642/     2E7 : 73                  	ld	(hl), e ; set break point low address
     643/     2E8 : 23                  	inc	hl
     644/     2E9 : 72                  	ld	(hl), d ; set break point high address
     645/     2EA : B7                  	or	a	; reset carry
     646/     2EB : C9                  	ret
     647/     2EC :                     
     648/     2EC :                     chkERR:
     649/     2EC : 37                  	scf	;set carry
     650/     2ED : C9                  	ret
     651/     2EE :                     
     652/     2EE :                     ; clear break point
     653/     2EE :                     
     654/     2EE :                     bp_clr:
     655/     2EE : 23                  	INC	HL
     656/     2EF : CD A9 0C            	CALL	SKIPSP		; A <- next char
     657/     2F2 : CD B0 0C            	CALL	UPPER
     658/     2F5 : B7                  	OR	A
     659/     2F6 : 28 14               	JR	Z,b_aclr	; all clear
     660/     2F8 :                     
     661/     2F8 : 01 75 EF            	ld	bc, bpt1_f
     662/     2FB : FE 31               	cp	'1'
     663/     2FD : 28 08               	jr	z, bp_clr1
     664/     2FF :                     
     665/     2FF : 01 79 EF            	ld	bc, bpt2_f
     666/     302 : FE 32               	cp	'2'
     667/     304 : C2 67 01            	jp	nz, ERR
     668/     307 :                     
     669/     307 :                     bp_clr1:
     670/     307 : AF                  	xor	a
     671/     308 : 02                  	ld	(bc), a
     672/     309 : C3 24 01            	JP	WSTART
     673/     30C :                     
     674/     30C :                     b_aclr:
     675/     30C : AF                  	xor	a
     676/     30D : 01 75 EF            	ld	bc, bpt1_f
     677/     310 : 02                  	ld	(bc), a
     678/     311 : 01 79 EF            	ld	bc, bpt2_f
     679/     314 : 02                  	ld	(bc), a
     680/     315 : C3 24 01            	JP	WSTART
     681/     318 :                     
     682/     318 :                     ; when no address input. list out BP
     683/     318 :                     ;
     684/     318 :                     ; bc : break pointer buffer offset
     685/     318 :                     bp_LOT:
     686/     318 : 0A                  	ld	a, (bc)		; set break point?
     687/     319 : B7                  	or	a
     688/     31A : CA 24 01            	jp	z, WSTART	; no break point setting
     689/     31D :                     
     690/     31D : 08                  	EX	AF, AF'
     691/     31E : 2A 77 EF            	ld	hl, (bpt1_adr)
     692/     321 : FE 31               	cp	'1'
     693/     323 : 28 03               	jr	z, l_b2
     694/     325 : 2A 7B EF            	ld	hl, (bpt2_adr)
     695/     328 :                     l_b2:
     696/     328 : CD 35 03            	call	b_msg_out
     697/     32B : C3 24 01            	JP	WSTART
     698/     32E :                     
     699/     32E : 42 50 28 00         bp_msg1:	db	"BP(",00H
     700/     332 : 29 3A 00            bp_msg2:	db	"):",00H
     701/     335 :                     
     702/     335 :                     b_msg_out:
     703/     335 : E5                  	push	hl
     704/     336 : F5                  	push	af
     705/     337 : 21 2E 03            	ld	hl, bp_msg1
     706/     33A : CD F0 0B            	call	STROUT
     707/     33D : F1                  	pop	af
     708/     33E : CD 34 14            	call	CONOUT
     709/     341 : 21 32 03            	ld	hl, bp_msg2
     710/     344 : CD F0 0B            	call	STROUT
     711/     347 : E1                  	pop	hl
     712/     348 : CD F9 0B            	call	HEXOUT4
     713/     34B : CD 3C 0C            	call	CRLF	
     714/     34E : C9                  	ret
     715/     34F :                     
     716/     34F :                     ;;; 
     717/     34F :                     ;;; trace command
     718/     34F :                     ;;; 
     719/     34F :                     trace_cmd:
     720/     34F :                     
     721/     34F :                     ; T[address][,stepæ•°]
     722/     34F :                     ; TP[ON | OFF]
     723/     34F :                     ; TM[I | S]
     724/     34F :                     
     725/     34F :                     ; init steps
     726/     34F : E5                  	push	hl
     727/     350 : 2E 00               	ld	l, 0
     728/     352 : 26 00               	ld	h, 0
     729/     354 : 22 68 EF            	ld	(TC_cnt), hl	; clear trace step counter to 0
     730/     357 : 2A 52 EF            	ld	hl,(REGPC)
     731/     35A : 22 6A EF            	ld	(tmpT), hl	; init temp address
     732/     35D : AF                  	xor	a
     733/     35E : 32 6C EF            	ld	(fever_t), a	; clear flag trace forever
     734/     361 :                     
     735/     361 : E1                  	pop	hl
     736/     362 : 23                  	inc	hl
     737/     363 : CD A9 0C            	CALL	SKIPSP
     738/     366 : CD B9 0C            	CALL	RDHEX		; 1st arg.
     739/     369 : D2 21 04            	jp	nc, tadr_chk
     740/     36C : CD A9 0C            	CALL	SKIPSP
     741/     36F : 7E                  	ld	a, (hl)
     742/     370 : B7                  	or	a
     743/     371 : CA 4A 04            	Jp	z, t_op1	; only 1 step trace, check opcode
     744/     374 : FE 2C               	cp	','
     745/     376 : CA 32 04            	jp	z, stp_chk	; steps check
     746/     379 :                     
     747/     379 : CD B0 0C            	CALL	UPPER
     748/     37C : FE 50               	cp	'P'
     749/     37E : 28 51               	jr	z, tp_cmd
     750/     380 : FE 4D               	cp	'M'
     751/     382 : C2 67 01            	jp	nz, ERR
     752/     385 :                     	
     753/     385 :                     	; tm_cmd
     754/     385 :                     	
     755/     385 : 23                  	inc	hl
     756/     386 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     757/     389 : CD B0 0C            	CALL	UPPER
     758/     38C :                     dip_TM:
     759/     38C : 21 C3 03            	ld	hl, tm_msg_i
     760/     38F : FE 49               	cp	'I'
     761/     391 : 28 10               	jr	z, set_TM
     762/     393 : 21 C9 03            	ld	hl, tm_msg_s
     763/     396 : FE 53               	cp	'S'
     764/     398 : 28 09               	jr	z, set_TM
     765/     39A : B7                  	or	a
     766/     39B : C2 67 01            	jp	nz, ERR
     767/     39E :                     
     768/     39E :                     ;display T mode
     769/     39E : 3A 67 EF            	ld	a, (TM_mode)
     770/     3A1 : 18 E9               	jr	dip_TM
     771/     3A3 :                     
     772/     3A3 :                     ;set TM mode and display
     773/     3A3 :                     set_TM:
     774/     3A3 : 32 67 EF            	ld	(TM_mode),a
     775/     3A6 : E5                  	push	hl
     776/     3A7 : 21 B4 03            	ld	hl, tm_msg_0
     777/     3AA : CD F0 0B            	call	STROUT
     778/     3AD : E1                  	pop	hl
     779/     3AE : CD F0 0B            	call	STROUT
     780/     3B1 : C3 24 01            	jp	WSTART
     781/     3B4 :                     
     782/     3B4 :                     tm_msg_0:
     783/     3B4 : 54 4D 20 6D 6F 64   	db	"TM mode:<CALL ", 00h
              3BA : 65 3A 3C 43 41 4C 
              3C0 : 4C 20 00          
     784/     3C3 :                     tm_msg_i:
     785/     3C3 : 49 4E 3E 0D 0A 00   	db	"IN>", CR, LF, 00h
     786/     3C9 :                     tm_msg_s:
     787/     3C9 : 53 4B 49 50 3E 0D   	db	"SKIP>", CR, LF, 00h
              3CF : 0A 00             
     788/     3D1 :                     	
     789/     3D1 :                     	
     790/     3D1 :                     	; tp_cmd
     791/     3D1 :                     tp_cmd:	
     792/     3D1 : 23                  	inc	hl
     793/     3D2 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     794/     3D5 : CD B0 0C            	CALL	UPPER
     795/     3D8 : B7                  	or	a
     796/     3D9 : 20 05               	jr	nz, tp_n1
     797/     3DB : 3A 66 EF            	ld	a, (TP_mode)
     798/     3DE : 18 0C               	jr	tp_n2
     799/     3E0 :                     	
     800/     3E0 :                     tp_n1:
     801/     3E0 : FE 4F               	cp	'O'
     802/     3E2 : C2 67 01            	jp	nz, ERR
     803/     3E5 : 23                  	inc	hl
     804/     3E6 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     805/     3E9 : CD B0 0C            	CALL	UPPER
     806/     3EC :                     
     807/     3EC :                     tp_n2:
     808/     3EC : 21 16 04            	ld	hl, tp_msg_on
     809/     3EF : FE 4E               	cp	'N'
     810/     3F1 : 28 08               	jr	z, tp_md_on
     811/     3F3 :                     
     812/     3F3 : 21 1B 04            	ld	hl, tp_msg_off
     813/     3F6 : FE 46               	cp	'F'
     814/     3F8 : C2 67 01            	jp	nz, ERR
     815/     3FB :                     
     816/     3FB :                     tp_md_on:
     817/     3FB :                     	; set trace mode and display mode
     818/     3FB : 32 66 EF            	ld	(TP_mode), a
     819/     3FE : E5                  	push	hl
     820/     3FF : 21 0C 04            	ld	hl, tp_msg_0
     821/     402 : CD F0 0B            	call	STROUT
     822/     405 : E1                  	pop	hl
     823/     406 : CD F0 0B            	call	STROUT
     824/     409 : C3 24 01            	jp	WSTART
     825/     40C :                     	
     826/     40C :                     tp_msg_0:
     827/     40C : 54 50 20 6D 6F 64   	db	"TP mode: ", 00h
              412 : 65 3A 20 00       
     828/     416 :                     tp_msg_on:
     829/     416 : 4F 4E 0D 0A 00      	db	"ON", CR, LF, 00h
     830/     41B :                     tp_msg_off:
     831/     41B : 4F 46 46 0D 0A 00   	db	"OFF", CR, LF, 00h
     832/     421 :                     
     833/     421 :                     tadr_chk:
     834/     421 : ED 53 6A EF         	ld	(tmpT), de	; set start address
     835/     425 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     836/     428 : B7                  	or	a
     837/     429 : 28 1F               	jr	z, t_op1	; 1step trace
     838/     42B : FE 2C               	cp	','
     839/     42D : 28 03               	jr	z, stp_chk
     840/     42F : C3 67 01            	jp	ERR
     841/     432 :                     
     842/     432 :                     stp_chk:
     843/     432 : 23                  	inc	hl
     844/     433 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     845/     436 : B7                  	or	a
     846/     437 : CA 67 01            	jp	z, ERR
     847/     43A : FE 2D               	cp	'-'
     848/     43C : 28 11               	jr	z, chk_fevre
     849/     43E :                     
     850/     43E :                     ; check steps
     851/     43E :                     
     852/     43E : CD 22 02            	call	GET_NUM		; get steps to BC
     853/     441 : DA 67 01            	JP	C, ERR		; number error
     854/     444 :                     
     855/     444 :                     t_op11:
     856/     444 : ED 43 68 EF         	ld	(TC_cnt), bc	; set trace step counter
     857/     448 : 18 1B               	jr	t_op_chk
     858/     44A :                     
     859/     44A :                     t_op1:
     860/     44A : 01 01 00            	ld	bc, 1
     861/     44D : 18 F5               	jr	t_op11
     862/     44F :                     
     863/     44F :                     chk_fevre:
     864/     44F : 23                  	inc	hl
     865/     450 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     866/     453 : FE 31               	cp	'1'
     867/     455 : C2 67 01            	jp	nz, ERR
     868/     458 : 23                  	inc	hl
     869/     459 : CD A9 0C            	CALL	SKIPSP		; A <- next char
     870/     45C : B7                  	or	a
     871/     45D : C2 67 01            	jp	nz, ERR		; not "-1" then error
     872/     460 : 3E 01               	ld	a, 1
     873/     462 : 32 6C EF            	ld	(fever_t), a	; set flag trace forever
     874/     465 :                     
     875/     465 :                     t_op_chk:
     876/     465 : 2A 6A EF            	ld	hl, (tmpT)	; get PC address
     877/     468 : 7E                  	ld	a, (hl)		; get opcode
     878/     469 :                     	
     879/     469 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     880/     469 :                     ;;;
     881/     469 :                     ;;; branch opecode check
     882/     469 :                     ;;;
     883/     469 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     884/     469 :                     
     885/     469 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     886/     469 :                     ; 2 insertion Trace code(TC) 
     887/     469 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     888/     469 :                     INSTC2:
     889/     469 :                     	; check 1 byte machine code: branch (RET CC)
     890/     469 :                     
     891/     469 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
     892/     46C : 21 FA 05            	ld	hl, RETCC_TBLS
     893/     46F : ED B1               	cpir
     894/     471 : 20 13               	jr	nz, next_bc1	; not RET CC
     895/     473 :                     
     896/     473 :                     	; RET CC
     897/     473 :                     	; trace operation:
     898/     473 :                     	;   1. ea = *REGSP; *ea = TC;
     899/     473 :                     	;   2. ea = *REGPC; *(ea+1) = TC;
     900/     473 :                     
     901/     473 :                     	; 1
     902/     473 : 0E 01               	ld	c, 1		; first TC point
     903/     475 : CD CB 05            	call	insBRK_sp
     904/     478 : DA 8A 05            	jp	c, err_trace_seq
     905/     47B :                     	
     906/     47B :                     	; 2
     907/     47B : 0E 02               	ld	c, 2		; second TC point
     908/     47D : CD AB 05            	call	insBRK_1op
     909/     480 : DA 8A 05            	jp	c, err_trace_seq
     910/     483 :                     
     911/     483 : C3 87 05            	jp	END_INS_TC
     912/     486 :                     
     913/     486 :                     	; check 2 byte machine code: branch (JR CC, Relative Value)
     914/     486 :                     next_bc1:
     915/     486 :                     
     916/     486 : 01 05 00            	ld	bc, JRCC_TBLE - JRCC_TBLS
     917/     489 : 21 02 06            	ld	hl, JRCC_TBLS
     918/     48C : ED B1               	cpir
     919/     48E : 20 19               	jr	nz, next_bc2	; not JR CC
     920/     490 :                     
     921/     490 :                     	; JR CC, nn
     922/     490 :                     	; trace operation:
     923/     490 :                     	;   1. ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
     924/     490 :                     	;   2. ea = *REGPC; *(ea+2) = TC;
     925/     490 :                     
     926/     490 :                     	; 1
     927/     490 : 0E 01               	ld	c, 1		; first TC point
     928/     492 : 2A 6A EF            	ld	hl, (tmpT)
     929/     495 : CD 9E 05            	call	Rel_adr_c
     930/     498 : CD D8 05            	call	inadr_chk_and_wrt
     931/     49B : DA 8A 05            	jp	c, err_trace_seq
     932/     49E :                     
     933/     49E :                     	; 2
     934/     49E : 0E 02               	ld	c, 2		; second TC point
     935/     4A0 : CD B0 05            	call	insBRK_2op
     936/     4A3 : DA 8A 05            	jp	c, err_trace_seq
     937/     4A6 :                     
     938/     4A6 : C3 87 05            	jp	END_INS_TC
     939/     4A9 :                     
     940/     4A9 :                     	; check 3 byte machine code: branch JP CC, nnnn 16bit literal)
     941/     4A9 :                     
     942/     4A9 :                     next_bc2:
     943/     4A9 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
     944/     4AC : 21 07 06            	ld	hl, JPCC_TBLS
     945/     4AF : ED B1               	cpir
     946/     4B1 : 20 04               	jr	nz, next_bc21		; not JP CCC
     947/     4B3 :                     
     948/     4B3 :                     	; JP CC, nnnn
     949/     4B3 :                     	; trace operation:
     950/     4B3 :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
     951/     4B3 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
     952/     4B3 :                     
     953/     4B3 : 0E 01               	ld	c, 1		; first TC point
     954/     4B5 : 18 13               	jr	next_bc222
     955/     4B7 :                     
     956/     4B7 :                     	; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
     957/     4B7 :                     
     958/     4B7 :                     next_bc21:
     959/     4B7 : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
     960/     4BA : 21 0F 06            	ld	hl, CLCC_TBLS
     961/     4BD : ED B1               	cpir
     962/     4BF : 20 1A               	jr	nz, INSTC1		; not CALL CCC
     963/     4C1 :                     
     964/     4C1 :                     	; CALL CC, nnnn
     965/     4C1 :                     	; trace operation:
     966/     4C1 :                     	; TM_mode = 'I'
     967/     4C1 :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
     968/     4C1 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
     969/     4C1 :                     	;
     970/     4C1 :                     	; TM_mode = 'S'
     971/     4C1 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
     972/     4C1 :                     
     973/     4C1 : 0E 01               	ld	c, 1		; first TC point
     974/     4C3 : 3A 67 EF            	ld	a, (TM_mode)
     975/     4C6 : FE 53               	cp	'S'
     976/     4C8 : 28 08               	jr	z, next_bc22	; skip insertion 1.
     977/     4CA :                     
     978/     4CA :                     next_bc222:
     979/     4CA :                     	; 1. ea = *REGPC; *((char *)(ea+1)) = TC;
     980/     4CA : CD BF 05            	call	insBRK_brp
     981/     4CD : DA 8A 05            	jp	c, err_trace_seq
     982/     4D0 :                     	
     983/     4D0 :                     next_bc221:
     984/     4D0 :                     	; 2. ea = *REGPC; *(ea+3) = TC;
     985/     4D0 : 0E 02               	ld	c, 2		; second TC point
     986/     4D2 :                     next_bc22:
     987/     4D2 : CD B5 05            	call	insBRK_3op
     988/     4D5 : DA 8A 05            	jp	c, err_trace_seq
     989/     4D8 :                     
     990/     4D8 : C3 87 05            	jp	END_INS_TC
     991/     4DB :                     
     992/     4DB :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     993/     4DB :                     ; 1 insertion Trace code(TC) 
     994/     4DB :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     995/     4DB :                     INSTC1:
     996/     4DB :                     	; check 1 byte machine code: branch (return)
     997/     4DB : FE C9               	cp	0C9H		; RET ?
     998/     4DD : 20 0B               	jr	nz, next_bc3	; not RET
     999/     4DF :                     
    1000/     4DF :                     	; RET
    1001/     4DF :                     	; trace operation:
    1002/     4DF :                     	;   ea = *REGSP; *ea = TC;
    1003/     4DF : 0E 01               	ld	c, 1		; first TC point
    1004/     4E1 : CD CB 05            	call	insBRK_sp
    1005/     4E4 : DA 8A 05            	jp	c, err_trace_seq
    1006/     4E7 : C3 87 05            	jp	END_INS_TC
    1007/     4EA :                     
    1008/     4EA :                     	; check RST p
    1009/     4EA :                     next_bc3:
    1010/     4EA : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    1011/     4ED : 21 17 06            	ld	hl, RST_TBLS
    1012/     4F0 : ED B1               	cpir
    1013/     4F2 : 20 0B               	jr	nz, next_bc4		; not RST p
    1014/     4F4 :                     
    1015/     4F4 :                     	; RST p
    1016/     4F4 :                     	; can't trace: skip trace
    1017/     4F4 :                     	; trace operation:
    1018/     4F4 :                     	;   ea = *REGPC; *(ea+1) = TC;
    1019/     4F4 :                     ;	ld	hl, RST_DMSG
    1020/     4F4 :                     ;	call	STROUT		; message out "DETECT RST OPCODE"
    1021/     4F4 : 0E 01               	ld	c, 1		; first TC point
    1022/     4F6 : CD AB 05            	call	insBRK_1op
    1023/     4F9 : DA 8A 05            	jp	c, err_trace_seq
    1024/     4FC :                     	
    1025/     4FC : C3 87 05            	jp	END_INS_TC
    1026/     4FF :                     
    1027/     4FF :                     ;RST_DMSG:
    1028/     4FF :                     ;	db	"(RST nn) WILL BE SKIPPED. AND TRACE NEXT OPCODE", CR, LF,00
    1029/     4FF :                     
    1030/     4FF :                     	; check code 0EDH
    1031/     4FF :                     next_bc4:
    1032/     4FF : FE ED               	cp	0EDH		; CODE 0EDH ?
    1033/     501 : 20 13               	jr	nz, next_bc5	; not 0EDH
    1034/     503 :                     
    1035/     503 : 23                  	inc	hl
    1036/     504 : 7E                  	ld	a, (hl)
    1037/     505 : FE 45               	cp	45H		; RETN?
    1038/     507 : 28 04               	jr	z, next_bc6	; yes, RETN
    1039/     509 : FE 4D               	cp	4DH		; RETI?
    1040/     50B : 20 09               	jr	nz, next_bc5	; not RETN
    1041/     50D :                     
    1042/     50D :                     	; trace operation:
    1043/     50D :                     	;   ea = *REGSP; *ea = TC;
    1044/     50D :                     next_bc6:
    1045/     50D : 0E 01               	ld	c, 1		; first TC point
    1046/     50F : CD CB 05            	call	insBRK_sp
    1047/     512 : 38 76               	jr	c, err_trace_seq
    1048/     514 : 18 71               	jr	END_INS_TC
    1049/     516 :                     
    1050/     516 :                     	; check JP (HL)
    1051/     516 :                     next_bc5:
    1052/     516 : 2A 6A EF            	ld	hl, (tmpT)
    1053/     519 : 7E                  	ld	a, (hl)
    1054/     51A :                     
    1055/     51A : FE E9               	cp	0E9H		; JP (HL) ?
    1056/     51C : 20 0C               	jr	nz, next_bc7	; not JP (HL)
    1057/     51E :                     
    1058/     51E :                     	; JP (HL)
    1059/     51E :                     	; trace operation:
    1060/     51E :                     	;   ea = *REGHL; *ea = TC;
    1061/     51E : 2A 42 EF            	ld	hl, (REGHL)
    1062/     521 :                     jphl:
    1063/     521 : 0E 01               	ld	c, 1		; first TC point
    1064/     523 : CD D8 05            	call	inadr_chk_and_wrt
    1065/     526 : 38 62               	jr	c, err_trace_seq
    1066/     528 : 18 5D               	jr	END_INS_TC
    1067/     52A :                     
    1068/     52A :                     	; check JP (IX)
    1069/     52A :                     next_bc7:
    1070/     52A : FE DD               	cp	0DDH		; 1st OPOCDE 0DDH ?
    1071/     52C : 20 0B               	jr	nz, next_bc8	; no 0DDH
    1072/     52E : 23                  	inc	hl
    1073/     52F : 7E                  	ld	a, (hl)
    1074/     530 : FE E9               	cp	0E9H		; JP (IX) ?
    1075/     532 : 20 05               	jr	nz, next_bc8	; not JP (IX)
    1076/     534 :                     
    1077/     534 :                     	; JP (IX)
    1078/     534 :                     	; trace operation:
    1079/     534 :                     	;   ea = *REGIX; *ea = TC;
    1080/     534 : 2A 4C EF            	ld	hl, (REGIX)
    1081/     537 : 18 E8               	jr	jphl
    1082/     539 :                     
    1083/     539 :                     	; check JP (IY)
    1084/     539 :                     next_bc8:
    1085/     539 : 2A 6A EF            	ld	hl, (tmpT)
    1086/     53C : 7E                  	ld	a, (hl)
    1087/     53D :                     
    1088/     53D : FE FD               	cp	0FDH		; 1st OPOCDE 0FDH ?
    1089/     53F : 20 0B               	jr	nz, next_bc9	; no 0FDH
    1090/     541 : 23                  	inc	hl
    1091/     542 : 7E                  	ld	a, (hl)
    1092/     543 : FE E9               	cp	0E9H		; JP (IX) ?
    1093/     545 : 20 05               	jr	nz, next_bc9	; not JP (IX)
    1094/     547 :                     
    1095/     547 :                     	; JP (IY)
    1096/     547 :                     	; trace operation:
    1097/     547 :                     	;   ea = *REGIY; *ea = TC;
    1098/     547 : 2A 4E EF            	ld	hl, (REGIY)
    1099/     54A : 18 D5               	jr	jphl
    1100/     54C :                     
    1101/     54C :                     	; check JR relative
    1102/     54C :                     next_bc9:
    1103/     54C : 2A 6A EF            	ld	hl, (tmpT)
    1104/     54F : 7E                  	ld	a, (hl)
    1105/     550 : FE 18               	cp	18H		; JR relative ?
    1106/     552 : 20 0C               	jr	nz, next_bc10	; not JR relative
    1107/     554 :                     
    1108/     554 :                     	; JR Relative
    1109/     554 :                     	; trace operation:
    1110/     554 :                     	;   ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1111/     554 : 0E 01               	ld	c, 1		; first TC point
    1112/     556 : CD 9E 05            	call	Rel_adr_c
    1113/     559 : CD D8 05            	call	inadr_chk_and_wrt
    1114/     55C : 38 2C               	jr	c, err_trace_seq
    1115/     55E : 18 27               	jr	END_INS_TC
    1116/     560 :                     
    1117/     560 :                     	; check JP literal
    1118/     560 :                     next_bc10:
    1119/     560 : FE C3               	cp	0C3H		; JP literal ?
    1120/     562 : 20 09               	jr	nz, next_bc11	; not JP literal
    1121/     564 :                     
    1122/     564 :                     	; JP literal
    1123/     564 :                     	; trace operation:
    1124/     564 :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1125/     564 : 0E 01               	ld	c, 1		; first TC point
    1126/     566 : CD BF 05            	call	insBRK_brp
    1127/     569 : 38 1F               	jr	c, err_trace_seq
    1128/     56B : 18 1A               	jr	END_INS_TC
    1129/     56D :                     
    1130/     56D :                     	; check call literal
    1131/     56D :                     next_bc11:
    1132/     56D : FE CD               	cp	0CDH		; CALL literal ?
    1133/     56F : C2 1F 06            	jp	nz, INS2	; no, check not branch opcode 
    1134/     572 :                     
    1135/     572 :                     	; CALL literal
    1136/     572 :                     	; trace operation:
    1137/     572 :                     	; TM_mode = 'I'
    1138/     572 :                     	;   ea = *REGPC; *((short *)(ea+1)) = TC;
    1139/     572 :                     	; TM_mode = 'S'
    1140/     572 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1141/     572 :                     
    1142/     572 : 0E 01               	ld	c, 1		; first TC point
    1143/     574 : 3A 67 EF            	ld	a, (TM_mode)
    1144/     577 : FE 53               	cp	'S'
    1145/     579 : 28 07               	jr	z, next_bc111	; yes, TM_mode='S'
    1146/     57B :                     
    1147/     57B :                     	; TM_mode = 'I'
    1148/     57B :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1149/     57B : CD BF 05            	call	insBRK_brp
    1150/     57E : 38 0A               	jr	c, err_trace_seq
    1151/     580 : 18 05               	jr	END_INS_TC
    1152/     582 :                     
    1153/     582 :                     	; TM_mode = 'S'
    1154/     582 :                     	; ea = *REGPC; *(ea+3) = TC;
    1155/     582 :                     next_bc111:
    1156/     582 : CD B5 05            	call	insBRK_3op
    1157/     585 : 38 03               	jr	c, err_trace_seq
    1158/     587 :                     
    1159/     587 :                     END_INS_TC:
    1160/     587 : C3 23 08            	jp	G0	; go, trace operation
    1161/     58A :                     
    1162/     58A :                     err_trace_seq:
    1163/     58A : 21 94 05            	ld	hl, terr_msg
    1164/     58D : CD F0 0B            	call	STROUT
    1165/     590 : C3 24 01            	JP	WSTART
    1166/     593 : FF                  	rst	38h
    1167/     594 :                     ;	
    1168/     594 : 41 64 72 20 45 52   terr_msg:	db	"Adr ERR", CR, LF, 00H
              59A : 52 0D 0A 00       
    1169/     59E :                     
    1170/     59E :                     ;--------------------------------------
    1171/     59E :                     ; 2 byte machine code branch
    1172/     59E :                     ; - 2nd byte is Relative address
    1173/     59E :                     ; - input hl : opecode address
    1174/     59E :                     ; - output hl : target address
    1175/     59E :                     ;--------------------------------------
    1176/     59E :                     Rel_adr_c:
    1177/     59E : 23                  	inc	hl
    1178/     59F : 5E                  	ld	e, (hl)		; e = 2nd operand
    1179/     5A0 : 23                  	inc	hl		; hl = PC + 2
    1180/     5A1 : 16 FF               	ld	d, 0ffh
    1181/     5A3 : CB 7B               	bit	7, e		; test msb bit
    1182/     5A5 : 20 02               	jr	nz, exp_msb	; 
    1183/     5A7 : 16 00               	ld	d, 0
    1184/     5A9 :                     exp_msb:
    1185/     5A9 : 19                  	add	hl, de
    1186/     5AA : C9                  	ret
    1187/     5AB :                     
    1188/     5AB :                     ;--------------------------------------
    1189/     5AB :                     ; 1 byte op code, insert TC
    1190/     5AB :                     ; ea = *REGPC; *(ea+1) = TC
    1191/     5AB :                     ;--------------------------------------
    1192/     5AB :                     insBRK_1op:
    1193/     5AB :                     ;	ld	hl, (REGPC)
    1194/     5AB : 2A 6A EF            	ld	hl, (tmpT)
    1195/     5AE : 18 0A               	jr	ib1
    1196/     5B0 :                     	
    1197/     5B0 :                     ;--------------------------------------
    1198/     5B0 :                     ; 2 byte op code, insert TC
    1199/     5B0 :                     ; ea = *REGPC; *(ea+2) = TC
    1200/     5B0 :                     ;--------------------------------------
    1201/     5B0 :                     insBRK_2op:
    1202/     5B0 :                     ;	ld	hl, (REGPC)
    1203/     5B0 : 2A 6A EF            	ld	hl, (tmpT)
    1204/     5B3 : 18 04               	jr	ib2
    1205/     5B5 :                     	
    1206/     5B5 :                     ;--------------------------------------
    1207/     5B5 :                     ; 3 byte op code, insert TC
    1208/     5B5 :                     ; ea = *REGPC; *(ea+3) = TC;
    1209/     5B5 :                     ;--------------------------------------
    1210/     5B5 :                     insBRK_3op:
    1211/     5B5 :                     ;	ld	hl, (REGPC)
    1212/     5B5 : 2A 6A EF            	ld	hl, (tmpT)
    1213/     5B8 :                     ib3:
    1214/     5B8 : 23                  	inc	hl
    1215/     5B9 :                     ib2:
    1216/     5B9 : 23                  	inc	hl
    1217/     5BA :                     ib1:
    1218/     5BA : 23                  	inc	hl
    1219/     5BB : CD D8 05            	call	inadr_chk_and_wrt
    1220/     5BE : C9                  	ret
    1221/     5BF :                     
    1222/     5BF :                     ;--------------------------------------
    1223/     5BF :                     ; 3 byte op code, insert TC in branch point
    1224/     5BF :                     ; ea = *REGPC; *((char *)(ea+1)) = TC;
    1225/     5BF :                     ;--------------------------------------
    1226/     5BF :                     insBRK_brp:
    1227/     5BF :                     ;	ld	hl, (REGPC)
    1228/     5BF : 2A 6A EF            	ld	hl, (tmpT)
    1229/     5C2 : 23                  	inc	hl
    1230/     5C3 : 5E                  	ld	e, (hl)
    1231/     5C4 : 23                  	inc	hl
    1232/     5C5 : 56                  	ld	d, (hl)
    1233/     5C6 : EB                  	ex	de,  hl
    1234/     5C7 : CD D8 05            	call	inadr_chk_and_wrt
    1235/     5CA : C9                  	ret
    1236/     5CB :                     
    1237/     5CB :                     ;--------------------------------------
    1238/     5CB :                     ; insert TC at SP
    1239/     5CB :                     ; ea = *REGSP; *ea = TC;
    1240/     5CB :                     ;--------------------------------------
    1241/     5CB :                     insBRK_sp:
    1242/     5CB : ED 5B 50 EF         	ld	de, (REGSP)
    1243/     5CF : 1A                  	ld	a, (de)
    1244/     5D0 : 6F                  	ld	l, a
    1245/     5D1 : 13                  	inc	de
    1246/     5D2 : 1A                  	ld	a, (de)
    1247/     5D3 : 67                  	ld	h, a		; hl = *sp
    1248/     5D4 : CD D8 05            	call	inadr_chk_and_wrt
    1249/     5D7 : C9                  	ret
    1250/     5D8 :                     
    1251/     5D8 :                     ;--------------------------------------
    1252/     5D8 :                     ; check (HL) is RAM AREA
    1253/     5D8 :                     ; insert Trace code at (HL)
    1254/     5D8 :                     ;--------------------------------------
    1255/     5D8 :                     inadr_chk_and_wrt:
    1256/     5D8 : 7C                  	ld	a, h
    1257/     5D9 :                     
    1258/     5D9 : =>TRUE               	IF	RAM12K
    1259/     5D9 : FE C0               	cp	RAM_B >> 8	; a & 0c0h
    1260/     5DB : 38 1B               	jr	c, NO_RAM_AREA
    1261/     5DD : FE F0               	cp	IO_B >> 8
    1262/     5DF : 30 17               	jr	nc, NO_RAM_AREA
    1263/     5E1 : [1258]               	ENDIF
    1264/     5E1 :                     
    1265/     5E1 : =>FALSE              	IF	RAM8K
    1266/     5E1 :                     	cp	RAM_B >> 8		; 80H
    1267/     5E1 :                     	jr	c, NO_RAM_AREA
    1268/     5E1 :                     	cp	RAM_E >> 8		; 9FH
    1269/     5E1 :                     	jr	nc, NO_RAM_AREA
    1270/     5E1 : [1265]               	ENDIF
    1271/     5E1 :                     
    1272/     5E1 : =>FALSE              	IF	RAM4K
    1273/     5E1 :                     	cp	RAM_B >> 8		; 80H
    1274/     5E1 :                     	jr	c, NO_RAM_AREA
    1275/     5E1 :                     	cp	RAM_E >> 8		; 8FH
    1276/     5E1 :                     	jr	nc, NO_RAM_AREA
    1277/     5E1 : [1272]               	ENDIF
    1278/     5E1 :                     
    1279/     5E1 : 79                  	ld	a, c
    1280/     5E2 : FE 01               	cp	1		;first save?
    1281/     5E4 : 20 09               	jr	nz, icka1
    1282/     5E6 : 11 6D EF            	ld	de, tpt1_f
    1283/     5E9 : 12                  	ld	(de), a		; set trace ON
    1284/     5EA : 22 6F EF            	ld	(tpt1_adr), hl
    1285/     5ED :                     ;	ld	a, (hl)		; get opcode
    1286/     5ED :                     ;	ld	(tpt1_op), a	; save opcode
    1287/     5ED : 18 07               	jr	icka_end
    1288/     5EF :                     icka1:
    1289/     5EF : 11 71 EF            	ld	de, tpt2_f
    1290/     5F2 : 12                  	ld	(de), a		; set trace ON
    1291/     5F3 : 22 73 EF            	ld	(tpt2_adr), hl
    1292/     5F6 :                     ;	ld	a, (hl)		; get opcode
    1293/     5F6 :                     ;	ld	(tpt2_op), a	; save opcode
    1294/     5F6 :                     icka_end:
    1295/     5F6 : AF                  	xor	a
    1296/     5F7 : C9                  	ret
    1297/     5F8 :                     
    1298/     5F8 :                     NO_RAM_AREA:
    1299/     5F8 : 37                  	SCF
    1300/     5F9 : C9                  	ret
    1301/     5FA :                     	
    1302/     5FA :                     
    1303/     5FA :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1304/     5FA :                     ; 2 insertion TC TABLE
    1305/     5FA :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1306/     5FA :                     ;
    1307/     5FA :                     ; 1 byte machine code: branch (RET CC)
    1308/     5FA :                     RETCC_TBLS:
    1309/     5FA : C0                  	DB	0C0H	; RET	NZ
    1310/     5FB : C8                  	DB	0C8H	; RET	Z
    1311/     5FC : D0                  	DB	0D0H	; RET	NC
    1312/     5FD : D8                  	DB	0D8H	; RET	C
    1313/     5FE : E0                  	DB	0E0H	; RET	PO
    1314/     5FF : E8                  	DB	0E8H	; RET	PE
    1315/     600 : F0                  	DB	0F0H	; RET	P
    1316/     601 : F8                  	DB	0F8H	; RET	M
    1317/     602 :                     RETCC_TBLE:
    1318/     602 :                     
    1319/     602 :                     ; 2 byte machine code: branch (JR CC, Relative)
    1320/     602 :                     JRCC_TBLS:
    1321/     602 : 10                  	DB	10H	; DJNZ	$
    1322/     603 : 20                  	DB	20H	; JR	NZ,$
    1323/     604 : 28                  	DB	28H	; JR	Z,$
    1324/     605 : 30                  	DB	30H	; JR	NC,$
    1325/     606 : 38                  	DB	38H	; JR	C,$
    1326/     607 :                     JRCC_TBLE:
    1327/     607 :                     
    1328/     607 :                     ; 3 byte machine code: branch (JP CC, 16bit literal)
    1329/     607 :                     JPCC_TBLS:
    1330/     607 : C2                  	DB	0C2H	; JP	NZ,1234H
    1331/     608 : CA                  	DB	0CAH	; JP	Z,1234H
    1332/     609 : D2                  	DB	0D2H	; JP	NC,1234H
    1333/     60A : DA                  	DB	0DAH	; JP	C,1234H
    1334/     60B : E2                  	DB	0E2H	; JP	PO,1234H
    1335/     60C : EA                  	DB	0EAH	; JP	PE,1234H
    1336/     60D : F2                  	DB	0F2H	; JP	P,1234H
    1337/     60E : FA                  	DB	0FAH	; JP	M,1234H
    1338/     60F :                     JPCC_TBLE:
    1339/     60F :                     
    1340/     60F :                     ; (call 16bit literal)
    1341/     60F :                     CLCC_TBLS:
    1342/     60F : C4                  	DB	0C4H	; CALL	NZ,1234H
    1343/     610 : CC                  	DB	0CCH	; CALL	Z,1234H
    1344/     611 : D4                  	DB	0D4H	; CALL	NC,1234H
    1345/     612 : DC                  	DB	0DCH	; CALL	C,1234H
    1346/     613 : E4                  	DB	0E4H	; CALL	PO,1234H
    1347/     614 : EC                  	DB	0ECH	; CALL	PE,1234H
    1348/     615 : F4                  	DB	0F4H	; CALL	P,1234H
    1349/     616 : FC                  	DB	0FCH	; CALL	M,1234H
    1350/     617 :                     CLCC_TBLE:
    1351/     617 :                     
    1352/     617 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1353/     617 :                     ; 1 insertion TC TABLE
    1354/     617 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1355/     617 :                     
    1356/     617 :                     ; restart
    1357/     617 :                     RST_TBLS:
    1358/     617 : C7                  	DB	0C7H	; RST	00H
    1359/     618 : CF                  	DB	0CFH	; RST	08H
    1360/     619 : D7                  	DB	0D7H	; RST	10H
    1361/     61A : DF                  	DB	0DFH	; RST	18H
    1362/     61B : EF                  	DB	0EFH	; RST	28H
    1363/     61C : E7                  	DB	0E7H	; RST	20H
    1364/     61D : F7                  	DB	0F7H	; RST	30H
    1365/     61E : FF                  	DB	0FFH	; RST	38H
    1366/     61F :                     RST_TBLE:
    1367/     61F :                     
    1368/     61F :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1369/     61F :                     ;;;
    1370/     61F :                     ;;; machine code check(except branch)
    1371/     61F :                     ;;;
    1372/     61F :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1373/     61F :                     INS2:
    1374/     61F :                     
    1375/     61F :                     	; 2byte machine code search
    1376/     61F : 01 12 00            	ld	bc, TWO_OPTBL_E - TWO_OPTBL
    1377/     622 : 21 B8 06            	ld	hl, TWO_OPTBL
    1378/     625 : ED B1               	cpir
    1379/     627 : CA 93 06            	jp	z, meet_op2
    1380/     62A :                     
    1381/     62A :                     	; 3byte machine code search
    1382/     62A : 01 08 00            	ld	bc, THREE_OPTBL_E - THREE_OPTBL
    1383/     62D : 21 CA 06            	ld	hl, THREE_OPTBL
    1384/     630 : ED B1               	cpir
    1385/     632 : CA 9E 06            	jp	z, meet_op3
    1386/     635 :                     
    1387/     635 :                     	; check 0CBH
    1388/     635 :                     	
    1389/     635 :                     	; readjust hl
    1390/     635 : 2A 6A EF            	ld	hl, (tmpT)
    1391/     638 :                     
    1392/     638 : FE CB               	cp	0CBH		; opecode 0CBH?
    1393/     63A : 28 57               	jr	z, meet_op2
    1394/     63C :                     	
    1395/     63C :                     	; check 0DDH
    1396/     63C : FE DD               	cp	0ddh		; opecode 0DDH?
    1397/     63E : 28 0A               	jr	z, meet_dd
    1398/     640 :                     	
    1399/     640 :                     	; check 0EDH
    1400/     640 : FE ED               	cp	0edh		; opecode 0EDH?
    1401/     642 : 28 28               	jr	z, meet_ed
    1402/     644 :                     
    1403/     644 :                     	; check 0FDH
    1404/     644 : FE FD               	cp	0fdh		; opecode 0FDH?
    1405/     646 : 28 02               	jr	z, meet_dd
    1406/     648 :                     
    1407/     648 :                     	; 1byte machine code
    1408/     648 : 18 3E               	jr	meet_op1
    1409/     64A :                     
    1410/     64A :                     	; opecode 0DDh
    1411/     64A :                     meet_dd:
    1412/     64A : 23                  	inc	hl
    1413/     64B : 7E                  	ld	a, (hl)	
    1414/     64C : FE CB               	cp	0cbh		; 2nd 0CBH?
    1415/     64E : 28 59               	jr	z, meet_op4
    1416/     650 : FE 21               	cp	21h		; 2nd 21H?
    1417/     652 : 28 55               	jr	z, meet_op4
    1418/     654 : FE 22               	cp	22h		; 2nd 22H?
    1419/     656 : 28 51               	jr	z, meet_op4
    1420/     658 : FE 2A               	cp	2ah		; 2nd 2AH?
    1421/     65A : 28 4D               	jr	z, meet_op4
    1422/     65C : FE 36               	cp	36h		; 2nd 36H?
    1423/     65E : 28 49               	jr	z, meet_op4
    1424/     660 :                     
    1425/     660 :                     	; 2nd code search
    1426/     660 : 01 0A 00            	ld	bc, DD_2NDTBL_E - DD_2NDTBL
    1427/     663 : 21 D2 06            	ld	hl, DD_2NDTBL
    1428/     666 : ED B1               	cpir
    1429/     668 : 28 29               	jr	z, meet_op2
    1430/     66A : 18 32               	jr	meet_op3
    1431/     66C :                     
    1432/     66C :                     meet_ed:
    1433/     66C : 23                  	inc	hl
    1434/     66D : 7E                  	ld	a, (hl)	
    1435/     66E : FE 43               	cp	43h		; 2nd 43H?
    1436/     670 : 28 37               	jr	z, meet_op4
    1437/     672 : FE 4B               	cp	4bh		; 2nd 4BH?
    1438/     674 : 28 33               	jr	z, meet_op4
    1439/     676 : FE 53               	cp	53h		; 2nd 53H?
    1440/     678 : 28 2F               	jr	z, meet_op4
    1441/     67A : FE 5B               	cp	5bh		; 2nd 5BH?
    1442/     67C : 28 2B               	jr	z, meet_op4
    1443/     67E : FE 73               	cp	73h		; 2nd 73H?
    1444/     680 : 28 27               	jr	z, meet_op4
    1445/     682 : FE 7B               	cp	7bh		; 2nd 7BH?
    1446/     684 : 28 23               	jr	z, meet_op4
    1447/     686 : 18 0B               	jr	meet_op2
    1448/     688 :                     
    1449/     688 :                     ; 1 machine code
    1450/     688 :                     meet_op1:
    1451/     688 : 0E 01               	ld	c, 1
    1452/     68A : CD AB 05            	call	insBRK_1op
    1453/     68D : DA 8A 05            	jp	c, err_trace_seq
    1454/     690 : C3 87 05            	jp	END_INS_TC
    1455/     693 :                     
    1456/     693 :                     ; 2 machine code
    1457/     693 :                     meet_op2:
    1458/     693 : 0E 01               	ld	c, 1
    1459/     695 : CD B0 05            	call	insBRK_2op
    1460/     698 : DA 8A 05            	jp	c, err_trace_seq
    1461/     69B : C3 87 05            	jp	END_INS_TC
    1462/     69E :                     ; 3 machine code
    1463/     69E :                     meet_op3:
    1464/     69E : 0E 01               	ld	c, 1
    1465/     6A0 : CD B5 05            	call	insBRK_3op
    1466/     6A3 : DA 8A 05            	jp	c, err_trace_seq
    1467/     6A6 : C3 87 05            	jp	END_INS_TC
    1468/     6A9 :                     
    1469/     6A9 :                     ; 4 machine codee
    1470/     6A9 :                     meet_op4:
    1471/     6A9 : 0E 01               	ld	c, 1
    1472/     6AB :                     ;	ld	hl, (REGPC)
    1473/     6AB : 2A 6A EF            	ld	hl, (tmpT)
    1474/     6AE : 23                  	inc	hl
    1475/     6AF : CD B8 05            	call	ib3
    1476/     6B2 : DA 8A 05            	jp	c, err_trace_seq
    1477/     6B5 : C3 87 05            	jp	END_INS_TC
    1478/     6B8 :                     
    1479/     6B8 :                     TWO_OPTBL:	; second byte is literal[nn]
    1480/     6B8 : 06                  	DB	06h	; LD	B,nn
    1481/     6B9 : 0E                  	DB	0Eh	; LD	C,nn
    1482/     6BA :                     ;	DB	10h	; DJNZ	nn
    1483/     6BA : 16                  	DB	16h	; LD	D,nn
    1484/     6BB :                     ;	DB	18h	; JR	nn
    1485/     6BB : 1E                  	DB	1Eh	; LD	E,nn
    1486/     6BC :                     ;	DB	20h	; JR	NZ,nn
    1487/     6BC : 26                  	DB	26h	; LD	H,12H
    1488/     6BD :                     ;	DB	28h	; JR	Z,nn
    1489/     6BD : 2E                  	DB	2Eh	; LD	L,nn
    1490/     6BE :                     ;	DB	30h	; JR	NC,nn
    1491/     6BE : 36                  	DB	36h	; LD	(HL),nn
    1492/     6BF :                     ;	DB	38h	; JR	C,nn
    1493/     6BF : 3E                  	DB	3Eh	; LD	A,nn
    1494/     6C0 : C6                  	DB	0C6h	; ADD	A,nn
    1495/     6C1 : CE                  	DB	0CEh	; ADC	A,nn
    1496/     6C2 : D3                  	DB	0D3h	; OUT	(nn),A
    1497/     6C3 : D6                  	DB	0D6h	; SUB	nn
    1498/     6C4 : DB                  	DB	0DBh	; IN	A,(nn)
    1499/     6C5 : DE                  	DB	0DEh	; SBC	A,nn
    1500/     6C6 : E6                  	DB	0E6h	; AND	nn
    1501/     6C7 : EE                  	DB	0EEh	; XOR	nn
    1502/     6C8 : F6                  	DB	0F6h	; OR	nn
    1503/     6C9 : FE                  	DB	0FEh	; CP	nn
    1504/     6CA :                     TWO_OPTBL_E:
    1505/     6CA :                     
    1506/     6CA :                     THREE_OPTBL:	; 2nd, 3rd byte is 16bitliteral[nnnn]
    1507/     6CA : 01                  	DB	01h	; LD	BC,nnnn
    1508/     6CB : 11                  	DB	11h	; LD	DE,nnnn
    1509/     6CC : 21                  	DB	21h	; LD	HL,nnnn
    1510/     6CD : 22                  	DB	22h	; LD	(nnnn),HL
    1511/     6CE : 2A                  	DB	2Ah	; LD	HL,(nnnn)
    1512/     6CF : 31                  	DB	31h	; LD	SP,nnnn
    1513/     6D0 : 32                  	DB	32h	; LD	(nnnn),A
    1514/     6D1 : 3A                  	DB	3Ah	; LD	A,(nnnn)
    1515/     6D2 :                     ;	DB	0C2h	; JP	NZ,nnnn
    1516/     6D2 :                     ;	DB	0C3h	; JP	nnnn
    1517/     6D2 :                     ;	DB	0C4h	; CALL	NZ,nnnn
    1518/     6D2 :                     ;	DB	0CAh	; JP	Z,nnnn
    1519/     6D2 :                     ;	DB	0CCh	; CALL	Z,nnnn
    1520/     6D2 :                     ;	DB	0CDh	; CALL	nnnn
    1521/     6D2 :                     ;	DB	0D2h	; JP	NC,nnnn
    1522/     6D2 :                     ;	DB	0D4h	; CALL	NC,nnnn
    1523/     6D2 :                     ;	DB	0DAh	; JP	C,nnnn
    1524/     6D2 :                     ;	DB	0DCh	; CALL	C,nnnn
    1525/     6D2 :                     ;	DB	0E2h	; JP	PO,nnnn
    1526/     6D2 :                     ;	DB	0E4h	; CALL	PO,nnnn
    1527/     6D2 :                     ;	DB	0EAh	; JP	PE,nnnn
    1528/     6D2 :                     ;	DB	0ECh	; CALL	PE,nnnn
    1529/     6D2 :                     ;	DB	0F2h	; JP	P,nnnn
    1530/     6D2 :                     ;	DB	0F4h	; CALL	P,nnnn
    1531/     6D2 :                     ;	DB	0FAh	; JP	M,nnnn
    1532/     6D2 :                     ;	DB	0FCh	; CALL	M,nnnn
    1533/     6D2 :                     THREE_OPTBL_E:
    1534/     6D2 :                     
    1535/     6D2 :                     DD_2NDTBL:
    1536/     6D2 : 09                  	DB	09h	; ADD	IX,BC
    1537/     6D3 : 19                  	DB	19h	; ADD	IX,DE
    1538/     6D4 : 23                  	DB	23h	; INC	IX
    1539/     6D5 : 29                  	DB	29h	; ADD	IX,IX
    1540/     6D6 : 2B                  	DB	2Bh	; DEC	IX
    1541/     6D7 : 39                  	DB	39h	; ADD	IX,SP
    1542/     6D8 : E1                  	DB	0E1h	; POP	IX
    1543/     6D9 : E3                  	DB	0E3h	; EX	(SP),IX
    1544/     6DA : E5                  	DB	0E5h	; PUSH	IX
    1545/     6DB :                     ;	DB	0E9h	; JP	(IX)
    1546/     6DB : F9                  	DB	0F9h	; LD	SP,IX
    1547/     6DC :                     DD_2NDTBL_E:
    1548/     6DC :                     
    1549/     6DC :                     ;;; 
    1550/     6DC :                     ;;; Dump memory
    1551/     6DC :                     ;;; 
    1552/     6DC :                     
    1553/     6DC :                     DUMP:
    1554/     6DC : 23                  	INC	HL
    1555/     6DD : CD A9 0C            	CALL	SKIPSP
    1556/     6E0 : CD B9 0C            	CALL	RDHEX		; 1st arg.
    1557/     6E3 : 30 14               	jr	nc, DP0
    1558/     6E5 :                     	;; No arg. chk
    1559/     6E5 : CD A9 0C            	CALL	SKIPSP
    1560/     6E8 : 7E                  	LD	A,(HL)
    1561/     6E9 : B7                  	OR	A
    1562/     6EA : C2 67 01            	JP	NZ,ERR
    1563/     6ED : 2A 30 EF            	LD	HL,(DSADDR)
    1564/     6F0 : 01 80 00            	LD	BC,128
    1565/     6F3 : 09                  	ADD	HL,BC
    1566/     6F4 : 22 32 EF            	LD	(DEADDR),HL
    1567/     6F7 : 18 2F               	JR	DPM
    1568/     6F9 :                     
    1569/     6F9 :                     	;; 1st arg. found
    1570/     6F9 :                     DP0:
    1571/     6F9 : ED 53 30 EF         	LD	(DSADDR),DE
    1572/     6FD : CD A9 0C            	CALL	SKIPSP
    1573/     700 : 7E                  	LD	A,(HL)
    1574/     701 : FE 2C               	CP	','
    1575/     703 : 28 0D               	JR	Z,DP1
    1576/     705 : B7                  	OR	A
    1577/     706 : C2 67 01            	JP	NZ,ERR
    1578/     709 :                     	;; No 2nd arg.
    1579/     709 : 21 80 00            	LD	HL,128
    1580/     70C : 19                  	ADD	HL,DE
    1581/     70D : 22 32 EF            	LD	(DEADDR),HL
    1582/     710 : 18 16               	JR	DPM
    1583/     712 :                     DP1:
    1584/     712 : 23                  	INC	HL
    1585/     713 : CD A9 0C            	CALL	SKIPSP
    1586/     716 : CD B9 0C            	CALL	RDHEX
    1587/     719 : DA 67 01            	jp	c, ERR
    1588/     71C : CD A9 0C            	CALL	SKIPSP
    1589/     71F : B7                  	OR	A
    1590/     720 : C2 67 01            	jp	nz, ERR
    1591/     723 : 13                  	INC	DE
    1592/     724 : ED 53 32 EF         	LD	(DEADDR),DE
    1593/     728 :                     DPM:
    1594/     728 :                     	;; DUMP main
    1595/     728 : 2A 30 EF            	LD	HL,(DSADDR)
    1596/     72B : 3E F0               	LD	A,0F0H
    1597/     72D : A5                  	AND	L
    1598/     72E : 6F                  	LD	L,A
    1599/     72F : AF                  	XOR	A
    1600/     730 : 32 34 EF            	LD	(DSTATE),A
    1601/     733 :                     DPM0:
    1602/     733 : E5                  	PUSH	HL
    1603/     734 : CD 5A 07            	CALL	DPL
    1604/     737 : E1                  	POP	HL
    1605/     738 : 01 10 00            	LD	BC,16
    1606/     73B : 09                  	ADD	HL,BC
    1607/     73C : CD 2E 14            	CALL	CONST
    1608/     73F : 20 10               	JR	NZ,DPM1
    1609/     741 : 3A 34 EF            	LD	A,(DSTATE)
    1610/     744 : FE 02               	CP	2
    1611/     746 : 38 EB               	JR	C,DPM0
    1612/     748 : 2A 32 EF            	LD	HL,(DEADDR)
    1613/     74B : 22 30 EF            	LD	(DSADDR),HL
    1614/     74E : C3 24 01            	JP	WSTART
    1615/     751 :                     DPM1:
    1616/     751 : 22 30 EF            	LD	(DSADDR),HL
    1617/     754 : CD 23 14            	CALL	CONIN
    1618/     757 : C3 24 01            	JP	WSTART
    1619/     75A :                     
    1620/     75A :                     DPL:
    1621/     75A :                     	;; DUMP line
    1622/     75A : CD F9 0B            	CALL	HEXOUT4
    1623/     75D : E5                  	PUSH	HL
    1624/     75E : 21 F0 11            	LD	HL,DSEP0
    1625/     761 : CD F0 0B            	CALL	STROUT
    1626/     764 : E1                  	POP	HL
    1627/     765 : DD 21 10 EF         	LD	IX,INBUF
    1628/     769 : 06 10               	LD	B,16
    1629/     76B :                     DPL0:
    1630/     76B : CD 94 07            	CALL	DPB
    1631/     76E : 10 FB               	DJNZ	DPL0
    1632/     770 :                     
    1633/     770 : 21 F3 11            	LD	HL,DSEP1
    1634/     773 : CD F0 0B            	CALL	STROUT
    1635/     776 :                     
    1636/     776 : 21 10 EF            	LD	HL,INBUF
    1637/     779 : 06 10               	LD	B,16
    1638/     77B :                     DPL1:
    1639/     77B : 7E                  	LD	A,(HL)
    1640/     77C : 23                  	INC	HL
    1641/     77D : FE 20               	CP	' '
    1642/     77F : 38 09               	JR	C,DPL2
    1643/     781 : FE 7F               	CP	7FH
    1644/     783 : 30 05               	JR	NC,DPL2
    1645/     785 : CD 34 14            	CALL	CONOUT
    1646/     788 : 18 05               	JR	DPL3
    1647/     78A :                     DPL2:
    1648/     78A : 3E 2E               	LD	A,'.'
    1649/     78C : CD 34 14            	CALL	CONOUT
    1650/     78F :                     DPL3:
    1651/     78F : 10 EA               	DJNZ	DPL1
    1652/     791 : C3 3C 0C            	JP	CRLF
    1653/     794 :                     
    1654/     794 :                     DPB:	; Dump byte
    1655/     794 : 3E 20               	LD	A,' '
    1656/     796 : CD 34 14            	CALL	CONOUT
    1657/     799 : 3A 34 EF            	LD	A,(DSTATE)
    1658/     79C : B7                  	OR	A
    1659/     79D : 20 20               	JR	NZ,DPB2
    1660/     79F :                     	; Dump state 0
    1661/     79F : 3A 30 EF            	LD	A,(DSADDR)	; Low byte
    1662/     7A2 : BD                  	CP	L
    1663/     7A3 : 20 06               	JR	NZ,DPB0
    1664/     7A5 : 3A 31 EF            	LD	A,(DSADDR+1)	; High byte
    1665/     7A8 : BC                  	CP	H
    1666/     7A9 : 28 0F               	JR	Z,DPB1
    1667/     7AB :                     DPB0:	; Still 0 or 2
    1668/     7AB : 3E 20               	LD	A,' '
    1669/     7AD : CD 34 14            	CALL	CONOUT
    1670/     7B0 : CD 34 14            	CALL	CONOUT
    1671/     7B3 : DD 77 00            	LD	(IX),A
    1672/     7B6 : 23                  	INC	HL
    1673/     7B7 : DD 23               	INC	IX
    1674/     7B9 : C9                  	RET
    1675/     7BA :                     DPB1:	; Found start address
    1676/     7BA : 3E 01               	LD	A,1
    1677/     7BC : 32 34 EF            	LD	(DSTATE),A
    1678/     7BF :                     DPB2:
    1679/     7BF : 3A 34 EF            	LD	A,(DSTATE)
    1680/     7C2 : FE 01               	CP	1
    1681/     7C4 : 20 E5               	JR	NZ,DPB0
    1682/     7C6 :                     	; Dump state 1
    1683/     7C6 : 7E                  	LD	A,(HL)
    1684/     7C7 : DD 77 00            	LD	(IX),A
    1685/     7CA : CD FE 0B            	CALL	HEXOUT2
    1686/     7CD : 23                  	INC	HL
    1687/     7CE : DD 23               	INC	IX
    1688/     7D0 : 3A 32 EF            	LD	A,(DEADDR)	; Low byte
    1689/     7D3 : BD                  	CP	L
    1690/     7D4 : C0                  	RET	NZ
    1691/     7D5 : 3A 33 EF            	LD	A,(DEADDR+1)	; High byte
    1692/     7D8 : BC                  	CP	H
    1693/     7D9 : C0                  	RET	NZ
    1694/     7DA :                     	; Found end address
    1695/     7DA : 3E 02               	LD	A,2
    1696/     7DC : 32 34 EF            	LD	(DSTATE),A
    1697/     7DF : C9                  	RET
    1698/     7E0 :                     
    1699/     7E0 :                     ;;;
    1700/     7E0 :                     ;;; GO address
    1701/     7E0 :                     ;;; 
    1702/     7E0 :                     
    1703/     7E0 :                     GO:
    1704/     7E0 : ED 5B 52 EF         	ld	de, (REGPC)
    1705/     7E4 : ED 53 64 EF         	ld	(goTmp), de	; save go tmp go address
    1706/     7E8 : 23                  	INC	HL
    1707/     7E9 : CD A9 0C            	CALL	SKIPSP
    1708/     7EC : CD B9 0C            	CALL	RDHEX
    1709/     7EF : 30 03               	jr	nc, gostmp
    1710/     7F1 : B7                  	OR	A
    1711/     7F2 : 28 0A               	JR	Z, g_stpadr
    1712/     7F4 :                     gostmp:
    1713/     7F4 : 7A                  	ld	a, d
    1714/     7F5 : FE F0               	cp	IO_B >> 8	; a - 0F0H
    1715/     7F7 : D2 67 01            	jp	nc, ERR		; detect I/O area
    1716/     7FA : ED 53 64 EF         	LD	(goTmp),DE	; save going address
    1717/     7FE :                     g_stpadr:
    1718/     7FE : CD A9 0C            	CALL	SKIPSP
    1719/     801 : 7E                  	LD	A,(HL)
    1720/     802 : B7                  	or	a
    1721/     803 : 28 18               	jr	z, GO1
    1722/     805 : FE 2C               	cp	','
    1723/     807 : C2 67 01            	jp	nz, ERR
    1724/     80A :                     
    1725/     80A :                     ; set break point with go command
    1726/     80A :                     
    1727/     80A : 23                  	INC	HL
    1728/     80B : CD A9 0C            	CALL	SKIPSP
    1729/     80E : CD B9 0C            	CALL	RDHEX		; 1st arg.
    1730/     811 : DA 67 01            	jp	c, ERR
    1731/     814 :                     
    1732/     814 : 21 7D EF            	ld	hl, tmpb_f	; hl: temp break point buffer
    1733/     817 : CD D5 02            	call	setbpadr
    1734/     81A : DA 67 01            	jp	c, ERR		; address is incorrect
    1735/     81D :                     
    1736/     81D :                     GO1:
    1737/     81D : 2A 64 EF            	LD	hl, (goTmp)
    1738/     820 : 22 52 EF            	ld	(REGPC), hl	; set go address
    1739/     823 :                     
    1740/     823 :                     G0:
    1741/     823 :                     	; set break point
    1742/     823 : 21 75 EF            	ld	hl, bpt1_f
    1743/     826 : 11 77 EF            	ld	de, bpt1_adr
    1744/     829 : CD 9B 08            	call	set_bp
    1745/     82C : 21 79 EF            	ld	hl, bpt2_f
    1746/     82F : 11 7B EF            	ld	de, bpt2_adr
    1747/     832 : CD 9B 08            	call	set_bp
    1748/     835 :                     
    1749/     835 :                     ; check Trace mode
    1750/     835 :                     
    1751/     835 : 3A 6D EF            	ld	a, (tpt1_f)
    1752/     838 : B7                  	or	a
    1753/     839 : 28 1A               	jr	z, donot_trace
    1754/     83B :                     	
    1755/     83B : 2A 6A EF            	ld	hl,(tmpT)
    1756/     83E : 22 52 EF            	ld	(REGPC), hl	; set trace address
    1757/     841 :                     
    1758/     841 : 21 6D EF            	ld	hl, tpt1_f
    1759/     844 : 11 6F EF            	ld	de, tpt1_adr
    1760/     847 : CD 9B 08            	call	set_bp
    1761/     84A : 21 71 EF            	ld	hl, tpt2_f
    1762/     84D : 11 73 EF            	ld	de, tpt2_adr
    1763/     850 : CD 9B 08            	call	set_bp
    1764/     853 : 18 09               	jr	skp_tbp		; skip set tmp bp, if tracing
    1765/     855 :                     
    1766/     855 :                     ; check break pointer
    1767/     855 :                     
    1768/     855 :                     donot_trace:
    1769/     855 : 21 7D EF            	ld	hl, tmpb_f
    1770/     858 : 11 7F EF            	ld	de, tmpb_adr
    1771/     85B : CD 9B 08            	call	set_bp
    1772/     85E :                     
    1773/     85E :                     	;; R register adjustment
    1774/     85E :                     
    1775/     85E :                     skp_tbp:
    1776/     85E : 2A 50 EF            	LD	HL,(REGSP)
    1777/     861 : F9                  	LD	SP,HL
    1778/     862 : 2A 52 EF            	LD	HL,(REGPC)
    1779/     865 : E5                  	PUSH	HL
    1780/     866 : DD 2A 4C EF         	LD	IX,(REGIX)
    1781/     86A : FD 2A 4E EF         	LD	IY,(REGIY)
    1782/     86E : 2A 44 EF            	LD	HL,(REGAFX)
    1783/     871 : E5                  	PUSH	HL
    1784/     872 : ED 4B 46 EF         	LD	BC,(REGBCX)
    1785/     876 : ED 5B 48 EF         	LD	DE,(REGDEX)
    1786/     87A : 2A 4A EF            	LD	HL,(REGHLX)
    1787/     87D : D9                  	EXX
    1788/     87E : F1                  	POP	AF
    1789/     87F : 08                  	EX	AF,AF'
    1790/     880 : 2A 3C EF            	LD	HL,(REGAF)
    1791/     883 : E5                  	PUSH	HL
    1792/     884 : ED 4B 3E EF         	LD	BC,(REGBC)
    1793/     888 : ED 5B 40 EF         	LD	DE,(REGDE)
    1794/     88C : 2A 42 EF            	LD	HL,(REGHL)
    1795/     88F : 3A 54 EF            	LD	A,(REGI)
    1796/     892 : ED 47               	LD	I,A
    1797/     894 : 3A 55 EF            	LD	A,(REGR)
    1798/     897 : ED 4F               	LD	R,A
    1799/     899 : F1                  	POP	AF
    1800/     89A : C9                  	RET			; POP PC
    1801/     89B :                     
    1802/     89B :                     set_bp:
    1803/     89B : 7E                  	ld	a, (hl)
    1804/     89C : B7                  	or	a
    1805/     89D : C8                  	ret	z
    1806/     89E : 23                  	inc	hl	; hl = save opcode buffer
    1807/     89F :                     
    1808/     89F : 1A                  	ld	a, (de)
    1809/     8A0 : 4F                  	ld	c, a
    1810/     8A1 : 13                  	inc	de
    1811/     8A2 : 1A                  	ld	a, (de)
    1812/     8A3 : 47                  	ld	b, a	; bc = break point address
    1813/     8A4 :                     
    1814/     8A4 : 0A                  	ld	a, (bc)	; get save opcode
    1815/     8A5 : 77                  	ld	(hl),a	; save opcode
    1816/     8A6 : 3E FF               	ld	a, 0FFH
    1817/     8A8 : 02                  	ld	(bc), a	; insert RST 38H code
    1818/     8A9 : C9                  	ret
    1819/     8AA :                     	
    1820/     8AA :                     ;;;
    1821/     8AA :                     ;;; SET memory
    1822/     8AA :                     ;;; 
    1823/     8AA :                     
    1824/     8AA :                     SETM:
    1825/     8AA : 23                  	INC	HL
    1826/     8AB : CD A9 0C            	CALL	SKIPSP
    1827/     8AE : CD B9 0C            	CALL	RDHEX
    1828/     8B1 :                     
    1829/     8B1 : DA 67 01            	jp	c, ERR
    1830/     8B4 :                     
    1831/     8B4 : CD A9 0C            	CALL	SKIPSP
    1832/     8B7 : 7E                  	LD	A,(HL)
    1833/     8B8 : B7                  	OR	A
    1834/     8B9 : C2 67 01            	JP	NZ,ERR
    1835/     8BC : 79                  	LD	A,C
    1836/     8BD : B7                  	OR	A
    1837/     8BE : 20 04               	JR	NZ,SM0
    1838/     8C0 : ED 5B 37 EF         	LD	DE,(SADDR)
    1839/     8C4 :                     
    1840/     8C4 :                     
    1841/     8C4 :                     SM0:
    1842/     8C4 : EB                  	EX	DE,HL
    1843/     8C5 :                     SM1:
    1844/     8C5 : CD F9 0B            	CALL	HEXOUT4
    1845/     8C8 : E5                  	PUSH	HL
    1846/     8C9 : 21 F3 11            	LD	HL,DSEP1
    1847/     8CC : CD F0 0B            	CALL	STROUT
    1848/     8CF : E1                  	POP	HL
    1849/     8D0 : 7E                  	LD	A,(HL)
    1850/     8D1 : E5                  	PUSH	HL
    1851/     8D2 : CD FE 0B            	CALL	HEXOUT2
    1852/     8D5 : 3E 20               	LD	A,' '
    1853/     8D7 : CD 34 14            	CALL	CONOUT
    1854/     8DA : CD 58 0C            	CALL	GETLIN
    1855/     8DD : CD A9 0C            	CALL	SKIPSP
    1856/     8E0 : 7E                  	LD	A,(HL)
    1857/     8E1 : B7                  	OR	A
    1858/     8E2 : 20 07               	JR	NZ,SM2
    1859/     8E4 :                     	;; Empty  (Increment address)
    1860/     8E4 : E1                  	POP	HL
    1861/     8E5 : 23                  	INC	HL
    1862/     8E6 : 22 37 EF            	LD	(SADDR),HL
    1863/     8E9 : 18 DA               	JR	SM1
    1864/     8EB :                     SM2:
    1865/     8EB : FE 2D               	CP	'-'
    1866/     8ED : 20 07               	JR	NZ,SM3
    1867/     8EF :                     	;; '-'  (Decrement address)
    1868/     8EF : E1                  	POP	HL
    1869/     8F0 : 2B                  	DEC	HL
    1870/     8F1 : 22 37 EF            	LD	(SADDR),HL
    1871/     8F4 : 18 CF               	JR	SM1
    1872/     8F6 :                     SM3:
    1873/     8F6 : FE 2E               	CP	'.'
    1874/     8F8 : 20 07               	JR	NZ,SM4
    1875/     8FA : E1                  	POP	HL
    1876/     8FB : 22 37 EF            	LD	(SADDR),HL
    1877/     8FE : C3 24 01            	JP	WSTART
    1878/     901 :                     SM4:
    1879/     901 : CD B9 0C            	CALL	RDHEX
    1880/     904 : B7                  	OR	A
    1881/     905 : E1                  	POP	HL
    1882/     906 : CA 67 01            	JP	Z,ERR
    1883/     909 : 73                  	LD	(HL),E
    1884/     90A : 23                  	INC	HL
    1885/     90B : 22 37 EF            	LD	(SADDR),HL	; set value
    1886/     90E :                     
    1887/     90E :                     	; resave opcode for BP command
    1888/     90E : ED 5B 77 EF         	ld	de, (bpt1_adr)
    1889/     912 : 1A                  	ld	a, (de)
    1890/     913 : 32 76 EF            	ld	(bpt1_op), a
    1891/     916 : ED 5B 7B EF         	ld	de, (bpt2_adr)
    1892/     91A : 1A                  	ld	a, (de)
    1893/     91B : 32 7A EF            	ld	(bpt2_op), a
    1894/     91E :                     
    1895/     91E : 18 A5               	JR	SM1
    1896/     920 :                     
    1897/     920 :                     ;;;
    1898/     920 :                     ;;; LOAD HEX file
    1899/     920 :                     ;;;
    1900/     920 :                     
    1901/     920 :                     LOADH:
    1902/     920 :                     	; clear brk point
    1903/     920 : AF                  	xor	a
    1904/     921 : 32 75 EF            	ld	(bpt1_f), a
    1905/     924 : 32 79 EF            	ld	(bpt2_f), a
    1906/     927 :                     	
    1907/     927 : 23                  	INC	HL
    1908/     928 : CD A9 0C            	CALL	SKIPSP
    1909/     92B : CD B9 0C            	CALL	RDHEX
    1910/     92E : CD A9 0C            	CALL	SKIPSP
    1911/     931 : 7E                  	LD	A,(HL)
    1912/     932 : B7                  	OR	A
    1913/     933 : C2 67 01            	JP	NZ,ERR
    1914/     936 :                     
    1915/     936 : 79                  	LD	A,C
    1916/     937 : B7                  	OR	A
    1917/     938 : 20 03               	JR	NZ,LH0
    1918/     93A :                     
    1919/     93A : 11 00 00            	LD	DE,0		;Offset
    1920/     93D :                     LH0:
    1921/     93D : CD 23 14            	CALL	CONIN
    1922/     940 : CD B0 0C            	CALL	UPPER
    1923/     943 : FE 53               	CP	'S'
    1924/     945 : 28 61               	JR	Z,LHS0
    1925/     947 :                     LH1:
    1926/     947 : FE 3A               	CP	':'
    1927/     949 : 28 0D               	JR	Z,LHI0
    1928/     94B :                     LH2:
    1929/     94B :                     	;; Skip to EOL
    1930/     94B : FE 0D               	CP	CR
    1931/     94D : 28 EE               	JR	Z,LH0
    1932/     94F : FE 0A               	CP	LF
    1933/     951 : 28 EA               	JR	Z,LH0
    1934/     953 :                     LH3:
    1935/     953 : CD 23 14            	CALL	CONIN
    1936/     956 : 18 F3               	JR	LH2
    1937/     958 :                     
    1938/     958 :                     LHI0:
    1939/     958 : 3E 2E               	ld	a, '.'
    1940/     95A : CD 34 14            	call	CONOUT
    1941/     95D :                     
    1942/     95D : CD 15 0C            	CALL	HEXIN
    1943/     960 : 4F                  	LD	C,A		; Checksum
    1944/     961 : 47                  	LD	B,A		; Length
    1945/     962 :                     
    1946/     962 : CD 15 0C            	CALL	HEXIN
    1947/     965 : 67                  	LD	H,A		; Address H
    1948/     966 : 81                  	ADD	A,C
    1949/     967 : 4F                  	LD	C,A
    1950/     968 :                     
    1951/     968 : CD 15 0C            	CALL	HEXIN
    1952/     96B : 6F                  	LD	L,A		; Address L
    1953/     96C : 81                  	ADD	A,C
    1954/     96D : 4F                  	LD	C,A
    1955/     96E :                     
    1956/     96E :                     	;; Add offset
    1957/     96E : 19                  	ADD	HL,DE
    1958/     96F :                     
    1959/     96F : CD 15 0C            	CALL	HEXIN
    1960/     972 : 32 3A EF            	LD	(RECTYP),A
    1961/     975 : 81                  	ADD	A,C
    1962/     976 : 4F                  	LD	C,A		; Checksum
    1963/     977 :                     
    1964/     977 : 78                  	LD	A,B
    1965/     978 : B7                  	OR	A
    1966/     979 : 28 14               	JR	Z,LHI3
    1967/     97B :                     LHI1:
    1968/     97B : CD 15 0C            	CALL	HEXIN
    1969/     97E : F5                  	PUSH	AF
    1970/     97F : 81                  	ADD	A,C
    1971/     980 : 4F                  	LD	C,A		; Checksum
    1972/     981 :                     
    1973/     981 : 3A 3A EF            	LD	A,(RECTYP)
    1974/     984 : B7                  	OR	A
    1975/     985 : 20 05               	JR	NZ,LHI20
    1976/     987 :                     
    1977/     987 : F1                  	POP	AF
    1978/     988 : 77                  	LD	(HL),A
    1979/     989 : 23                  	INC	HL
    1980/     98A : 18 01               	JR	LHI2
    1981/     98C :                     LHI20:
    1982/     98C : F1                  	POP	AF
    1983/     98D :                     LHI2:
    1984/     98D : 10 EC               	DJNZ	LHI1
    1985/     98F :                     LHI3:
    1986/     98F : CD 15 0C            	CALL	HEXIN
    1987/     992 : 81                  	ADD	A,C
    1988/     993 : 20 0A               	JR	NZ,LHIE		; Checksum error
    1989/     995 : 3A 3A EF            	LD	A,(RECTYP)
    1990/     998 : B7                  	OR	A
    1991/     999 : CA 53 09            	JP	Z,LH3
    1992/     99C : C3 24 01            	JP	WSTART
    1993/     99F :                     LHIE:
    1994/     99F : 21 CE 11            	LD	HL,IHEMSG
    1995/     9A2 : CD F0 0B            	CALL	STROUT
    1996/     9A5 : C3 24 01            	JP	WSTART
    1997/     9A8 :                     	
    1998/     9A8 :                     LHS0:
    1999/     9A8 : CD 23 14            	CALL	CONIN
    2000/     9AB : 32 3A EF            	LD	(RECTYP),A
    2001/     9AE :                     
    2002/     9AE : CD 15 0C            	CALL	HEXIN
    2003/     9B1 : 47                  	LD	B,A		; Length+3
    2004/     9B2 : 4F                  	LD	C,A		; Checksum
    2005/     9B3 :                     
    2006/     9B3 : CD 15 0C            	CALL	HEXIN
    2007/     9B6 : 67                  	LD	H,A
    2008/     9B7 : 81                  	ADD	A,C
    2009/     9B8 : 4F                  	LD	C,A
    2010/     9B9 :                     	
    2011/     9B9 : CD 15 0C            	CALL	HEXIN
    2012/     9BC : 6F                  	LD	L,A
    2013/     9BD : 81                  	ADD	A,C
    2014/     9BE : 4F                  	LD	C,A
    2015/     9BF :                     
    2016/     9BF : 19                  	ADD	HL,DE
    2017/     9C0 :                     
    2018/     9C0 : 05                  	DEC	B
    2019/     9C1 : 05                  	DEC	B
    2020/     9C2 : 05                  	DEC	B
    2021/     9C3 : 28 15               	JR	Z,LHS3
    2022/     9C5 :                     LHS1:
    2023/     9C5 : CD 15 0C            	CALL	HEXIN
    2024/     9C8 : F5                  	PUSH	AF
    2025/     9C9 : 81                  	ADD	A,C
    2026/     9CA : 4F                  	LD	C,A		; Checksum
    2027/     9CB :                     
    2028/     9CB : 3A 3A EF            	LD	A,(RECTYP)
    2029/     9CE : FE 31               	CP	'1'
    2030/     9D0 : 20 05               	JR	NZ,LHS2
    2031/     9D2 :                     
    2032/     9D2 : F1                  	POP	AF
    2033/     9D3 : 77                  	LD	(HL),A
    2034/     9D4 : 23                  	INC	HL
    2035/     9D5 : 18 01               	JR	LHS20
    2036/     9D7 :                     LHS2:
    2037/     9D7 : F1                  	POP	AF
    2038/     9D8 :                     LHS20:
    2039/     9D8 : 10 EB               	DJNZ	LHS1
    2040/     9DA :                     LHS3:
    2041/     9DA : CD 15 0C            	CALL	HEXIN
    2042/     9DD : 81                  	ADD	A,C
    2043/     9DE : FE FF               	CP	0FFH
    2044/     9E0 : 20 12               	JR	NZ,LHSE
    2045/     9E2 :                     
    2046/     9E2 : 3A 3A EF            	LD	A,(RECTYP)
    2047/     9E5 : FE 37               	CP	'7'
    2048/     9E7 : 28 11               	JR	Z,LHSR
    2049/     9E9 : FE 38               	CP	'8'
    2050/     9EB : 28 0D               	JR	Z,LHSR
    2051/     9ED : FE 39               	CP	'9'
    2052/     9EF : 28 09               	JR	Z,LHSR
    2053/     9F1 : C3 53 09            	JP	LH3
    2054/     9F4 :                     LHSE:
    2055/     9F4 : 21 DB 11            	LD	HL,SHEMSG
    2056/     9F7 : CD F0 0B            	CALL	STROUT
    2057/     9FA :                     LHSR:
    2058/     9FA : C3 24 01            	JP	WSTART
    2059/     9FD :                     	
    2060/     9FD :                     ;;;
    2061/     9FD :                     ;;; SAVE HEX file
    2062/     9FD :                     ;;;
    2063/     9FD :                     
    2064/     9FD :                     SAVEH:
    2065/     9FD : 23                  	INC	HL
    2066/     9FE : 7E                  	LD	A,(HL)
    2067/     9FF : CD B0 0C            	CALL	UPPER
    2068/     A02 : FE 49               	CP	'I'
    2069/     A04 : 28 04               	JR	Z,SH0
    2070/     A06 : FE 53               	CP	'S'
    2071/     A08 : 20 04               	JR	NZ,SH1
    2072/     A0A :                     SH0:
    2073/     A0A : 23                  	INC	HL
    2074/     A0B : 32 39 EF            	LD	(HEXMOD),A
    2075/     A0E :                     SH1:
    2076/     A0E : CD A9 0C            	CALL	SKIPSP
    2077/     A11 : CD B9 0C            	CALL	RDHEX
    2078/     A14 : B7                  	OR	A
    2079/     A15 : 28 1C               	JR	Z,SHE
    2080/     A17 : D5                  	PUSH	DE
    2081/     A18 : DD E1               	POP	IX		; IX = Start address
    2082/     A1A : CD A9 0C            	CALL	SKIPSP
    2083/     A1D : 7E                  	LD	A,(HL)
    2084/     A1E : FE 2C               	CP	','
    2085/     A20 : 20 11               	JR	NZ,SHE
    2086/     A22 : 23                  	INC	HL
    2087/     A23 : CD A9 0C            	CALL	SKIPSP
    2088/     A26 : CD B9 0C            	CALL	RDHEX		; DE = End address
    2089/     A29 : B7                  	OR	A
    2090/     A2A : 28 07               	JR	Z,SHE
    2091/     A2C : CD A9 0C            	CALL	SKIPSP
    2092/     A2F : 7E                  	LD	A,(HL)
    2093/     A30 : B7                  	OR	A
    2094/     A31 : 28 03               	JR	Z,SH2
    2095/     A33 :                     SHE:
    2096/     A33 : C3 67 01            	JP	ERR
    2097/     A36 :                     
    2098/     A36 :                     SH2:
    2099/     A36 : DD E5               	PUSH	IX
    2100/     A38 : E1                  	POP	HL
    2101/     A39 : EB                  	EX	DE,HL
    2102/     A3A : 23                  	INC	HL
    2103/     A3B : B7                  	OR	A
    2104/     A3C : ED 52               	SBC	HL,DE		; HL = Length
    2105/     A3E :                     SH3:
    2106/     A3E : CD 5E 0A            	CALL	SHL00
    2107/     A41 : 7C                  	LD	A,H
    2108/     A42 : B5                  	OR	L
    2109/     A43 : 20 F9               	JR	NZ,SH3
    2110/     A45 :                     
    2111/     A45 : 3A 39 EF            	LD	A,(HEXMOD)
    2112/     A48 : FE 49               	CP	'I'
    2113/     A4A : 20 09               	JR	NZ,SH4
    2114/     A4C :                     	;; End record for Intel HEX
    2115/     A4C : 21 F7 11            	LD	HL,IHEXER
    2116/     A4F : CD F0 0B            	CALL	STROUT
    2117/     A52 : C3 24 01            	JP	WSTART
    2118/     A55 :                     SH4:
    2119/     A55 :                     	;; End record for Motorola S record
    2120/     A55 : 21 05 12            	LD	HL,SRECER
    2121/     A58 : CD F0 0B            	CALL	STROUT
    2122/     A5B : C3 24 01            	JP	WSTART
    2123/     A5E :                     
    2124/     A5E :                     SHL00:
    2125/     A5E : 0E 10               	LD	C,16
    2126/     A60 : 7C                  	LD	A,H
    2127/     A61 : B7                  	OR	A
    2128/     A62 : 20 05               	JR	NZ,SHL0
    2129/     A64 : 7D                  	LD	A,L
    2130/     A65 : B9                  	CP	C
    2131/     A66 : 30 01               	JR	NC,SHL0
    2132/     A68 : 4F                  	LD	C,A
    2133/     A69 :                     SHL0:
    2134/     A69 : 06 00               	LD	B,0
    2135/     A6B : B7                  	OR	A
    2136/     A6C : ED 42               	SBC	HL,BC
    2137/     A6E : 41                  	LD	B,C
    2138/     A6F :                     
    2139/     A6F : 3A 39 EF            	LD	A,(HEXMOD)
    2140/     A72 : FE 49               	CP	'I'
    2141/     A74 : 20 30               	JR	NZ,SHLS
    2142/     A76 :                     
    2143/     A76 :                     	;; Intel HEX
    2144/     A76 : 3E 3A               	LD	A,':'
    2145/     A78 : CD 34 14            	CALL	CONOUT
    2146/     A7B :                     
    2147/     A7B : 78                  	LD	A,B
    2148/     A7C : CD FE 0B            	CALL	HEXOUT2		; Length
    2149/     A7F : 48                  	LD	C,B		; Checksum
    2150/     A80 :                     
    2151/     A80 : 7A                  	LD	A,D
    2152/     A81 : CD FE 0B            	CALL	HEXOUT2
    2153/     A84 : 7A                  	LD	A,D
    2154/     A85 : 81                  	ADD	A,C
    2155/     A86 : 4F                  	LD	C,A
    2156/     A87 :                     	
    2157/     A87 : 7B                  	LD	A,E
    2158/     A88 : CD FE 0B            	CALL	HEXOUT2
    2159/     A8B : 7B                  	LD	A,E
    2160/     A8C : 81                  	ADD	A,C
    2161/     A8D : 4F                  	LD	C,A
    2162/     A8E :                     	
    2163/     A8E : AF                  	XOR	A
    2164/     A8F : CD FE 0B            	CALL	HEXOUT2
    2165/     A92 :                     SHLI0:
    2166/     A92 : 1A                  	LD	A,(DE)
    2167/     A93 : F5                  	PUSH	AF
    2168/     A94 : CD FE 0B            	CALL	HEXOUT2
    2169/     A97 : F1                  	POP	AF
    2170/     A98 : 81                  	ADD	A,C
    2171/     A99 : 4F                  	LD	C,A
    2172/     A9A :                     
    2173/     A9A : 13                  	INC	DE
    2174/     A9B : 10 F5               	DJNZ	SHLI0
    2175/     A9D :                     
    2176/     A9D : 79                  	LD	A,C
    2177/     A9E : ED 44               	NEG
    2178/     AA0 : CD FE 0B            	CALL	HEXOUT2
    2179/     AA3 : C3 3C 0C            	JP	CRLF
    2180/     AA6 :                     
    2181/     AA6 :                     SHLS:
    2182/     AA6 :                     	;; Motorola S record
    2183/     AA6 : 3E 53               	LD	A,'S'
    2184/     AA8 : CD 34 14            	CALL	CONOUT
    2185/     AAB : 3E 31               	LD	A,'1'
    2186/     AAD : CD 34 14            	CALL	CONOUT
    2187/     AB0 :                     
    2188/     AB0 : 78                  	LD	A,B
    2189/     AB1 : C6 03               	ADD	A,2+1		; DataLength + 2(Addr) + 1(Sum)
    2190/     AB3 : 4F                  	LD	C,A
    2191/     AB4 : CD FE 0B            	CALL	HEXOUT2
    2192/     AB7 :                     
    2193/     AB7 : 7A                  	LD	A,D
    2194/     AB8 : CD FE 0B            	CALL	HEXOUT2
    2195/     ABB : 7A                  	LD	A,D
    2196/     ABC : 81                  	ADD	A,C
    2197/     ABD : 4F                  	LD	C,A
    2198/     ABE :                     	
    2199/     ABE : 7B                  	LD	A,E
    2200/     ABF : CD FE 0B            	CALL	HEXOUT2
    2201/     AC2 : 7B                  	LD	A,E
    2202/     AC3 : 81                  	ADD	A,C
    2203/     AC4 : 4F                  	LD	C,A
    2204/     AC5 :                     SHLS0:
    2205/     AC5 : 1A                  	LD	A,(DE)
    2206/     AC6 : F5                  	PUSH	AF
    2207/     AC7 : CD FE 0B            	CALL	HEXOUT2		; Data
    2208/     ACA : F1                  	POP	AF
    2209/     ACB : 81                  	ADD	A,C
    2210/     ACC : 4F                  	LD	C,A
    2211/     ACD :                     
    2212/     ACD : 13                  	INC	DE
    2213/     ACE : 10 F5               	DJNZ	SHLS0
    2214/     AD0 :                     
    2215/     AD0 : 79                  	LD	A,C
    2216/     AD1 : 2F                  	CPL
    2217/     AD2 : CD FE 0B            	CALL	HEXOUT2
    2218/     AD5 : C3 3C 0C            	JP	CRLF
    2219/     AD8 :                     
    2220/     AD8 :                     ;;;
    2221/     AD8 :                     ;;; Register
    2222/     AD8 :                     ;;;
    2223/     AD8 :                     
    2224/     AD8 :                     REG:
    2225/     AD8 : 23                  	INC	HL
    2226/     AD9 : CD A9 0C            	CALL	SKIPSP
    2227/     ADC : CD B0 0C            	CALL	UPPER
    2228/     ADF : B7                  	OR	A
    2229/     AE0 : 20 06               	JR	NZ,RG0
    2230/     AE2 : CD 64 0B            	CALL	RDUMP
    2231/     AE5 : C3 24 01            	JP	WSTART
    2232/     AE8 :                     RG0:
    2233/     AE8 : EB                  	EX	DE,HL
    2234/     AE9 : 21 BB 12            	LD	HL,RNTAB
    2235/     AEC :                     RG1:
    2236/     AEC : BE                  	CP	(HL)
    2237/     AED : 28 0D               	JR	Z,RG2		; Character match
    2238/     AEF : 4F                  	LD	C,A
    2239/     AF0 : 23                  	INC	HL
    2240/     AF1 : 7E                  	LD	A,(HL)
    2241/     AF2 : B7                  	OR	A
    2242/     AF3 : 28 6C               	JR	Z,RGE		; Found end mark
    2243/     AF5 : 79                  	LD	A,C
    2244/     AF6 : 01 05 00            	LD	BC,5
    2245/     AF9 : 09                  	ADD	HL,BC		; Next entry
    2246/     AFA : 18 F0               	JR	RG1
    2247/     AFC :                     RG2:
    2248/     AFC : 23                  	INC	HL
    2249/     AFD : 7E                  	LD	A,(HL)
    2250/     AFE : FE 0F               	CP	0FH		; Link code
    2251/     B00 : 20 0C               	JR	NZ,RG3
    2252/     B02 :                     	;; Next table
    2253/     B02 : 23                  	INC	HL
    2254/     B03 : 4E                  	LD	C,(HL)
    2255/     B04 : 23                  	INC	HL
    2256/     B05 : 66                  	LD	H,(HL)
    2257/     B06 : 69                  	LD	L,C
    2258/     B07 : 13                  	INC	DE
    2259/     B08 : 1A                  	LD	A,(DE)
    2260/     B09 : CD B0 0C            	CALL	UPPER
    2261/     B0C : 18 DE               	JR	RG1
    2262/     B0E :                     RG3:
    2263/     B0E : B7                  	OR	A
    2264/     B0F : 28 50               	JR	Z,RGE		; Found end mark
    2265/     B11 :                     
    2266/     B11 : 4E                  	LD	C,(HL)		; LD C,A???
    2267/     B12 : 23                  	INC	HL
    2268/     B13 : 5E                  	LD	E,(HL)
    2269/     B14 : 23                  	INC	HL
    2270/     B15 : 56                  	LD	D,(HL)
    2271/     B16 : D5                  	PUSH	DE		; Reg storage address
    2272/     B17 : 23                  	INC	HL
    2273/     B18 : 7E                  	LD	A,(HL)
    2274/     B19 : 23                  	INC	HL
    2275/     B1A : 66                  	LD	H,(HL)
    2276/     B1B : 6F                  	LD	L,A		; HL: Reg name
    2277/     B1C : CD F0 0B            	CALL	STROUT
    2278/     B1F : 3E 3D               	LD	A,'='
    2279/     B21 : CD 34 14            	CALL	CONOUT
    2280/     B24 :                     
    2281/     B24 : 79                  	LD	A,C
    2282/     B25 : E6 07               	AND	07H
    2283/     B27 : FE 01               	CP	1
    2284/     B29 : 20 08               	JR	NZ,RG4
    2285/     B2B :                     	;; 8 bit register
    2286/     B2B : E1                  	POP	HL
    2287/     B2C : 7E                  	LD	A,(HL)
    2288/     B2D : E5                  	PUSH	HL
    2289/     B2E : CD FE 0B            	CALL	HEXOUT2
    2290/     B31 : 18 0C               	JR	RG5
    2291/     B33 :                     RG4:
    2292/     B33 :                     	;; 16 bit register
    2293/     B33 : E1                  	POP	HL
    2294/     B34 : E5                  	PUSH	HL
    2295/     B35 : 23                  	INC	HL
    2296/     B36 : 7E                  	LD	A,(HL)
    2297/     B37 : CD FE 0B            	CALL	HEXOUT2
    2298/     B3A : 2B                  	DEC	HL
    2299/     B3B : 7E                  	LD	A,(HL)
    2300/     B3C : CD FE 0B            	CALL	HEXOUT2
    2301/     B3F :                     RG5:
    2302/     B3F : 3E 20               	LD	A,' '
    2303/     B41 : CD 34 14            	CALL	CONOUT
    2304/     B44 : C5                  	PUSH	BC		; C: reg size
    2305/     B45 : CD 58 0C            	CALL	GETLIN
    2306/     B48 : CD A9 0C            	CALL	SKIPSP
    2307/     B4B : CD B9 0C            	CALL	RDHEX
    2308/     B4E : B7                  	OR	A
    2309/     B4F : 28 0D               	JR	Z,RGR
    2310/     B51 : C1                  	POP	BC
    2311/     B52 : E1                  	POP	HL
    2312/     B53 : 79                  	LD	A,C
    2313/     B54 : FE 01               	CP	1
    2314/     B56 : 20 03               	JR	NZ,RG6
    2315/     B58 :                     	;; 8 bit register
    2316/     B58 : 73                  	LD	(HL),E
    2317/     B59 : 18 03               	JR	RG7
    2318/     B5B :                     RG6:
    2319/     B5B :                     	;; 16 bit register
    2320/     B5B : 73                  	LD	(HL),E
    2321/     B5C : 23                  	INC	HL
    2322/     B5D : 72                  	LD	(HL),D
    2323/     B5E :                     RG7:
    2324/     B5E :                     RGR:
    2325/     B5E : C3 24 01            	JP	WSTART
    2326/     B61 :                     RGE:
    2327/     B61 : C3 67 01            	JP	ERR
    2328/     B64 :                     
    2329/     B64 :                     RDUMP:
    2330/     B64 : 21 12 12            	LD	HL,RDTAB
    2331/     B67 :                     RD0:
    2332/     B67 : 5E                  	LD	E,(HL)
    2333/     B68 : 23                  	INC	HL
    2334/     B69 : 56                  	LD	D,(HL)
    2335/     B6A : 23                  	INC	HL
    2336/     B6B : 7A                  	LD	A,D
    2337/     B6C : B3                  	OR	E
    2338/     B6D : CA 3C 0C            	JP	Z,CRLF		; End
    2339/     B70 : D5                  	push	de
    2340/     B71 : EB                  	EX	DE,HL
    2341/     B72 : CD F0 0B            	CALL	STROUT	; print name of register
    2342/     B75 : EB                  	EX	DE,HL
    2343/     B76 : D1                  	pop	de
    2344/     B77 :                     
    2345/     B77 :                     ; flag check
    2346/     B77 : 3E 12               	ld	a, RDSF_H
    2347/     B79 : BA                  	cp	d
    2348/     B7A : 20 07               	jr	nz, rd101
    2349/     B7C : 3E 7D               	ld	a, RDSF_L
    2350/     B7E : BB                  	cp	e
    2351/     B7F : 20 02               	jr	nz, rd101
    2352/     B81 : 18 29               	jr	rd20
    2353/     B83 :                     
    2354/     B83 :                     rd101:
    2355/     B83 : 3E 12               	ld	a, RDSFX_H
    2356/     B85 : BA                  	cp	d
    2357/     B86 : 20 05               	jr	nz, rd10
    2358/     B88 : 3E A4               	ld	a, RDSFX_L
    2359/     B8A : BB                  	cp	e
    2360/     B8B : 28 1F               	jr	z, rd20
    2361/     B8D :                     
    2362/     B8D :                     rd10:
    2363/     B8D : 5E                  	LD	E,(HL)
    2364/     B8E : 23                  	INC	HL
    2365/     B8F : 56                  	LD	D,(HL)
    2366/     B90 : 23                  	INC	HL
    2367/     B91 : 7E                  	LD	A,(HL)
    2368/     B92 : 23                  	INC	HL
    2369/     B93 : EB                  	EX	DE,HL
    2370/     B94 : FE 01               	CP	1
    2371/     B96 : 20 07               	JR	NZ,RD1
    2372/     B98 :                     	;; 1 byte
    2373/     B98 : 7E                  	LD	A,(HL)
    2374/     B99 : CD FE 0B            	CALL	HEXOUT2
    2375/     B9C : EB                  	EX	DE,HL
    2376/     B9D : 18 C8               	JR	RD0
    2377/     B9F :                     RD1:
    2378/     B9F :                     	;; 2 byte
    2379/     B9F : 23                  	INC	HL
    2380/     BA0 : 7E                  	LD	A,(HL)
    2381/     BA1 : CD FE 0B            	CALL	HEXOUT2		; High byte
    2382/     BA4 : 2B                  	DEC	HL
    2383/     BA5 : 7E                  	LD	A,(HL)
    2384/     BA6 : CD FE 0B            	CALL	HEXOUT2		; Low byte
    2385/     BA9 : EB                  	EX	DE,HL
    2386/     BAA : 18 BB               	JR	RD0
    2387/     BAC :                     
    2388/     BAC :                     ; make flag image string
    2389/     BAC :                     rd20:
    2390/     BAC : 5E                  	LD	E,(HL)
    2391/     BAD : 23                  	INC	HL
    2392/     BAE : 56                  	LD	D,(HL)
    2393/     BAF : 23                  	INC	HL
    2394/     BB0 : 1A                  	ld	a, (de)		; get flag values
    2395/     BB1 :                     
    2396/     BB1 : D5                  	push	de
    2397/     BB2 : E5                  	push	hl
    2398/     BB3 :                     
    2399/     BB3 :                     ; make flag image
    2400/     BB3 :                     
    2401/     BB3 : 21 81 EF            	ld	hl, F_bit
    2402/     BB6 : 01 E0 0B            	ld	bc, F_bit_on
    2403/     BB9 : 11 E8 0B            	ld	de, F_bit_off
    2404/     BBC : F5                  	push	af		; adjustment SP. DO NOT DELETE THIS LINE!
    2405/     BBD :                     
    2406/     BBD :                     flg_loop:
    2407/     BBD : F1                  	pop	af		; "push af" before loop back
    2408/     BBE : CB 27               	sla	a
    2409/     BC0 : 30 06               	jr	nc, flg_off
    2410/     BC2 : F5                  	push	af
    2411/     BC3 : 0A                  	ld	a, (bc)
    2412/     BC4 : 77                  	ld	(hl), a
    2413/     BC5 : F1                  	pop	af
    2414/     BC6 : 18 04               	jr	flg_nxt
    2415/     BC8 :                     flg_off:
    2416/     BC8 : F5                  	push	af
    2417/     BC9 : 1A                  	ld	a, (de)
    2418/     BCA : 77                  	ld	(hl), a
    2419/     BCB : F1                  	pop	af
    2420/     BCC :                     
    2421/     BCC :                     flg_nxt:
    2422/     BCC : 03                  	inc	bc
    2423/     BCD : 13                  	inc	de
    2424/     BCE : 23                  	inc	hl
    2425/     BCF :                     
    2426/     BCF : F5                  	push	af
    2427/     BD0 : 7E                  	ld	a, (hl)
    2428/     BD1 : B7                  	or	a		;check delimiter
    2429/     BD2 : 20 E9               	jr	nz, flg_loop
    2430/     BD4 :                     
    2431/     BD4 : F1                  	pop	af		; restore stack position
    2432/     BD5 : 21 81 EF            	ld	hl, F_bit
    2433/     BD8 : CD F0 0B            	call	STROUT		; print flag register for bit imaze
    2434/     BDB :                     
    2435/     BDB : E1                  	pop	hl
    2436/     BDC : D1                  	pop	de
    2437/     BDD :                     
    2438/     BDD : 23                  	inc	hl
    2439/     BDE : 18 87               	JR	RD0
    2440/     BE0 :                     
    2441/     BE0 : 53 5A 2E 48 2E 50   F_bit_on:	db	"SZ.H.PNC"
              BE6 : 4E 43             
    2442/     BE8 : 2E 2E 2E 2E 2E 2E   F_bit_off:	db	"........"
              BEE : 2E 2E             
    2443/     BF0 :                     
    2444/     BF0 :                     
    2445/     BF0 :                     ;;;
    2446/     BF0 :                     ;;; Other support routines
    2447/     BF0 :                     ;;;
    2448/     BF0 :                     
    2449/     BF0 :                     STROUT:
    2450/     BF0 : 7E                  	LD	A,(HL)
    2451/     BF1 : A7                  	AND	A
    2452/     BF2 : C8                  	RET	Z
    2453/     BF3 : CD 34 14            	CALL	CONOUT
    2454/     BF6 : 23                  	INC	HL
    2455/     BF7 : 18 F7               	JR	STROUT
    2456/     BF9 :                     
    2457/     BF9 :                     ; input:  HL
    2458/     BF9 :                     ; output: 4 hex_char output console
    2459/     BF9 :                     
    2460/     BF9 :                     HEXOUT4:
    2461/     BF9 : 7C                  	LD	A,H
    2462/     BFA : CD FE 0B            	CALL	HEXOUT2
    2463/     BFD : 7D                  	LD	A,L
    2464/     BFE :                     
    2465/     BFE :                     ; input:  A
    2466/     BFE :                     ; output: 2 hex_char output console
    2467/     BFE :                     HEXOUT2:
    2468/     BFE : F5                  	PUSH	AF
    2469/     BFF : 1F                  	RRA
    2470/     C00 : 1F                  	RRA
    2471/     C01 : 1F                  	RRA
    2472/     C02 : 1F                  	RRA
    2473/     C03 : CD 07 0C            	CALL	HEXOUT1
    2474/     C06 : F1                  	POP	AF
    2475/     C07 :                     
    2476/     C07 :                     ; input:  A
    2477/     C07 :                     ; output: 1 hex_char output console
    2478/     C07 :                     HEXOUT1:
    2479/     C07 : E6 0F               	AND	0FH
    2480/     C09 : C6 30               	ADD	A,'0'
    2481/     C0B : FE 3A               	CP	'9'+1
    2482/     C0D : DA 34 14            	JP	C,CONOUT
    2483/     C10 : C6 07               	ADD	A,'A'-'9'-1
    2484/     C12 : C3 34 14            	JP	CONOUT
    2485/     C15 :                     
    2486/     C15 :                     HEXIN:
    2487/     C15 : AF                  	XOR	A
    2488/     C16 : CD 1D 0C            	CALL	HI0
    2489/     C19 : 07                  	RLCA
    2490/     C1A : 07                  	RLCA
    2491/     C1B : 07                  	RLCA
    2492/     C1C : 07                  	RLCA
    2493/     C1D :                     HI0:
    2494/     C1D : C5                  	PUSH	BC
    2495/     C1E : 4F                  	LD	C,A
    2496/     C1F : CD 23 14            	CALL	CONIN
    2497/     C22 : CD B0 0C            	CALL	UPPER
    2498/     C25 : FE 30               	CP	'0'
    2499/     C27 : 38 11               	JR	C,HIR
    2500/     C29 : FE 3A               	CP	'9'+1
    2501/     C2B : 38 0A               	JR	C,HI1
    2502/     C2D : FE 41               	CP	'A'
    2503/     C2F : 38 09               	JR	C,HIR
    2504/     C31 : FE 47               	CP	'F'+1
    2505/     C33 : 30 05               	JR	NC,HIR
    2506/     C35 : D6 07               	SUB	'A'-'9'-1
    2507/     C37 :                     HI1:
    2508/     C37 : D6 30               	SUB	'0'
    2509/     C39 : B1                  	OR	C
    2510/     C3A :                     HIR:
    2511/     C3A : C1                  	POP	BC
    2512/     C3B : C9                  	RET
    2513/     C3C :                     	
    2514/     C3C :                     CRLF:
    2515/     C3C : 3E 0D               	LD	A,CR
    2516/     C3E : CD 34 14            	CALL	CONOUT
    2517/     C41 : 3E 0A               	LD	A,LF
    2518/     C43 : C3 34 14            	JP	CONOUT
    2519/     C46 :                     
    2520/     C46 :                     CLR_CRT:
    2521/     C46 : E5                  	PUSH	HL
    2522/     C47 : 21 4F 0C            	LD	HL, ESC_CRT_CLR
    2523/     C4A : CD F0 0B            	CALL	STROUT
    2524/     C4D : E1                  	POP	HL
    2525/     C4E : C9                  	RET
    2526/     C4F :                     	
    2527/     C4F :                     ESC_CRT_CLR:
    2528/     C4F : 1B                  	db	01BH
    2529/     C50 : 5B 32               	db	"[2"
    2530/     C52 : 00                  	db	0
    2531/     C53 :                     
    2532/     C53 :                     
    2533/     C53 :                     GETLIN0:	; input hl
    2534/     C53 :                     
    2535/     C53 : C5                  	PUSH	BC
    2536/     C54 : 06 00               	LD	B,0
    2537/     C56 : 18 06               	jr	GL0
    2538/     C58 :                     
    2539/     C58 :                     GETLIN:
    2540/     C58 : C5                  	PUSH	BC
    2541/     C59 : 21 10 EF            	LD	HL,INBUF
    2542/     C5C : 06 00               	LD	B,0
    2543/     C5E :                     GL0:
    2544/     C5E : CD 23 14            	CALL	CONIN
    2545/     C61 : FE 0D               	CP	CR
    2546/     C63 : 28 3A               	JR	Z,GLE
    2547/     C65 : FE 0A               	CP	LF
    2548/     C67 : 28 36               	JR	Z,GLE
    2549/     C69 : FE 08               	CP	BS
    2550/     C6B : 28 1B               	JR	Z,GLB
    2551/     C6D : FE 7F               	CP	DEL
    2552/     C6F : 28 17               	JR	Z,GLB
    2553/     C71 : FE 20               	CP	' '
    2554/     C73 : 38 E9               	JR	C,GL0
    2555/     C75 : FE 80               	CP	80H
    2556/     C77 : 30 E5               	JR	NC,GL0
    2557/     C79 : 4F                  	LD	C,A
    2558/     C7A : 78                  	LD	A,B
    2559/     C7B : FE 1F               	CP	BUFLEN-1
    2560/     C7D : 30 DF               	JR	NC,GL0	; Too long
    2561/     C7F : 04                  	INC	B
    2562/     C80 : 79                  	LD	A,C
    2563/     C81 : CD 34 14            	CALL	CONOUT
    2564/     C84 : 77                  	LD	(HL),A
    2565/     C85 : 23                  	INC	HL
    2566/     C86 : 18 D6               	JR	GL0
    2567/     C88 :                     GLB:
    2568/     C88 : 78                  	LD	A,B
    2569/     C89 : A7                  	AND	A
    2570/     C8A : 28 D2               	JR	Z,GL0
    2571/     C8C : 05                  	DEC	B
    2572/     C8D : 2B                  	DEC	HL
    2573/     C8E : 3E 08               	LD	A,08H
    2574/     C90 : CD 34 14            	CALL	CONOUT
    2575/     C93 : 3E 20               	LD	A,' '
    2576/     C95 : CD 34 14            	CALL	CONOUT
    2577/     C98 : 3E 08               	LD	A,08H
    2578/     C9A : CD 34 14            	CALL	CONOUT
    2579/     C9D : 18 BF               	JR	GL0
    2580/     C9F :                     GLE:
    2581/     C9F : CD 3C 0C            	CALL	CRLF
    2582/     CA2 : 36 00               	LD	(HL),00H
    2583/     CA4 : 21 10 EF            	LD	HL,INBUF
    2584/     CA7 : C1                  	POP	BC
    2585/     CA8 : C9                  	RET
    2586/     CA9 :                     
    2587/     CA9 :                     SKIPSP:
    2588/     CA9 : 7E                  	LD	A,(HL)
    2589/     CAA : FE 20               	CP	' '
    2590/     CAC : C0                  	RET	NZ
    2591/     CAD : 23                  	INC	HL
    2592/     CAE : 18 F9               	JR	SKIPSP
    2593/     CB0 :                     
    2594/     CB0 :                     UPPER:
    2595/     CB0 : FE 61               	CP	'a'
    2596/     CB2 : D8                  	RET	C
    2597/     CB3 : FE 7B               	CP	'z'+1
    2598/     CB5 : D0                  	RET	NC
    2599/     CB6 : C6 E0               	ADD	A,'A'-'a'
    2600/     CB8 : C9                  	RET
    2601/     CB9 :                     
    2602/     CB9 :                     RDHEX:
    2603/     CB9 : 0E 00               	LD	C,0
    2604/     CBB : 11 00 00            	LD	DE,0
    2605/     CBE :                     RH0:
    2606/     CBE : 7E                  	LD	A,(HL)
    2607/     CBF : CD B0 0C            	CALL	UPPER
    2608/     CC2 : FE 30               	CP	'0'
    2609/     CC4 : 38 2C               	JR	C,RHE
    2610/     CC6 : FE 3A               	CP	'9'+1
    2611/     CC8 : 38 0A               	JR	C,RH1
    2612/     CCA : FE 41               	CP	'A'
    2613/     CCC : 38 24               	JR	C,RHE
    2614/     CCE : FE 47               	CP	'F'+1
    2615/     CD0 : 30 20               	JR	NC,RHE
    2616/     CD2 : D6 07               	SUB	'A'-'9'-1
    2617/     CD4 :                     RH1:
    2618/     CD4 : D6 30               	SUB	'0'
    2619/     CD6 : 17                  	RLA
    2620/     CD7 : 17                  	RLA
    2621/     CD8 : 17                  	RLA
    2622/     CD9 : 17                  	RLA
    2623/     CDA : 17                  	RLA
    2624/     CDB : CB 13               	RL	E
    2625/     CDD : CB 12               	RL	D
    2626/     CDF : 17                  	RLA
    2627/     CE0 : CB 13               	RL	E
    2628/     CE2 : CB 12               	RL	D
    2629/     CE4 : 17                  	RLA
    2630/     CE5 : CB 13               	RL	E
    2631/     CE7 : CB 12               	RL	D
    2632/     CE9 : 17                  	RLA
    2633/     CEA : CB 13               	RL	E
    2634/     CEC : CB 12               	RL	D
    2635/     CEE : 23                  	INC	HL
    2636/     CEF : 0C                  	INC	C
    2637/     CF0 : 18 CC               	JR	RH0
    2638/     CF2 :                     RHE:
    2639/     CF2 : 79                  	ld	a, c
    2640/     CF3 : B7                  	or	a
    2641/     CF4 : 28 06               	jr	z, rhe1
    2642/     CF6 : FE 05               	cp	5
    2643/     CF8 : 30 02               	jr	nc, rhe1
    2644/     CFA : B7                  	or	a	; clear carry
    2645/     CFB : C9                  	ret
    2646/     CFC :                     	
    2647/     CFC :                     rhe1:
    2648/     CFC : 37                  	scf	; set carry
    2649/     CFD : C9                  	RET
    2650/     CFE :                     
    2651/     CFE :                     ;;;
    2652/     CFE :                     ;;; API Handler
    2653/     CFE :                     ;;:   C : API entory NO.
    2654/     CFE :                     ;;;
    2655/     CFE :                     
    2656/     CFE :                     RST30H_IN:
    2657/     CFE :                     
    2658/     CFE : E5                  	PUSH	HL
    2659/     CFF : C5                  	PUSH	BC
    2660/     D00 : 21 0E 0D            	LD	HL,APITBL
    2661/     D03 : 06 00               	LD	B,0
    2662/     D05 : 09                  	ADD	HL,BC
    2663/     D06 : 09                  	ADD	HL,BC
    2664/     D07 : 46                  	LD	B,(HL)
    2665/     D08 : 23                  	INC	HL
    2666/     D09 : 66                  	LD	H,(HL)
    2667/     D0A : 68                  	LD	L,B
    2668/     D0B : C1                  	POP	BC
    2669/     D0C : E3                  	EX	(SP),HL		; Restore HL, jump address on stack top
    2670/     D0D : C9                  	RET
    2671/     D0E :                     
    2672/     D0E :                     APITBL:
    2673/     D0E : 36 0D               	DW	API00		; 00: CSTART
    2674/     D10 : 39 0D               	DW	API01		; 01: WSTART
    2675/     D12 : 34 14               	DW	CONOUT		; 02: CONOUT
    2676/     D14 : F0 0B               	DW	STROUT		; 03: STROUT
    2677/     D16 : 23 14               	DW	CONIN		; 04: CONIN
    2678/     D18 : 2E 14               	DW	CONST		; 05: CONST
    2679/     D1A : 7B 0D               	DW	API06		; 06: PSPEC
    2680/     D1C : F9 0B               	DW	HEXOUT4		; 07: CONOUT HEX4bytes: input HL
    2681/     D1E : FE 0B               	DW	HEXOUT2		; 08: CONOUT HEX2bytes: input A
    2682/     D20 : 07 0C               	DW	HEXOUT1		; 09: CONOUT HEX1byte : input A
    2683/     D22 : 46 0C               	DW	CLR_CRT		; 10: Clear screen (ESC+[2)
    2684/     D24 : 53 0C               	DW	GETLIN0		; 11: GET a line (input HL : input buffer address)
    2685/     D26 : A9 0C               	DW	SKIPSP		; 12: SKIP Spase
    2686/     D28 : 3C 0C               	DW	CRLF		; 13: CONOUT CRLF
    2687/     D2A : B0 0C               	DW	UPPER		; 14: Lower to UPPER
    2688/     D2C : B9 0C               	DW	RDHEX		; 15: get hex number from chr buffer
    2689/     D2E :                     				;     input  HL : hex string buffer
    2690/     D2E :                     				;     output DE : hex number
    2691/     D2E :                     				;            CF=1 : error, C, A = hex counts(1-4)
    2692/     D2E : 30 0F               	DW	DEC_STR		; 16: get decimal srtings
    2693/     D30 :                     				; input hl : return storings buffer addr.
    2694/     D30 :                     				;       de : 16bit binary
    2695/     D30 : 66 0F               	DW	DIV16_8		; 17; division 16bit / 8bit
    2696/     D32 : DC 0F               	DW	MUL_8		; 18: multiply 8bit * 8bit
    2697/     D34 : =>TRUE               	IF RAM12K
    2698/     D34 : 93 0E               	DW	STOPW		; 19: stopwatch
    2699/     D36 : [2697]               	ENDIF
    2700/     D36 :                     
    2701/     D36 :                     	;; CSTART
    2702/     D36 :                     API00:
    2703/     D36 : C3 7B 00            	JP	CSTART
    2704/     D39 :                     
    2705/     D39 :                     	;; WSTART from API
    2706/     D39 :                     API01:
    2707/     D39 : 31 00 EF            	LD	SP,STACKM	; reset SP for monitor
    2708/     D3C :                     
    2709/     D3C :                     ; check stop by bp and trace operation
    2710/     D3C :                     
    2711/     D3C : 3A 7D EF            	ld	a, (tmpb_f)
    2712/     D3F : B7                  	or	a
    2713/     D40 : 28 06               	jr	z, ws_chk1
    2714/     D42 : 21 7E EF            	ld	hl, tmpb_op
    2715/     D45 : CD 64 0E            	call	rstr_tpt
    2716/     D48 :                     ws_chk1:
    2717/     D48 : 3A 6D EF            	ld	a, (tpt1_f)
    2718/     D4B : B7                  	or	a
    2719/     D4C : 28 06               	jr	z, ws_chk2
    2720/     D4E : 21 6E EF            	ld	hl, tpt1_op
    2721/     D51 : CD 64 0E            	call	rstr_tpt
    2722/     D54 :                     
    2723/     D54 :                     ws_chk2:
    2724/     D54 : 3A 71 EF            	ld	a, (tpt2_f)
    2725/     D57 : B7                  	or	a
    2726/     D58 : 28 06               	jr	z, ws_chk3
    2727/     D5A : 21 72 EF            	ld	hl, tpt2_op
    2728/     D5D : CD 64 0E            	call	rstr_tpt
    2729/     D60 :                     ws_chk3:
    2730/     D60 : 3A 79 EF            	ld	a, (bpt2_f)
    2731/     D63 : B7                  	or	a
    2732/     D64 : 28 06               	jr	z, ws_chk4
    2733/     D66 : 21 7A EF            	ld	hl, bpt2_op
    2734/     D69 : CD 70 0E            	call	rstr_bpt
    2735/     D6C :                     ws_chk4:
    2736/     D6C : 3A 75 EF            	ld	a, (bpt1_f)
    2737/     D6F : B7                  	or	a
    2738/     D70 : 28 06               	jr	z, ws_chk5
    2739/     D72 : 21 76 EF            	ld	hl, bpt1_op
    2740/     D75 : CD 70 0E            	call	rstr_bpt
    2741/     D78 :                     ws_chk5:
    2742/     D78 : C3 3A 0E            	JP	backTomon
    2743/     D7B :                     
    2744/     D7B :                     	;; PSPEC
    2745/     D7B :                     API06:
    2746/     D7B : AF                  	XOR	A
    2747/     D7C : C9                  	RET
    2748/     D7D :                     
    2749/     D7D :                     ;;;
    2750/     D7D :                     ;;; Break Point
    2751/     D7D :                     ;;; trace Point
    2752/     D7D :                     ;;; go, stop point
    2753/     D7D :                     ;;; operation handler
    2754/     D7D :                     ;;
    2755/     D7D :                     RST38H_IN:
    2756/     D7D : F5                  	PUSH	AF
    2757/     D7E : ED 5F               	LD	A,R
    2758/     D80 : 32 55 EF            	LD	(REGR),A
    2759/     D83 : ED 57               	LD	A,I
    2760/     D85 : 32 54 EF            	LD	(REGI),A
    2761/     D88 : 22 42 EF            	LD	(REGHL),HL
    2762/     D8B : ED 53 40 EF         	LD	(REGDE),DE
    2763/     D8F : ED 43 3E EF         	LD	(REGBC),BC
    2764/     D93 : E1                  	POP	HL
    2765/     D94 : 22 3C EF            	LD	(REGAF),HL
    2766/     D97 : 08                  	EX	AF,AF'
    2767/     D98 : F5                  	PUSH	AF
    2768/     D99 : D9                  	EXX
    2769/     D9A : 22 4A EF            	LD	(REGHLX),HL
    2770/     D9D : ED 53 48 EF         	LD	(REGDEX),DE
    2771/     DA1 : ED 43 46 EF         	LD	(REGBCX),BC
    2772/     DA5 : E1                  	POP	HL
    2773/     DA6 : 22 44 EF            	LD	(REGAFX),HL
    2774/     DA9 : DD 22 4C EF         	LD	(REGIX),IX
    2775/     DAD : FD 22 4E EF         	LD	(REGIY),IY
    2776/     DB1 : E1                  	POP	HL
    2777/     DB2 : 2B                  	DEC	HL
    2778/     DB3 : 22 52 EF            	LD	(REGPC),HL
    2779/     DB6 : ED 73 50 EF         	LD	(REGSP),SP
    2780/     DBA :                     
    2781/     DBA :                     ; check bp and trace operation
    2782/     DBA :                     
    2783/     DBA : 31 00 EF            	LD	SP,STACKM	; reset SP for monitor
    2784/     DBD : AF                  	xor	a
    2785/     DBE : 57                  	ld	d, a
    2786/     DBF : 5F                  	ld	e, a		;clear msg pointer
    2787/     DC0 :                     
    2788/     DC0 :                     
    2789/     DC0 :                     ; check go, end operation
    2790/     DC0 : 3A 7D EF            	ld	a, (tmpb_f)
    2791/     DC3 : B7                  	or	a
    2792/     DC4 : 28 09               	jr	z, tp_chk1
    2793/     DC6 : 11 81 0E            	ld	de, stpBrk_msg
    2794/     DC9 : 21 7E EF            	ld	hl, tmpb_op
    2795/     DCC : CD 64 0E            	call	rstr_tpt
    2796/     DCF :                     
    2797/     DCF :                     ; check trace operation
    2798/     DCF :                     tp_chk1:
    2799/     DCF : 3A 6D EF            	ld	a, (tpt1_f)
    2800/     DD2 : B7                  	or	a
    2801/     DD3 : 28 09               	jr	z, tp_chk2
    2802/     DD5 : 11 8A 0E            	ld	de, trace_msg
    2803/     DD8 : 21 6E EF            	ld	hl, tpt1_op
    2804/     DDB : CD 64 0E            	call	rstr_tpt
    2805/     DDE :                     
    2806/     DDE :                     tp_chk2:
    2807/     DDE : 3A 71 EF            	ld	a, (tpt2_f)
    2808/     DE1 : B7                  	or	a
    2809/     DE2 : 28 09               	jr	z, chk_bp
    2810/     DE4 :                     
    2811/     DE4 : 11 8A 0E            	ld	de, trace_msg
    2812/     DE7 : 21 72 EF            	ld	hl, tpt2_op
    2813/     DEA : CD 64 0E            	call	rstr_tpt
    2814/     DED :                     
    2815/     DED :                     ; check set break point
    2816/     DED :                     
    2817/     DED :                     chk_bp:
    2818/     DED : 3A 79 EF            	ld	a, (bpt2_f)
    2819/     DF0 : B7                  	or	a
    2820/     DF1 : 28 09               	jr	z, bp_chk1
    2821/     DF3 : 11 81 0E            	ld	de, stpBrk_msg
    2822/     DF6 : 21 7A EF            	ld	hl, bpt2_op
    2823/     DF9 : CD 70 0E            	call	rstr_bpt
    2824/     DFC :                     
    2825/     DFC :                     bp_chk1:
    2826/     DFC : 3A 75 EF            	ld	a, (bpt1_f)
    2827/     DFF : B7                  	or	a
    2828/     E00 : 28 09               	jr	z, bp_chk_end
    2829/     E02 : 11 81 0E            	ld	de, stpBrk_msg
    2830/     E05 : 21 76 EF            	ld	hl, bpt1_op
    2831/     E08 : CD 70 0E            	call	rstr_bpt
    2832/     E0B :                     
    2833/     E0B :                     bp_chk_end:
    2834/     E0B : 7A                  	ld	a, d
    2835/     E0C : B3                  	or	e
    2836/     E0D : 20 03               	jr	nz, no_rst38_msg
    2837/     E0F :                     
    2838/     E0F :                     	; set RST 38H message
    2839/     E0F : 11 77 0E            	LD	de,RST38MSG
    2840/     E12 :                     
    2841/     E12 :                     no_rst38_msg:
    2842/     E12 : 1A                  	ld	a, (de)		; get first char of message
    2843/     E13 : FE 54               	cp	'T'		; trace ?
    2844/     E15 : 28 09               	jr	z, chk_ntrace
    2845/     E17 :                     	
    2846/     E17 : EB                  	ex	de, hl
    2847/     E18 : CD F0 0B            	CALL	STROUT
    2848/     E1B :                     
    2849/     E1B :                     	;; R register adjustment
    2850/     E1B :                     
    2851/     E1B : CD 64 0B            	CALL	RDUMP
    2852/     E1E : 18 1A               	jr	backTomon	; goto WBOOT
    2853/     E20 :                     
    2854/     E20 :                     ;
    2855/     E20 :                     ; check continue trace operation
    2856/     E20 :                     ;
    2857/     E20 :                     chk_ntrace:
    2858/     E20 : 3A 66 EF            	ld	a, (TP_mode)
    2859/     E23 : FE 46               	cp	'F'		; chk
    2860/     E25 : 28 07               	jr	z, skp_rmsg
    2861/     E27 :                     
    2862/     E27 :                     ;no_trace:
    2863/     E27 : EB                  	ex	de, hl
    2864/     E28 : CD F0 0B            	CALL	STROUT
    2865/     E2B :                     
    2866/     E2B :                     	;; R register adjustment
    2867/     E2B :                     
    2868/     E2B : CD 64 0B            	CALL	RDUMP
    2869/     E2E :                     
    2870/     E2E :                     skp_rmsg:
    2871/     E2E : CD 2E 14            	call	CONST
    2872/     E31 : 28 13               	jr	z, t_no_ky		; no key in
    2873/     E33 : CD 23 14            	call	CONIN
    2874/     E36 : FE 03               	cp	03h	; chk CTL+C
    2875/     E38 : 20 0C               	jr	nz, t_no_ky
    2876/     E3A :                     
    2877/     E3A :                     	; stop_trace
    2878/     E3A :                     backTomon:
    2879/     E3A : AF                  	xor	a
    2880/     E3B : 32 6C EF            	ld	(fever_t), a	; clear forever flag
    2881/     E3E : 67                  	ld	h, a
    2882/     E3F : 6F                  	ld	l, a
    2883/     E40 : 22 68 EF            	ld	(TC_cnt), hl
    2884/     E43 : C3 24 01            	JP	WSTART
    2885/     E46 :                     	
    2886/     E46 :                     	; check trace forever
    2887/     E46 :                     t_no_ky:
    2888/     E46 : 3A 6C EF            	ld	a, (fever_t)
    2889/     E49 : B7                  	or	a
    2890/     E4A : C2 5B 0E            	jp	nz, repeat_trace
    2891/     E4D :                     
    2892/     E4D : 2A 68 EF            	ld	hl, (TC_cnt)
    2893/     E50 : 2B                  	dec	hl
    2894/     E51 : 22 68 EF            	ld	(TC_cnt), hl
    2895/     E54 : 7D                  	ld	a, l
    2896/     E55 : B4                  	or	h
    2897/     E56 : 20 03               	jr	nz, repeat_trace
    2898/     E58 : C3 24 01            	JP	WSTART
    2899/     E5B :                     
    2900/     E5B :                     repeat_trace:
    2901/     E5B : 2A 52 EF            	ld	hl, (REGPC)
    2902/     E5E : 22 6A EF            	ld	(tmpT), hl
    2903/     E61 : C3 65 04            	jp	t_op_chk
    2904/     E64 :                     
    2905/     E64 :                     rstr_tpt:	; HL=buffer point
    2906/     E64 : E5                  	push	hl
    2907/     E65 : 7E                  	ld	a, (hl)
    2908/     E66 : 23                  	inc	hl
    2909/     E67 : 4E                  	ld	c, (hl)
    2910/     E68 : 23                  	inc	hl
    2911/     E69 : 46                  	ld	b, (hl)
    2912/     E6A :                     
    2913/     E6A : 02                  	ld	(bc), a		; restor OP CODE
    2914/     E6B : E1                  	pop	hl
    2915/     E6C : AF                  	xor	a
    2916/     E6D : 2B                  	dec	hl
    2917/     E6E : 77                  	ld	(hl), a		; clear trace flag
    2918/     E6F : C9                  	ret
    2919/     E70 :                     
    2920/     E70 :                     rstr_bpt:	; HL=buffer point
    2921/     E70 : 7E                  	ld	a, (hl)
    2922/     E71 : 23                  	inc	hl
    2923/     E72 : 4E                  	ld	c, (hl)
    2924/     E73 : 23                  	inc	hl
    2925/     E74 : 46                  	ld	b, (hl)
    2926/     E75 :                     
    2927/     E75 : 02                  	ld	(bc), a		; restor OP CODE
    2928/     E76 : C9                  	ret
    2929/     E77 :                     
    2930/     E77 :                     RST38MSG:
    2931/     E77 : 52 53 54 20 33 38   	DB	"RST 38H",CR,LF,00H
              E7D : 48 0D 0A 00       
    2932/     E81 :                     stpBrk_msg:	
    2933/     E81 : 42 72 65 61 6B 21   	db	"Break!",CR,LF,00H
              E87 : 0D 0A 00          
    2934/     E8A :                     trace_msg:	
    2935/     E8A : 54 72 61 63 65 21   	db	"Trace!",CR,LF,00H
              E90 : 0D 0A 00          
    2936/     E93 :                     
    2937/     E93 : =>TRUE               	IF RAM12K
    2938/     E93 :                     STOPW:
    2939/     E93 :                     	; (input) A = 0 : start timer, (output) none
    2940/     E93 :                     	; (input) A = 1 : stop timer,  (output) BC : msec time, DE : Sec time
    2941/     E93 :                     	; (input) A = 2 : lap timer,   (output) BC : msec time, DE : Sec time
    2942/     E93 :                     	; (input) A = 3 : clear timer counter,  (output) none
    2943/     E93 :                     
    2944/     E93 : F5                  	push	af
    2945/     E94 : E5                  	push	hl
    2946/     E95 : FE 00               	cp	0
    2947/     E97 : 28 0F               	jr	z, start_tim
    2948/     E99 : FE 01               	cp	1
    2949/     E9B : 28 14               	jr	z, stop_tim
    2950/     E9D : FE 02               	cp	2
    2951/     E9F : 28 16               	jr	z, lap_tim
    2952/     EA1 : FE 03               	cp	3
    2953/     EA3 : 28 50               	jr	z, clr_tim
    2954/     EA5 : E1                  	pop	hl
    2955/     EA6 : F1                  	pop	af
    2956/     EA7 : C9                  	ret
    2957/     EA8 :                     
    2958/     EA8 :                     start_tim:
    2959/     EA8 : 21 00 F8            	ld	hl, TIM0_CTL0
    2960/     EAB : 3E 90               	ld	a, 90h
    2961/     EAD : 77                  	ld	(hl),a		; enable timer 0
    2962/     EAE : E1                  	pop	hl
    2963/     EAF : F1                  	pop	af
    2964/     EB0 : C9                  	ret
    2965/     EB1 :                     	
    2966/     EB1 :                     stop_tim:
    2967/     EB1 : 21 00 F8            	ld	hl, TIM0_CTL0
    2968/     EB4 : 3E 10               	ld	a, 10h
    2969/     EB6 : 77                  	ld	(hl), a		; disable timer 0
    2970/     EB7 :                     
    2971/     EB7 :                     	; save timer counter
    2972/     EB7 :                     
    2973/     EB7 :                     lap_tim:
    2974/     EB7 : 3A 10 F8            	ld	a, (TIMER0_CNTL)
    2975/     EBA : 32 56 EF            	ld	(c16b), a
    2976/     EBD : 3A 11 F8            	ld	a, (TIMER0_CNTH)
    2977/     EC0 : 32 57 EF            	ld	(c16b+1), a
    2978/     EC3 :                     
    2979/     EC3 :                     ; adjust 16bit counter
    2980/     EC3 :                     
    2981/     EC3 : 01 E1 87            	ld	bc, TIMER0_INITC
    2982/     EC6 : 2A 56 EF            	ld	hl, (c16b)
    2983/     EC9 : 7C                  	ld	a, h
    2984/     ECA : B5                  	or	l	; HL = 0?
    2985/     ECB : 20 06               	jr	nz, adj_tim1
    2986/     ECD : ED 43 56 EF         	ld	(c16b), bc
    2987/     ED1 : 18 05               	jr	rd_sec
    2988/     ED3 :                     
    2989/     ED3 :                     adj_tim1:
    2990/     ED3 : ED 42               	sbc	hl, bc
    2991/     ED5 : 22 56 EF            	ld	(c16b), hl
    2992/     ED8 :                     
    2993/     ED8 :                     ; read seconds counter
    2994/     ED8 :                     
    2995/     ED8 :                     rd_sec:
    2996/     ED8 : 3A 20 F8            	ld	a, (TIMER0_SCTL)
    2997/     EDB : 32 58 EF            	ld	(secb), a
    2998/     EDE : 3A 21 F8            	ld	a, (TIMER0_SCTH)
    2999/     EE1 : 32 59 EF            	ld	(secb+1), a
    3000/     EE4 :                     
    3001/     EE4 :                     	; convert msec from 16bit counter
    3002/     EE4 :                     
    3003/     EE4 : 2A 56 EF            	ld	hl,(c16b)
    3004/     EE7 : CD 14 0F            	call	chg_msec	; result BC
    3005/     EEA : ED 43 5A EF         	ld	(msecb),bc	; save result
    3006/     EEE : ED 5B 58 EF         	ld	de,(secb)	; get sec counter
    3007/     EF2 : E1                  	pop	hl
    3008/     EF3 : F1                  	pop	af
    3009/     EF4 : C9                  	ret
    3010/     EF5 :                     
    3011/     EF5 :                     clr_tim:
    3012/     EF5 : AF                  	xor	a
    3013/     EF6 : 67                  	ld	h, a
    3014/     EF7 : 6F                  	ld	l, a
    3015/     EF8 : 22 5A EF            	ld	(msecb), hl
    3016/     EFB : 22 58 EF            	ld	(secb), hl
    3017/     EFE : 22 56 EF            	ld	(c16b), hl
    3018/     F01 :                     	
    3019/     F01 : 32 20 F8            	ld	(TIMER0_SCTL), a
    3020/     F04 : 32 21 F8            	ld	(TIMER0_SCTH), a
    3021/     F07 : 3E E8               	ld	a, 0e8h
    3022/     F09 : 32 10 F8            	ld	(TIMER0_CNTL), a
    3023/     F0C : 3E 86               	ld	a, 86H
    3024/     F0E : 32 11 F8            	ld	(TIMER0_CNTH), a
    3025/     F11 : E1                  	pop	hl
    3026/     F12 : F1                  	pop	af
    3027/     F13 : C9                  	ret
    3028/     F14 :                     
    3029/     F14 :                     chg_msec:
    3030/     F14 : AF                  	xor	a
    3031/     F15 : 47                  	ld	b, a
    3032/     F16 : 4F                  	ld	c ,a		;cear BC
    3033/     F17 : 2A 56 EF            	ld	hl, (c16b)	; get 16bit counter
    3034/     F1A : 7D                  	ld	a, l
    3035/     F1B :                     u_00:
    3036/     F1B : FE 1F               	cp	31
    3037/     F1D : 38 06               	jr	c, u_1
    3038/     F1F : D6 1F               	sub	31
    3039/     F21 :                     u_0:
    3040/     F21 : 6F                  	ld	l, a
    3041/     F22 : 03                  	inc	bc
    3042/     F23 : 18 F6               	jr	u_00
    3043/     F25 :                     
    3044/     F25 :                     u_1:
    3045/     F25 : 7C                  	ld	a, h
    3046/     F26 : B7                  	or	a
    3047/     F27 : C8                  	ret	z	; can't sub
    3048/     F28 :                     
    3049/     F28 : 7D                  	ld	a, l
    3050/     F29 : D6 1F               	sub	31
    3051/     F2B : ED 44               	neg
    3052/     F2D : 25                  	dec	h
    3053/     F2E : 18 F1               	jr	u_0
    3054/     F30 :                     
    3055/     F30 : [2937]               	ENDIF
    3056/     F30 :                     
    3057/     F30 :                     ;
    3058/     F30 :                     ; make decimal string
    3059/     F30 :                     ;
    3060/     F30 :                     ; input HL : output string buffer
    3061/     F30 :                     ;       DE : 16bit binary
    3062/     F30 :                     ;
    3063/     F30 :                     ; output (HL) : decimal strings
    3064/     F30 :                     
    3065/     F30 :                     DEC_STR:
    3066/     F30 : F5                  	PUSH	AF
    3067/     F31 : C5                  	PUSH	BC
    3068/     F32 : D5                  	PUSH	DE
    3069/     F33 : E5                  	push	hl
    3070/     F34 : DD E5               	push	ix
    3071/     F36 :                     
    3072/     F36 : E5                  	push	hl
    3073/     F37 : DD E1               	pop	ix		; ix: save buffer top address
    3074/     F39 :                     
    3075/     F39 : EB                  	ex	de, hl		; hl: 16bit binary, de: buffer
    3076/     F3A : E5                  	push	hl		; save 16bit binary
    3077/     F3B : 21 05 00            	ld	hl, 5
    3078/     F3E : 19                  	add	hl, de		; hl = buffer + 5
    3079/     F3F : AF                  	xor	a
    3080/     F40 : 77                  	ld	(hl), A
    3081/     F41 : EB                  	ex	de, hl		; de: buffer + 5, hl : buffer
    3082/     F42 : E1                  	pop	hl		; hl : 16bit binary
    3083/     F43 : 01 01 00            	LD	BC, 1
    3084/     F46 :                     
    3085/     F46 :                     LOOP_DEC:
    3086/     F46 : 3E 0A               	LD	A, 10
    3087/     F48 : CD 66 0F            	CALL	DIV16_8
    3088/     F4B : F6 30               	OR	30H
    3089/     F4D : 1B                  	DEC	DE
    3090/     F4E : 12                  	LD	(DE), A
    3091/     F4F : 0C                  	INC	C
    3092/     F50 : 7C                  	LD	A, H
    3093/     F51 : B5                  	OR	L
    3094/     F52 : 20 F2               	JR	NZ, LOOP_DEC
    3095/     F54 :                     
    3096/     F54 : 79                  	LD	A, C
    3097/     F55 : FE 06               	CP	6
    3098/     F57 : 28 06               	JR	Z, END_DEC
    3099/     F59 :                     
    3100/     F59 : DD E5               	push	ix
    3101/     F5B : E1                  	pop	hl		; hl : buffer top address
    3102/     F5C : EB                  	EX	DE, HL
    3103/     F5D : ED B0               	LDIR
    3104/     F5F :                     
    3105/     F5F :                     END_DEC:
    3106/     F5F : DD E1               	pop	ix
    3107/     F61 : E1                  	pop	hl
    3108/     F62 : D1                  	POP	DE
    3109/     F63 : C1                  	POP	BC
    3110/     F64 : F1                  	POP	AF
    3111/     F65 : C9                  	RET
    3112/     F66 :                     
    3113/     F66 :                     
    3114/     F66 :                     ; DIV 16bit / 8 bit
    3115/     F66 :                     ; input
    3116/     F66 :                     ;	HL, A
    3117/     F66 :                     ; output
    3118/     F66 :                     ;	result = HL, mod = A
    3119/     F66 :                     
    3120/     F66 :                     DIV16_8:
    3121/     F66 : C5                  	PUSH	BC
    3122/     F67 : D5                  	PUSH	DE
    3123/     F68 :                     
    3124/     F68 : 4F                  	LD	C, A
    3125/     F69 : 06 0F               	LD	B, 15
    3126/     F6B : AF                  	XOR	A
    3127/     F6C : 29                  	ADD	HL, HL
    3128/     F6D : 17                  	RLA
    3129/     F6E : 91                  	SUB	C
    3130/     F6F : 38 0D               	JR	C, D16_MINUS_BEFORE
    3131/     F71 : 29                  	ADD	HL, HL
    3132/     F72 : 2C                  	INC	L
    3133/     F73 :                     
    3134/     F73 :                     D16_PLUS:
    3135/     F73 : 17                  	RLA
    3136/     F74 : 91                  	SUB	C
    3137/     F75 : 38 0C               	JR	C, D16_MINUS_AFTER
    3138/     F77 :                     
    3139/     F77 :                     D16_PLUS_AFTER:
    3140/     F77 : 29                  	ADD	HL, HL
    3141/     F78 : 2C                  	INC	L
    3142/     F79 : 10 F8               	DJNZ	D16_PLUS
    3143/     F7B : C3 87 0F            	JP	D16_END
    3144/     F7E :                     
    3145/     F7E :                     D16_MINUS_BEFORE:
    3146/     F7E : 29                  	ADD	HL, HL
    3147/     F7F :                     
    3148/     F7F :                     D16_MINUS:
    3149/     F7F : 17                  	RLA
    3150/     F80 : 81                  	ADD	A, C
    3151/     F81 : 38 F4               	JR	C, D16_PLUS_AFTER
    3152/     F83 :                     
    3153/     F83 :                     D16_MINUS_AFTER:
    3154/     F83 : 29                  	ADD	HL, HL
    3155/     F84 : 10 F9               	DJNZ	D16_MINUS
    3156/     F86 : 81                  	ADD	A,C
    3157/     F87 :                     D16_END:
    3158/     F87 : D1                  	POP	DE
    3159/     F88 : C1                  	POP	BC
    3160/     F89 : C9                  	RET
    3161/     F8A :                     
    3162/     F8A :                     ;
    3163/     F8A :                     ; input : HL / DE
    3164/     F8A :                     ; output : quotient HL
    3165/     F8A :                     ;	   remainder DE
    3166/     F8A :                     
    3167/     F8A :                     DIV16:
    3168/     F8A : 22 5C EF            	LD	(DIV16_NA), HL
    3169/     F8D : ED 53 5E EF         	LD	(DIV16_NB), DE
    3170/     F91 :                     
    3171/     F91 : AF                  	XOR	A
    3172/     F92 : 32 60 EF            	LD	(DIV16_NC), A
    3173/     F95 : 32 61 EF            	LD	(DIV16_NC+1), A
    3174/     F98 : 32 62 EF            	LD	(DIV16_ND), A
    3175/     F9B : 32 63 EF            	LD	(DIV16_ND+1), A
    3176/     F9E : 06 10               	LD	B, 16
    3177/     FA0 :                     
    3178/     FA0 :                     DIV16_X2:
    3179/     FA0 : 21 60 EF            	LD	HL, DIV16_NC
    3180/     FA3 : CB 26               	SLA	(HL)
    3181/     FA5 : 23                  	INC	HL
    3182/     FA6 : CB 16               	RL	(HL)
    3183/     FA8 :                     
    3184/     FA8 : 21 5C EF            	LD	HL, DIV16_NA
    3185/     FAB : CB 26               	SLA	(HL)
    3186/     FAD : 23                  	INC	HL
    3187/     FAE : CB 16               	RL	(HL)
    3188/     FB0 : 21 62 EF            	LD	HL, DIV16_ND
    3189/     FB3 : CB 16               	RL	(HL)
    3190/     FB5 : 23                  	INC	HL
    3191/     FB6 : CB 16               	RL	(HL)
    3192/     FB8 :                     
    3193/     FB8 : 2A 5E EF            	LD	HL, (DIV16_NB)
    3194/     FBB : 5D                  	LD	E, L
    3195/     FBC : 54                  	LD	D, H
    3196/     FBD : 2A 62 EF            	LD	HL, (DIV16_ND)
    3197/     FC0 : AF                  	XOR	A
    3198/     FC1 : ED 52               	SBC	HL, DE
    3199/     FC3 : 30 02               	JR	NC, DIV16_X0
    3200/     FC5 : 18 0B               	JR	DIV16_X1
    3201/     FC7 :                     
    3202/     FC7 :                     DIV16_X0:
    3203/     FC7 : 22 62 EF            	LD	(DIV16_ND), HL
    3204/     FCA :                     
    3205/     FCA : 3A 60 EF            	LD	A, (DIV16_NC)
    3206/     FCD : F6 01               	OR	1
    3207/     FCF : 32 60 EF            	LD	(DIV16_NC), A
    3208/     FD2 :                     
    3209/     FD2 :                     DIV16_X1:
    3210/     FD2 : 10 CC               	DJNZ	DIV16_X2
    3211/     FD4 :                     
    3212/     FD4 : 2A 60 EF            	LD	HL,(DIV16_NC)
    3213/     FD7 : ED 5B 62 EF         	LD	DE,(DIV16_ND)
    3214/     FDB : C9                  	RET
    3215/     FDC :                     
    3216/     FDC :                     ; 8bit * 8bit : ans = 16bit
    3217/     FDC :                     ; input A , BC
    3218/     FDC :                     ; output HL
    3219/     FDC :                     
    3220/     FDC :                     MUL_8:
    3221/     FDC : F5                  	PUSH	AF
    3222/     FDD : C5                  	PUSH	BC
    3223/     FDE : B7                  	OR	A	; clear carry
    3224/     FDF : 18 04               	JR	ST_MUL8
    3225/     FE1 :                     
    3226/     FE1 :                     LOOP_M8:
    3227/     FE1 : CB 21               	SLA	C
    3228/     FE3 : CB 10               	RL	B
    3229/     FE5 :                     
    3230/     FE5 :                     ST_MUL8:
    3231/     FE5 : 1F                  	RRA
    3232/     FE6 : 30 F9               	JR	NC, LOOP_M8
    3233/     FE8 : 09                  	ADD	HL, BC
    3234/     FE9 : 20 F6               	JR	NZ, LOOP_M8
    3235/     FEB : C1                  	POP	BC
    3236/     FEC : F1                  	POP	AF
    3237/     FED : C9                  	RET
    3238/     FEE :                     ;;;
    3239/     FEE :                     ;;; Messages
    3240/     FEE :                     ;;;
    3241/     FEE :                     
    3242/     FEE : 3F 20 3A 20 43 6F   cmd_hlp:	db	"? : Command Help", CR, LF
              FF4 : 6D 6D 61 6E 64 20 
              FFA : 48 65 6C 70 0D 0A 
    3243/    1000 : 44 5B 61 64 64 72   		db	"D[addr] : Dump Memory [addr]", CR, LF
             1006 : 5D 20 3A 20 44 75 
             100C : 6D 70 20 4D 65 6D 
             1012 : 6F 72 79 20 5B 61 
             1018 : 64 64 72 5D 0D 0A 
    3244/    101E : 53 5B 61 64 64 72   		db	"S[addr] : Set Memory [addr]", CR, LF
             1024 : 5D 20 3A 20 53 65 
             102A : 74 20 4D 65 6D 6F 
             1030 : 72 79 20 5B 61 64 
             1036 : 64 72 5D 0D 0A    
    3245/    103B : 52 5B 72 65 67 5D   		db	"R[reg] : Set or Dump [reg]", CR, LF
             1041 : 20 3A 20 53 65 74 
             1047 : 20 6F 72 20 44 75 
             104D : 6D 70 20 5B 72 65 
             1053 : 67 5D 0D 0A       
    3246/    1057 : 47 5B 61 64 64 72   		db	"G[addr][,stop addr] : Go and Stop specified address", CR, LF
             105D : 5D 5B 2C 73 74 6F 
             1063 : 70 20 61 64 64 72 
             1069 : 5D 20 3A 20 47 6F 
             106F : 20 61 6E 64 20 53 
             1075 : 74 6F 70 20 73 70 
             107B : 65 63 69 66 69 65 
             1081 : 64 20 61 64 64 72 
             1087 : 65 73 73 0D 0A    
    3247/    108C : 4C 20 3A 20 4C 6F   		db	"L : Load Hex File", CR, LF
             1092 : 61 64 20 48 65 78 
             1098 : 20 46 69 6C 65 0D 
             109E : 0A                
    3248/    109F : 50 5B 49 7C 53 5D   		db	"P[I|S] : Save Hex File (I:Intel, S:Motorola", CR, LF
             10A5 : 20 3A 20 53 61 76 
             10AB : 65 20 48 65 78 20 
             10B1 : 46 69 6C 65 20 28 
             10B7 : 49 3A 49 6E 74 65 
             10BD : 6C 2C 20 53 3A 4D 
             10C3 : 6F 74 6F 72 6F 6C 
             10C9 : 61 0D 0A          
    3249/    10CC : 23 4C 7C 4E 75 6D   		db	"#L|Number : Launch program", CR, LF
             10D2 : 62 65 72 20 3A 20 
             10D8 : 4C 61 75 6E 63 68 
             10DE : 20 70 72 6F 67 72 
             10E4 : 61 6D 0D 0A       
    3250/    10E8 : 42 5B 31 7C 32 5B   		db	"B[1|2[,BP addr]] : Set Break Point", CR, LF
             10EE : 2C 42 50 20 61 64 
             10F4 : 64 72 5D 5D 20 3A 
             10FA : 20 53 65 74 20 42 
             1100 : 72 65 61 6B 20 50 
             1106 : 6F 69 6E 74 0D 0A 
    3251/    110C : 42 43 5B 31 7C 32   		db	"BC[1|2] : Clear Break Point", CR, LF
             1112 : 5D 20 3A 20 43 6C 
             1118 : 65 61 72 20 42 72 
             111E : 65 61 6B 20 50 6F 
             1124 : 69 6E 74 0D 0A    
    3252/    1129 : 54 5B 61 64 64 72   		db	"T[addr][,steps|-1] : Trace command", CR, LF
             112F : 5D 5B 2C 73 74 65 
             1135 : 70 73 7C 2D 31 5D 
             113B : 20 3A 20 54 72 61 
             1141 : 63 65 20 63 6F 6D 
             1147 : 6D 61 6E 64 0D 0A 
    3253/    114D : 54 50 5B 4F 4E 7C   		db	"TP[ON|OFF] : Trace Print Mode", CR, LF
             1153 : 4F 46 46 5D 20 3A 
             1159 : 20 54 72 61 63 65 
             115F : 20 50 72 69 6E 74 
             1165 : 20 4D 6F 64 65 0D 
             116B : 0A                
    3254/    116C : 54 4D 5B 49 7C 53   		db	"TM[I|S] : Trace Option for CALL", CR, LF, 00h
             1172 : 5D 20 3A 20 54 72 
             1178 : 61 63 65 20 4F 70 
             117E : 74 69 6F 6E 20 66 
             1184 : 6F 72 20 43 41 4C 
             118A : 4C 0D 0A 00       
    3255/    118E :                     
    3256/    118E :                     OPNMSG:
    3257/    118E : 0D 0A               	DB	CR,LF
    3258/    1190 : 45 4D 55 5A 38 30   	db	"EMUZ80 MONITOR Rev.B01",CR,LF
             1196 : 20 4D 4F 4E 49 54 
             119C : 4F 52 20 52 65 76 
             11A2 : 2E 42 30 31 0D 0A 
    3259/    11A8 : 54 68 69 73 20 6D   	db	"This monitor is based on unimon.",CR,LF,00H
             11AE : 6F 6E 69 74 6F 72 
             11B4 : 20 69 73 20 62 61 
             11BA : 73 65 64 20 6F 6E 
             11C0 : 20 75 6E 69 6D 6F 
             11C6 : 6E 2E 0D 0A 00    
    3260/    11CB :                     
    3261/    11CB :                     PROMPT:
    3262/    11CB : 5D 20 00            	DB	"] ",00H
    3263/    11CE :                     
    3264/    11CE :                     IHEMSG:
    3265/    11CE : 45 72 72 6F 72 20   	DB	"Error ihex",CR,LF,00H
             11D4 : 69 68 65 78 0D 0A 
             11DA : 00                
    3266/    11DB :                     SHEMSG:
    3267/    11DB : 45 72 72 6F 72 20   	DB	"Error srec",CR,LF,00H
             11E1 : 73 72 65 63 0D 0A 
             11E7 : 00                
    3268/    11E8 :                     ERRMSG:
    3269/    11E8 : 45 72 72 6F 72 0D   	DB	"Error",CR,LF,00H
             11EE : 0A 00             
    3270/    11F0 :                     
    3271/    11F0 :                     DSEP0:
    3272/    11F0 : 20 3A 00            	DB	" :",00H
    3273/    11F3 :                     DSEP1:
    3274/    11F3 : 20 3A 20 00         	DB	" : ",00H
    3275/    11F7 :                     IHEXER:
    3276/    11F7 : 3A 30 30 30 30 30           DB	":00000001FF",CR,LF,00H
             11FD : 30 30 31 46 46 0D 
             1203 : 0A 00             
    3277/    1205 :                     SRECER:
    3278/    1205 : 53 39 30 33 30 30           DB	"S9030000FC",CR,LF,00H
             120B : 30 30 46 43 0D 0A 
             1211 : 00                
    3279/    1212 :                     
    3280/    1212 :                     	;; Register dump table
    3281/    1212 : 67 12 3D EF         RDTAB:	DW	RDSA,   REGAF+1
    3282/    1216 : 01                  	DB	1
    3283/    1217 : 6B 12 3E EF         	DW	RDSBC,  REGBC
    3284/    121B : 02                  	DB	2
    3285/    121C : 71 12 40 EF         	DW	RDSDE,  REGDE
    3286/    1220 : 02                  	DB	2
    3287/    1221 : 77 12 42 EF         	DW	RDSHL,  REGHL
    3288/    1225 : 02                  	DB	2
    3289/    1226 : 7D 12 3C EF         	DW	RDSF,   REGAF
    3290/    122A : 01                  	DB	1
    3291/    122B :                     
    3292/    122B : 82 12 4C EF         	DW	RDSIX,  REGIX
    3293/    122F : 02                  	DB	2
    3294/    1230 : 87 12 4E EF         	DW	RDSIY,  REGIY
    3295/    1234 : 02                  	DB	2
    3296/    1235 :                     
    3297/    1235 : 8C 12 45 EF         	DW	RDSAX,  REGAFX+1
    3298/    1239 : 01                  	DB	1
    3299/    123A : 92 12 46 EF         	DW	RDSBCX, REGBCX
    3300/    123E : 02                  	DB	2
    3301/    123F : 98 12 48 EF         	DW	RDSDEX, REGDEX
    3302/    1243 : 02                  	DB	2
    3303/    1244 : 9E 12 4A EF         	DW	RDSHLX, REGHLX
    3304/    1248 : 02                  	DB	2
    3305/    1249 : A4 12 44 EF         	DW	RDSFX,  REGAFX
    3306/    124D : 01                  	DB	1
    3307/    124E :                     
    3308/    124E : A9 12 50 EF         	DW	RDSSP,  REGSP
    3309/    1252 : 02                  	DB	2
    3310/    1253 : AE 12 52 EF         	DW	RDSPC,  REGPC
    3311/    1257 : 02                  	DB	2
    3312/    1258 : B3 12 54 EF         	DW	RDSI,   REGI
    3313/    125C : 01                  	DB	1
    3314/    125D : B7 12 55 EF         	DW	RDSR,   REGR
    3315/    1261 : 01                  	DB	1
    3316/    1262 :                     
    3317/    1262 : 00 00 00 00         	DW	0000H,  0000H
    3318/    1266 : 00                  	DB	0
    3319/    1267 :                     
    3320/    1267 : 41 20 3D 00         RDSA:	DB	"A =",00H
    3321/    126B : 20 42 43 20 3D 00   RDSBC:	DB	" BC =",00H
    3322/    1271 : 20 44 45 20 3D 00   RDSDE:	DB	" DE =",00H
    3323/    1277 : 20 48 4C 20 3D 00   RDSHL:	DB	" HL =",00H
    3324/    127D :                     
    3325/    127D : 20 46 20 3D 00      RDSF:	DB	" F =",00H
    3326/    1282 :                     
    3327/    1282 : =12H                 RDSF_H	equ	RDSF >> 8
    3328/    1282 : =7DH                 RDSF_L	equ	RDSF & 0FFh
    3329/    1282 :                     
    3330/    1282 :                     
    3331/    1282 : 20 49 58 3D 00      RDSIX:	DB	" IX=",00H
    3332/    1287 : 20 49 59 3D 00      RDSIY:	DB	" IY=",00H
    3333/    128C : 0D 0A 41 27 3D 00   RDSAX:	DB	CR,LF,"A'=",00H
    3334/    1292 : 20 42 43 27 3D 00   RDSBCX:	DB	" BC'=",00H
    3335/    1298 : 20 44 45 27 3D 00   RDSDEX:	DB	" DE'=",00H
    3336/    129E : 20 48 4C 27 3D 00   RDSHLX:	DB	" HL'=",00H
    3337/    12A4 :                     
    3338/    12A4 : 20 46 27 3D 00      RDSFX:	DB	" F'=",00H
    3339/    12A9 :                     
    3340/    12A9 : =12H                 RDSFX_H	equ	RDSFX >> 8
    3341/    12A9 : =0A4H                RDSFX_L	equ	RDSFX & 0FFh
    3342/    12A9 :                     
    3343/    12A9 : 20 53 50 3D 00      RDSSP:	DB	" SP=",00H
    3344/    12AE : 20 50 43 3D 00      RDSPC:	DB	" PC=",00H
    3345/    12B3 : 20 49 3D 00         RDSI:	DB	" I=",00H
    3346/    12B7 : 20 52 3D 00         RDSR:	DB	" R=",00H
    3347/    12BB :                     
    3348/    12BB :                     RNTAB:
    3349/    12BB : 41 0F               	DB	'A',0FH		; "A?"
    3350/    12BD : 05 13 00 00         	DW	RNTABA,0
    3351/    12C1 : 42 0F               	DB	'B',0FH		; "B?"
    3352/    12C3 : 13 13 00 00         	DW	RNTABB,0
    3353/    12C7 : 43 0F               	DB	'C',0FH		; "C?"
    3354/    12C9 : 35 13 00 00         	DW	RNTABC,0
    3355/    12CD : 44 0F               	DB	'D',0FH		; "D?"
    3356/    12CF : 43 13 00 00         	DW	RNTABD,0
    3357/    12D3 : 45 0F               	DB	'E',0FH		; "E?"
    3358/    12D5 : 65 13 00 00         	DW	RNTABE,0
    3359/    12D9 : 46 0F               	DB	'F',0FH		; "F?"
    3360/    12DB : 73 13 00 00         	DW	RNTABF,0
    3361/    12DF : 48 0F               	DB	'H',0FH		; "H?"
    3362/    12E1 : 81 13 00 00         	DW	RNTABH,0
    3363/    12E5 : 49 0F               	DB	'I',0FH		; "I?"
    3364/    12E7 : B1 13 00 00         	DW	RNTABI,0
    3365/    12EB : 4C 0F               	DB	'L',0FH		; "L?"
    3366/    12ED : A3 13 00 00         	DW	RNTABL,0
    3367/    12F1 : 50 0F               	DB	'P',0FH		; "P?"
    3368/    12F3 : C5 13 00 00         	DW	RNTABP,0
    3369/    12F7 : 52 01               	DB	'R',1		; "R"
    3370/    12F9 : 55 EF 20 14         	DW	REGR,RNR
    3371/    12FD : 53 0F               	DB	'S',0FH		; "S?"
    3372/    12FF : CD 13 00 00         	DW	RNTABS,0
    3373/    1303 :                     
    3374/    1303 : 00 00               	DB	00H,0		; End mark
    3375/    1305 :                     
    3376/    1305 :                     RNTABA:
    3377/    1305 : 00 01               	DB	00H,1		; "A"
    3378/    1307 : 3D EF D5 13         	DW	REGAF+1,RNA
    3379/    130B : 27 01               	DB	27H,1		; "A'"
    3380/    130D :                     ;;	DB	'\'',1		; "A'"
    3381/    130D : 45 EF EE 13         	DW	REGAFX+1,RNAX
    3382/    1311 :                     
    3383/    1311 : 00 00               	DB	00H,0
    3384/    1313 :                     	
    3385/    1313 :                     RNTABB:
    3386/    1313 : 00 01               	DB	00H,1		; "B"
    3387/    1315 : 3F EF DA 13         	DW	REGBC+1,RNB
    3388/    1319 : 27 01               	DB	27H,1		; "B'"
    3389/    131B :                     ;;	DB	'\'',1		; "B'"
    3390/    131B : 47 EF F5 13         	DW	REGBCX+1,RNBX
    3391/    131F : 43 0F               	DB	'C',0FH		; "BC?"
    3392/    1321 : 27 13 00 00         	DW	RNTABBC,0
    3393/    1325 :                     
    3394/    1325 : 00 00               	DB	00H,0		; End mark
    3395/    1327 :                     
    3396/    1327 :                     RNTABBC:
    3397/    1327 : 00 02               	DB	00H,2		; "BC"
    3398/    1329 : 3E EF D7 13         	DW	REGBC,RNBC
    3399/    132D : 27 02               	DB	27H,2		; "BC'"
    3400/    132F :                     ;;	DB	'\'',2		; "BC'"
    3401/    132F : 46 EF F1 13         	DW	REGBCX,RNBCX
    3402/    1333 :                     
    3403/    1333 : 00 00               	DB	00H,0
    3404/    1335 :                     	
    3405/    1335 :                     RNTABC:
    3406/    1335 : 00 01               	DB	00H,1		; "C"
    3407/    1337 : 3E EF DC 13         	DW	REGBC,RNC
    3408/    133B : 27 01               	DB	27H,1		; "C'"
    3409/    133D :                     ;;	DB	'\'',1		; "C'"
    3410/    133D : 46 EF F8 13         	DW	REGBCX,RNCX
    3411/    1341 :                     
    3412/    1341 : 00 00               	DB	00H,0
    3413/    1343 :                     	
    3414/    1343 :                     RNTABD:
    3415/    1343 : 00 01               	DB	00H,1		; "D"
    3416/    1345 : 41 EF E1 13         	DW	REGDE+1,RND
    3417/    1349 : 27 01               	DB	27H,1		; "D'"
    3418/    134B :                     ;;	DB	'\'',1		; "D'"
    3419/    134B : 49 EF FF 13         	DW	REGDEX+1,RNDX
    3420/    134F : 45 0F               	DB	'E',0FH		; "DE?"
    3421/    1351 : 57 13 00 00         	DW	RNTABDE,0
    3422/    1355 :                     
    3423/    1355 : 00 00               	DB	00H,0
    3424/    1357 :                     
    3425/    1357 :                     RNTABDE:
    3426/    1357 : 00 02               	DB	00H,2		; "DE"
    3427/    1359 : 40 EF DE 13         	DW	REGDE,RNDE
    3428/    135D : 27 02               	DB	27H,2		; "DE'"
    3429/    135F :                     ;;	DB	'\'',2		; "DE'"
    3430/    135F : 48 EF FB 13         	DW	REGDEX,RNDEX
    3431/    1363 :                     
    3432/    1363 : 00 00               	DB	00H,0
    3433/    1365 :                     	
    3434/    1365 :                     RNTABE:
    3435/    1365 : 00 01               	DB	00H,1		; "E"
    3436/    1367 : 40 EF E3 13         	DW	REGDE,RNE
    3437/    136B : 27 01               	DB	27H,1		; "E'"
    3438/    136D :                     ;;	DB	'\'',1		; "E'"
    3439/    136D : 48 EF 02 14         	DW	REGDEX,RNEX
    3440/    1371 :                     
    3441/    1371 : 00 00               	DB	00H,0
    3442/    1373 :                     	
    3443/    1373 :                     RNTABF:
    3444/    1373 : 00 01               	DB	00H,1		; "F"
    3445/    1375 : 3C EF EC 13         	DW	REGAF,RNF
    3446/    1379 : 27 01               	DB	27H,1		; "F'"
    3447/    137B :                     ;;	DB	'\'',1		; "F'"
    3448/    137B : 44 EF 0F 14         	DW	REGAFX,RNFX
    3449/    137F :                     
    3450/    137F : 00 00               	DB	00H,0
    3451/    1381 :                     	
    3452/    1381 :                     RNTABH:
    3453/    1381 : 00 01               	DB	00H,1		; "H"
    3454/    1383 : 43 EF E8 13         	DW	REGHL+1,RNH
    3455/    1387 : 27 01               	DB	27H,1		; "H'"
    3456/    1389 :                     ;;	DB	'\'',1		; "H'"
    3457/    1389 : 4B EF 09 14         	DW	REGHLX+1,RNHX
    3458/    138D : 4C 0F               	DB	'L',0FH		; "HL?"
    3459/    138F : 95 13 00 00         	DW	RNTABHL,0
    3460/    1393 :                     
    3461/    1393 : 00 00               	DB	00H,0
    3462/    1395 :                     
    3463/    1395 :                     RNTABHL:
    3464/    1395 : 00 02               	DB	00H,2		; "HL"
    3465/    1397 : 42 EF E5 13         	DW	REGHL,RNHL
    3466/    139B : 27 02               	DB	27H,2		; "HL'"
    3467/    139D :                     ;;	DB	'\'',2		; "HL'"
    3468/    139D : 4A EF 05 14         	DW	REGHLX,RNHLX
    3469/    13A1 :                     
    3470/    13A1 : 00 00               	DB	00H,0
    3471/    13A3 :                     	
    3472/    13A3 :                     RNTABL:
    3473/    13A3 : 00 01               	DB	00H,1		; "L"
    3474/    13A5 : 42 EF EA 13         	DW	REGHL,RNL
    3475/    13A9 : 27 01               	DB	27H,1		; "L'"
    3476/    13AB :                     ;;	DB	'\'',1		; "L'"
    3477/    13AB : 4A EF 0C 14         	DW	REGHLX,RNLX
    3478/    13AF :                     
    3479/    13AF : 00 00               	DB	00H,0
    3480/    13B1 :                     	
    3481/    13B1 :                     RNTABI:
    3482/    13B1 : 00 01               	DB	00H,1		; "I"
    3483/    13B3 : 54 EF 1E 14         	DW	REGI,RNI
    3484/    13B7 : 58 02               	DB	'X',2		; "IX"
    3485/    13B9 : 4C EF 12 14         	DW	REGIX,RNIX
    3486/    13BD : 59 02               	DB	'Y',2		; "IY"
    3487/    13BF : 4E EF 15 14         	DW	REGIY,RNIY
    3488/    13C3 :                     	
    3489/    13C3 : 00 00               	DB	00H,0
    3490/    13C5 :                     
    3491/    13C5 :                     RNTABP:
    3492/    13C5 : 43 02               	DB	'C',2		; "PC"
    3493/    13C7 : 52 EF 1B 14         	DW	REGPC,RNPC
    3494/    13CB :                     
    3495/    13CB : 00 00               	DB	00H,0
    3496/    13CD :                     
    3497/    13CD :                     RNTABS:
    3498/    13CD : 50 02               	DB	'P',2		; "SP"
    3499/    13CF : 50 EF 18 14         	DW	REGSP,RNSP
    3500/    13D3 :                     
    3501/    13D3 : 00 00               	DB	00H,0
    3502/    13D5 :                     
    3503/    13D5 : 41 00               RNA:	DB	"A",00H
    3504/    13D7 : 42 43 00            RNBC:	DB	"BC",00H
    3505/    13DA : 42 00               RNB:	DB	"B",00H
    3506/    13DC : 43 00               RNC:	DB	"C",00H
    3507/    13DE : 44 45 00            RNDE:	DB	"DE",00H
    3508/    13E1 : 44 00               RND:	DB	"D",00H
    3509/    13E3 : 45 00               RNE:	DB	"E",00H
    3510/    13E5 : 48 4C 00            RNHL:	DB	"HL",00H
    3511/    13E8 : 48 00               RNH:	DB	"H",00H
    3512/    13EA : 4C 00               RNL:	DB	"L",00H
    3513/    13EC : 46 00               RNF:	DB	"F",00H
    3514/    13EE : 41 27 00            RNAX:	DB	"A'",00H
    3515/    13F1 : 42 43 27 00         RNBCX:	DB	"BC'",00H
    3516/    13F5 : 42 27 00            RNBX:	DB	"B'",00H
    3517/    13F8 : 43 27 00            RNCX:	DB	"C'",00H
    3518/    13FB : 44 45 27 00         RNDEX:	DB	"DE'",00H
    3519/    13FF : 44 27 00            RNDX:	DB	"D'",00H
    3520/    1402 : 45 27 00            RNEX:	DB	"E'",00H
    3521/    1405 : 48 4C 27 00         RNHLX:	DB	"HL'",00H
    3522/    1409 : 48 27 00            RNHX:	DB	"H'",00H
    3523/    140C : 4C 27 00            RNLX:	DB	"L'",00H
    3524/    140F : 46 27 00            RNFX:	DB	"F'",00H
    3525/    1412 : 49 58 00            RNIX:	DB	"IX",00H
    3526/    1415 : 49 59 00            RNIY:	DB	"IY",00H
    3527/    1418 : 53 50 00            RNSP:	DB	"SP",00H
    3528/    141B : 50 43 00            RNPC:	DB	"PC",00H
    3529/    141E : 49 00               RNI:	DB	"I",00H
    3530/    1420 : 52 00               RNR:	DB	"R",00H
    3531/    1422 :                     
    3532/    1422 :                     ;;;
    3533/    1422 :                     ;;; Cold start for device dependent
    3534/    1422 :                     ;;;
    3535/    1422 :                     INIT:
    3536/    1422 : C9                  	RET
    3537/    1423 :                     
    3538/    1423 :                     ;;;
    3539/    1423 :                     ;;; Console drivers
    3540/    1423 :                     ;;;
    3541/    1423 :                     
    3542/    1423 :                     CONIN:
    3543/    1423 : 3A 01 FF            	LD	A,(UARTCR)
    3544/    1426 : CB 47               	BIT	0,A
    3545/    1428 : 28 F9               	JR	Z,CONIN
    3546/    142A : 3A 00 FF            	LD	A,(UARTDR)
    3547/    142D : C9                  	RET
    3548/    142E :                     
    3549/    142E :                     CONST:
    3550/    142E : 3A 01 FF            	LD	A,(UARTCR)
    3551/    1431 : CB 47               	BIT	0,A
    3552/    1433 : C9                  	RET
    3553/    1434 :                     
    3554/    1434 :                     CONOUT:
    3555/    1434 : F5                  	PUSH	AF
    3556/    1435 : 3A 01 FF            PCST1:	LD	A,(UARTCR)
    3557/    1438 : CB 4F               	BIT	1,A
    3558/    143A : 28 F9               	JR	Z,PCST1
    3559/    143C : F1                  	POP	AF
    3560/    143D : 32 00 FF            	LD	(UARTDR),A
    3561/    1440 : C9                  	RET
    3562/    1441 :                     
    3563/    1441 : FF FF FF FF FF FF   	db	BASIC_TOP - $ dup(0ffH)
             1447 : FF FF FF FF FF FF 
             144D : FF FF FF FF FF FF 
             1453 : FF FF FF FF FF FF 
             1459 : FF FF FF FF FF FF 
             145F : FF FF FF FF FF FF 
             1465 : FF FF FF FF FF FF 
             146B : FF FF FF FF FF FF 
             1471 : FF FF FF FF FF FF 
             1477 : FF FF FF FF FF FF 
             147D : FF FF FF FF FF FF 
             1483 : FF FF FF FF FF FF 
             1489 : FF FF FF FF FF FF 
             148F : FF FF FF FF FF FF 
             1495 : FF FF FF FF FF FF 
             149B : FF FF FF FF FF FF 
             14A1 : FF FF FF FF FF FF 
             14A7 : FF FF FF FF FF FF 
             14AD : FF FF FF FF FF FF 
             14B3 : FF FF FF FF FF FF 
             14B9 : FF FF FF FF FF FF 
             14BF : FF FF FF FF FF FF 
             14C5 : FF FF FF FF FF FF 
             14CB : FF FF FF FF FF FF 
             14D1 : FF FF FF FF FF FF 
             14D7 : FF FF FF FF FF FF 
             14DD : FF FF FF FF FF FF 
             14E3 : FF FF FF FF FF FF 
             14E9 : FF FF FF FF FF FF 
             14EF : FF FF FF FF FF FF 
             14F5 : FF FF FF FF FF FF 
             14FB : FF FF FF FF FF FF 
             1501 : FF FF FF FF FF FF 
             1507 : FF FF FF FF FF FF 
             150D : FF FF FF FF FF FF 
             1513 : FF FF FF FF FF FF 
             1519 : FF FF FF FF FF FF 
             151F : FF FF FF FF FF FF 
             1525 : FF FF FF FF FF FF 
             152B : FF FF FF FF FF FF 
             1531 : FF FF FF FF FF FF 
             1537 : FF FF FF FF FF FF 
             153D : FF FF FF FF FF FF 
             1543 : FF FF FF FF FF FF 
             1549 : FF FF FF FF FF FF 
             154F : FF FF FF FF FF FF 
             1555 : FF FF FF FF FF FF 
             155B : FF FF FF FF FF FF 
             1561 : FF FF FF FF FF FF 
             1567 : FF FF FF FF FF FF 
             156D : FF FF FF FF FF FF 
             1573 : FF FF FF FF FF FF 
             1579 : FF FF FF FF FF FF 
             157F : FF FF FF FF FF FF 
             1585 : FF FF FF FF FF FF 
             158B : FF FF FF FF FF FF 
             1591 : FF FF FF FF FF FF 
             1597 : FF FF FF FF FF FF 
             159D : FF FF FF FF FF FF 
             15A3 : FF FF FF FF FF FF 
             15A9 : FF FF FF FF FF FF 
             15AF : FF FF FF FF FF FF 
             15B5 : FF FF FF FF FF FF 
             15BB : FF FF FF FF FF FF 
             15C1 : FF FF FF FF FF FF 
             15C7 : FF FF FF FF FF FF 
             15CD : FF FF FF FF FF FF 
             15D3 : FF FF FF FF FF FF 
             15D9 : FF FF FF FF FF FF 
             15DF : FF FF FF FF FF FF 
             15E5 : FF FF FF FF FF FF 
             15EB : FF FF FF FF FF FF 
             15F1 : FF FF FF FF FF FF 
             15F7 : FF FF FF FF FF FF 
             15FD : FF FF FF FF FF FF 
             1603 : FF FF FF FF FF FF 
             1609 : FF FF FF FF FF FF 
             160F : FF FF FF FF FF FF 
             1615 : FF FF FF FF FF FF 
             161B : FF FF FF FF FF FF 
             1621 : FF FF FF FF FF FF 
             1627 : FF FF FF FF FF FF 
             162D : FF FF FF FF FF FF 
             1633 : FF FF FF FF FF FF 
             1639 : FF FF FF FF FF FF 
             163F : FF FF FF FF FF FF 
             1645 : FF FF FF FF FF FF 
             164B : FF FF FF FF FF FF 
             1651 : FF FF FF FF FF FF 
             1657 : FF FF FF FF FF FF 
             165D : FF FF FF FF FF FF 
             1663 : FF FF FF FF FF FF 
             1669 : FF FF FF FF FF FF 
             166F : FF FF FF FF FF FF 
             1675 : FF FF FF FF FF FF 
             167B : FF FF FF FF FF FF 
             1681 : FF FF FF FF FF FF 
             1687 : FF FF FF FF FF FF 
             168D : FF FF FF FF FF FF 
             1693 : FF FF FF FF FF FF 
             1699 : FF FF FF FF FF FF 
             169F : FF FF FF FF FF FF 
             16A5 : FF FF FF FF FF FF 
             16AB : FF FF FF FF FF FF 
             16B1 : FF FF FF FF FF FF 
             16B7 : FF FF FF FF FF FF 
             16BD : FF FF FF FF FF FF 
             16C3 : FF FF FF FF FF FF 
             16C9 : FF FF FF FF FF FF 
             16CF : FF FF FF FF FF FF 
             16D5 : FF FF FF FF FF FF 
             16DB : FF FF FF FF FF FF 
             16E1 : FF FF FF FF FF FF 
             16E7 : FF FF FF FF FF FF 
             16ED : FF FF FF FF FF FF 
             16F3 : FF FF FF FF FF FF 
             16F9 : FF FF FF FF FF FF 
             16FF : FF FF FF FF FF FF 
             1705 : FF FF FF FF FF FF 
             170B : FF FF FF FF FF FF 
             1711 : FF FF FF FF FF FF 
             1717 : FF FF FF FF FF FF 
             171D : FF FF FF FF FF FF 
             1723 : FF FF FF FF FF FF 
             1729 : FF FF FF FF FF FF 
             172F : FF FF FF FF FF FF 
             1735 : FF FF FF FF FF FF 
             173B : FF FF FF FF FF FF 
             1741 : FF FF FF FF FF FF 
             1747 : FF FF FF FF FF FF 
             174D : FF FF FF FF FF FF 
             1753 : FF FF FF FF FF FF 
             1759 : FF FF FF FF FF FF 
             175F : FF FF FF FF FF FF 
             1765 : FF FF FF FF FF FF 
             176B : FF FF FF FF FF FF 
             1771 : FF FF FF FF FF FF 
             1777 : FF FF FF FF FF FF 
             177D : FF FF FF FF FF FF 
             1783 : FF FF FF FF FF FF 
             1789 : FF FF FF FF FF FF 
             178F : FF FF FF FF FF FF 
             1795 : FF FF FF FF FF FF 
             179B : FF FF FF FF FF FF 
             17A1 : FF FF FF FF FF FF 
             17A7 : FF FF FF FF FF FF 
             17AD : FF FF FF FF FF FF 
             17B3 : FF FF FF FF FF FF 
             17B9 : FF FF FF FF FF FF 
             17BF : FF FF FF FF FF FF 
             17C5 : FF FF FF FF FF FF 
             17CB : FF FF FF FF FF FF 
             17D1 : FF FF FF FF FF FF 
             17D7 : FF FF FF FF FF FF 
             17DD : FF FF FF FF FF FF 
             17E3 : FF FF FF FF FF FF 
             17E9 : FF FF FF FF FF FF 
             17EF : FF FF FF FF FF FF 
             17F5 : FF FF FF FF FF FF 
             17FB : FF FF FF FF FF FF 
             1801 : FF FF FF FF FF FF 
             1807 : FF FF FF FF FF FF 
             180D : FF FF FF FF FF FF 
             1813 : FF FF FF FF FF FF 
             1819 : FF FF FF FF FF FF 
             181F : FF FF FF FF FF FF 
             1825 : FF FF FF FF FF FF 
             182B : FF FF FF FF FF FF 
             1831 : FF FF FF FF FF FF 
             1837 : FF FF FF FF FF FF 
             183D : FF FF FF FF FF FF 
             1843 : FF FF FF FF FF FF 
             1849 : FF FF FF FF FF FF 
             184F : FF FF FF FF FF FF 
             1855 : FF FF FF FF FF FF 
             185B : FF FF FF FF FF FF 
             1861 : FF FF FF FF FF FF 
             1867 : FF FF FF FF FF FF 
             186D : FF FF FF FF FF FF 
             1873 : FF FF FF FF FF FF 
             1879 : FF FF FF FF FF FF 
             187F : FF FF FF FF FF FF 
             1885 : FF FF FF FF FF FF 
             188B : FF FF FF FF FF FF 
             1891 : FF FF FF FF FF FF 
             1897 : FF FF FF FF FF FF 
             189D : FF FF FF FF FF FF 
             18A3 : FF FF FF FF FF FF 
             18A9 : FF FF FF FF FF FF 
             18AF : FF FF FF FF FF FF 
             18B5 : FF FF FF FF FF FF 
             18BB : FF FF FF FF FF FF 
             18C1 : FF FF FF FF FF FF 
             18C7 : FF FF FF FF FF FF 
             18CD : FF FF FF FF FF FF 
             18D3 : FF FF FF FF FF FF 
             18D9 : FF FF FF FF FF FF 
             18DF : FF FF FF FF FF FF 
             18E5 : FF FF FF FF FF FF 
             18EB : FF FF FF FF FF FF 
             18F1 : FF FF FF FF FF FF 
             18F7 : FF FF FF FF FF FF 
             18FD : FF FF FF FF FF FF 
             1903 : FF FF FF FF FF FF 
             1909 : FF FF FF FF FF FF 
             190F : FF FF FF FF FF FF 
             1915 : FF FF FF FF FF FF 
             191B : FF FF FF FF FF FF 
             1921 : FF FF FF FF FF FF 
             1927 : FF FF FF FF FF FF 
             192D : FF FF FF FF FF FF 
             1933 : FF FF FF FF FF FF 
             1939 : FF FF FF FF FF FF 
             193F : FF FF FF FF FF FF 
             1945 : FF FF FF FF FF FF 
             194B : FF FF FF FF FF FF 
             1951 : FF FF FF FF FF FF 
             1957 : FF FF FF FF FF FF 
             195D : FF FF FF FF FF FF 
             1963 : FF FF FF FF FF FF 
             1969 : FF FF FF FF FF FF 
             196F : FF FF FF FF FF FF 
             1975 : FF FF FF FF FF FF 
             197B : FF FF FF FF FF FF 
             1981 : FF FF FF FF FF FF 
             1987 : FF FF FF FF FF FF 
             198D : FF FF FF FF FF FF 
             1993 : FF FF FF FF FF FF 
             1999 : FF FF FF FF FF FF 
             199F : FF FF FF FF FF FF 
             19A5 : FF FF FF FF FF FF 
             19AB : FF FF FF FF FF FF 
             19B1 : FF FF FF FF FF FF 
             19B7 : FF FF FF FF FF FF 
             19BD : FF FF FF FF FF FF 
             19C3 : FF FF FF FF FF FF 
             19C9 : FF FF FF FF FF FF 
             19CF : FF FF FF FF FF FF 
             19D5 : FF FF FF FF FF FF 
             19DB : FF FF FF FF FF FF 
             19E1 : FF FF FF FF FF FF 
             19E7 : FF FF FF FF FF FF 
             19ED : FF FF FF FF FF FF 
             19F3 : FF FF FF FF FF FF 
             19F9 : FF FF FF FF FF FF 
             19FF : FF FF FF FF FF FF 
             1A05 : FF FF FF FF FF FF 
             1A0B : FF FF FF FF FF FF 
             1A11 : FF FF FF FF FF FF 
             1A17 : FF FF FF FF FF FF 
             1A1D : FF FF FF FF FF FF 
             1A23 : FF FF FF FF FF FF 
             1A29 : FF FF FF FF FF FF 
             1A2F : FF FF FF FF FF FF 
             1A35 : FF FF FF FF FF FF 
             1A3B : FF FF FF FF FF FF 
             1A41 : FF FF FF FF FF FF 
             1A47 : FF FF FF FF FF FF 
             1A4D : FF FF FF FF FF FF 
             1A53 : FF FF FF FF FF FF 
             1A59 : FF FF FF FF FF FF 
             1A5F : FF FF FF FF FF FF 
             1A65 : FF FF FF FF FF FF 
             1A6B : FF FF FF FF FF FF 
             1A71 : FF FF FF FF FF FF 
             1A77 : FF FF FF FF FF FF 
             1A7D : FF FF FF FF FF FF 
             1A83 : FF FF FF FF FF FF 
             1A89 : FF FF FF FF FF FF 
             1A8F : FF FF FF FF FF FF 
             1A95 : FF FF FF FF FF FF 
             1A9B : FF FF FF FF FF FF 
             1AA1 : FF FF FF FF FF FF 
             1AA7 : FF FF FF FF FF FF 
             1AAD : FF FF FF FF FF FF 
             1AB3 : FF FF FF FF FF FF 
             1AB9 : FF FF FF FF FF FF 
             1ABF : FF FF FF FF FF FF 
             1AC5 : FF FF FF FF FF FF 
             1ACB : FF FF FF FF FF FF 
             1AD1 : FF FF FF FF FF FF 
             1AD7 : FF FF FF FF FF FF 
             1ADD : FF FF FF FF FF FF 
             1AE3 : FF FF FF FF FF FF 
             1AE9 : FF FF FF FF FF FF 
             1AEF : FF FF FF FF FF FF 
             1AF5 : FF FF FF FF FF FF 
             1AFB : FF FF FF FF FF FF 
             1B01 : FF FF FF FF FF FF 
             1B07 : FF FF FF FF FF FF 
             1B0D : FF FF FF FF FF FF 
             1B13 : FF FF FF FF FF FF 
             1B19 : FF FF FF FF FF FF 
             1B1F : FF FF FF FF FF FF 
             1B25 : FF FF FF FF FF FF 
             1B2B : FF FF FF FF FF FF 
             1B31 : FF FF FF FF FF FF 
             1B37 : FF FF FF FF FF FF 
             1B3D : FF FF FF FF FF FF 
             1B43 : FF FF FF FF FF FF 
             1B49 : FF FF FF FF FF FF 
             1B4F : FF FF FF FF FF FF 
             1B55 : FF FF FF FF FF FF 
             1B5B : FF FF FF FF FF FF 
             1B61 : FF FF FF FF FF FF 
             1B67 : FF FF FF FF FF FF 
             1B6D : FF FF FF FF FF FF 
             1B73 : FF FF FF FF FF FF 
             1B79 : FF FF FF FF FF FF 
             1B7F : FF FF FF FF FF FF 
             1B85 : FF FF FF FF FF FF 
             1B8B : FF FF FF FF FF FF 
             1B91 : FF FF FF FF FF FF 
             1B97 : FF FF FF FF FF FF 
             1B9D : FF FF FF FF FF FF 
             1BA3 : FF FF FF FF FF FF 
             1BA9 : FF FF FF FF FF FF 
             1BAF : FF FF FF FF FF FF 
             1BB5 : FF FF FF FF FF FF 
             1BBB : FF FF FF FF FF FF 
             1BC1 : FF FF FF FF FF FF 
             1BC7 : FF FF FF FF FF FF 
             1BCD : FF FF FF FF FF FF 
             1BD3 : FF FF FF FF FF FF 
             1BD9 : FF FF FF FF FF FF 
             1BDF : FF FF FF FF FF FF 
             1BE5 : FF FF FF FF FF FF 
             1BEB : FF FF FF FF FF FF 
             1BF1 : FF FF FF FF FF FF 
             1BF7 : FF FF FF FF FF FF 
             1BFD : FF FF FF FF FF FF 
             1C03 : FF FF FF FF FF FF 
             1C09 : FF FF FF FF FF FF 
             1C0F : FF FF FF FF FF FF 
             1C15 : FF FF FF FF FF FF 
             1C1B : FF FF FF FF FF FF 
             1C21 : FF FF FF FF FF FF 
             1C27 : FF FF FF FF FF FF 
             1C2D : FF FF FF FF FF FF 
             1C33 : FF FF FF FF FF FF 
             1C39 : FF FF FF FF FF FF 
             1C3F : FF FF FF FF FF FF 
             1C45 : FF FF FF FF FF FF 
             1C4B : FF FF FF FF FF FF 
             1C51 : FF FF FF FF FF FF 
             1C57 : FF FF FF FF FF FF 
             1C5D : FF FF FF FF FF FF 
             1C63 : FF FF FF FF FF FF 
             1C69 : FF FF FF FF FF FF 
             1C6F : FF FF FF FF FF FF 
             1C75 : FF FF FF FF FF FF 
             1C7B : FF FF FF FF FF FF 
             1C81 : FF FF FF FF FF FF 
             1C87 : FF FF FF FF FF FF 
             1C8D : FF FF FF FF FF FF 
             1C93 : FF FF FF FF FF FF 
             1C99 : FF FF FF FF FF FF 
             1C9F : FF FF FF FF FF FF 
             1CA5 : FF FF FF FF FF FF 
             1CAB : FF FF FF FF FF FF 
             1CB1 : FF FF FF FF FF FF 
             1CB7 : FF FF FF FF FF FF 
             1CBD : FF FF FF FF FF FF 
             1CC3 : FF FF FF FF FF FF 
             1CC9 : FF FF FF FF FF FF 
             1CCF : FF FF FF FF FF FF 
             1CD5 : FF FF FF FF FF FF 
             1CDB : FF FF FF FF FF FF 
             1CE1 : FF FF FF FF FF FF 
             1CE7 : FF FF FF FF FF FF 
             1CED : FF FF FF FF FF FF 
             1CF3 : FF FF FF FF FF FF 
             1CF9 : FF FF FF FF FF FF 
             1CFF : FF FF FF FF FF FF 
             1D05 : FF FF FF FF FF FF 
             1D0B : FF FF FF FF FF FF 
             1D11 : FF FF FF FF FF FF 
             1D17 : FF FF FF FF FF FF 
             1D1D : FF FF FF FF FF FF 
             1D23 : FF FF FF FF FF FF 
             1D29 : FF FF FF FF FF FF 
             1D2F : FF FF FF FF FF FF 
             1D35 : FF FF FF FF FF FF 
             1D3B : FF FF FF FF FF FF 
             1D41 : FF FF FF FF FF FF 
             1D47 : FF FF FF FF FF FF 
             1D4D : FF FF FF FF FF FF 
             1D53 : FF FF FF FF FF FF 
             1D59 : FF FF FF FF FF FF 
             1D5F : FF FF FF FF FF FF 
             1D65 : FF FF FF FF FF FF 
             1D6B : FF FF FF FF FF FF 
             1D71 : FF FF FF FF FF FF 
             1D77 : FF FF FF FF FF FF 
             1D7D : FF FF FF FF FF FF 
             1D83 : FF FF FF FF FF FF 
             1D89 : FF FF FF FF FF FF 
             1D8F : FF FF FF FF FF FF 
             1D95 : FF FF FF FF FF FF 
             1D9B : FF FF FF FF FF FF 
             1DA1 : FF FF FF FF FF FF 
             1DA7 : FF FF FF FF FF FF 
             1DAD : FF FF FF FF FF FF 
             1DB3 : FF FF FF FF FF FF 
             1DB9 : FF FF FF FF FF FF 
             1DBF : FF FF FF FF FF FF 
             1DC5 : FF FF FF FF FF FF 
             1DCB : FF FF FF FF FF FF 
             1DD1 : FF FF FF FF FF FF 
             1DD7 : FF FF FF FF FF FF 
             1DDD : FF FF FF FF FF FF 
             1DE3 : FF FF FF FF FF FF 
             1DE9 : FF FF FF FF FF FF 
             1DEF : FF FF FF FF FF FF 
             1DF5 : FF FF FF FF FF FF 
             1DFB : FF FF FF FF FF FF 
             1E01 : FF FF FF FF FF FF 
             1E07 : FF FF FF FF FF FF 
             1E0D : FF FF FF FF FF FF 
             1E13 : FF FF FF FF FF FF 
             1E19 : FF FF FF FF FF FF 
             1E1F : FF FF FF FF FF FF 
             1E25 : FF FF FF FF FF FF 
             1E2B : FF FF FF FF FF FF 
             1E31 : FF FF FF FF FF FF 
             1E37 : FF FF FF FF FF FF 
             1E3D : FF FF FF FF FF FF 
             1E43 : FF FF FF FF FF FF 
             1E49 : FF FF FF FF FF FF 
             1E4F : FF FF FF FF FF FF 
             1E55 : FF FF FF FF FF FF 
             1E5B : FF FF FF FF FF FF 
             1E61 : FF FF FF FF FF FF 
             1E67 : FF FF FF FF FF FF 
             1E6D : FF FF FF FF FF FF 
             1E73 : FF FF FF FF FF FF 
             1E79 : FF FF FF FF FF FF 
             1E7F : FF FF FF FF FF FF 
             1E85 : FF FF FF FF FF FF 
             1E8B : FF FF FF FF FF FF 
             1E91 : FF FF FF FF FF FF 
             1E97 : FF FF FF FF FF FF 
             1E9D : FF FF FF FF FF FF 
             1EA3 : FF FF FF FF FF FF 
             1EA9 : FF FF FF FF FF FF 
             1EAF : FF FF FF FF FF FF 
             1EB5 : FF FF FF FF FF FF 
             1EBB : FF FF FF FF FF FF 
             1EC1 : FF FF FF FF FF FF 
             1EC7 : FF FF FF FF FF FF 
             1ECD : FF FF FF FF FF FF 
             1ED3 : FF FF FF FF FF FF 
             1ED9 : FF FF FF FF FF FF 
             1EDF : FF FF FF FF FF FF 
             1EE5 : FF FF FF FF FF FF 
             1EEB : FF FF FF FF FF FF 
             1EF1 : FF FF FF FF FF FF 
             1EF7 : FF FF FF FF FF FF 
             1EFD : FF FF FF FF FF FF 
             1F03 : FF FF FF FF FF FF 
             1F09 : FF FF FF FF FF FF 
             1F0F : FF FF FF FF FF FF 
             1F15 : FF FF FF FF FF FF 
             1F1B : FF FF FF FF FF FF 
             1F21 : FF FF FF FF FF FF 
             1F27 : FF FF FF FF FF FF 
             1F2D : FF FF FF FF FF FF 
             1F33 : FF FF FF FF FF FF 
             1F39 : FF FF FF FF FF FF 
             1F3F : FF FF FF FF FF FF 
             1F45 : FF FF FF FF FF FF 
             1F4B : FF FF FF FF FF FF 
             1F51 : FF FF FF FF FF FF 
             1F57 : FF FF FF FF FF FF 
             1F5D : FF FF FF FF FF FF 
             1F63 : FF FF FF FF FF FF 
             1F69 : FF FF FF FF FF FF 
             1F6F : FF FF FF FF FF FF 
             1F75 : FF FF FF FF FF FF 
             1F7B : FF FF FF FF FF FF 
             1F81 : FF FF FF FF FF FF 
             1F87 : FF FF FF FF FF FF 
             1F8D : FF FF FF FF FF FF 
             1F93 : FF FF FF FF FF FF 
             1F99 : FF FF FF FF FF FF 
             1F9F : FF FF FF FF FF FF 
             1FA5 : FF FF FF FF FF FF 
             1FAB : FF FF FF FF FF FF 
             1FB1 : FF FF FF FF FF FF 
             1FB7 : FF FF FF FF FF FF 
             1FBD : FF FF FF FF FF FF 
             1FC3 : FF FF FF FF FF FF 
             1FC9 : FF FF FF FF FF FF 
             1FCF : FF FF FF FF FF FF 
             1FD5 : FF FF FF FF FF FF 
             1FDB : FF FF FF FF FF FF 
             1FE1 : FF FF FF FF FF FF 
             1FE7 : FF FF FF FF FF FF 
             1FED : FF FF FF FF FF FF 
             1FF3 : FF FF FF FF FF FF 
             1FF9 : FF FF FF FF FF FF 
             1FFF : FF                
    3564/    2000 :                     ;	ORG	BASIC_TOP
    3565/    2000 :                     
    3566/    2000 :                     ;;;
    3567/    2000 :                     ;;; RAM area
    3568/    2000 :                     ;;;
    3569/    2000 :                     
    3570/    2000 :                     	;;
    3571/    2000 :                     	;; Work Area
    3572/    2000 :                     	;;
    3573/    2000 :                     	
    3574/    EF00 :                     	ORG	WORK_B
    3575/    EF00 :                     
    3576/    EF00 :                     stealRST08:	ds	2	; hacking RST 08H, set jump address
    3577/    EF02 :                     stealRST10:	ds	2	; hacking RST 10H, set jump address
    3578/    EF04 :                     stealRST18:	ds	2	; hacking RST 18H, set jump address
    3579/    EF06 :                     stealRST20:	ds	2	; hacking RST 20H, set jump address
    3580/    EF08 :                     stealRST28:	ds	2	; hacking RST 28H, set jump address
    3581/    EF0A :                     stealRST30:	ds	2	; hacking RST 30H, set jump address
    3582/    EF0C :                     stealRST38:	ds	2	; hacking RST 38H, set jump address
    3583/    EF0E :                     save_hl:	ds	2
    3584/    EF10 :                     
    3585/    EF10 :                     INBUF:	DS	BUFLEN	; Line input buffer
    3586/    EF30 :                     DSADDR:	DS	2	; Dump start address
    3587/    EF32 :                     DEADDR:	DS	2	; Dump end address
    3588/    EF34 :                     DSTATE:	DS	1	; Dump state
    3589/    EF35 :                     GADDR:	DS	2	; Go address
    3590/    EF37 :                     SADDR:	DS	2	; Set address
    3591/    EF39 :                     HEXMOD:	DS	1	; HEX file mode
    3592/    EF3A :                     RECTYP:	DS	1	; Record type
    3593/    EF3B :                     SIZE:	DS	1	; I/O Size 00H,'W','S'
    3594/    EF3C :                     
    3595/    EF3C :                     REG_B:	
    3596/    EF3C :                     REGAF:	DS	2
    3597/    EF3E :                     REGBC:	DS	2
    3598/    EF40 :                     REGDE:	DS	2
    3599/    EF42 :                     REGHL:	DS	2
    3600/    EF44 :                     REGAFX:	DS	2		; Register AF'
    3601/    EF46 :                     REGBCX:	DS	2
    3602/    EF48 :                     REGDEX:	DS	2
    3603/    EF4A :                     REGHLX:	DS	2		; Register HL'
    3604/    EF4C :                     REGIX:	DS	2
    3605/    EF4E :                     REGIY:	DS	2
    3606/    EF50 :                     REGSP:	DS	2
    3607/    EF52 :                     REGPC:	DS	2
    3608/    EF54 :                     REGI:	DS	1
    3609/    EF55 :                     REGR:	DS	1
    3610/    EF56 :                     REG_E:
    3611/    EF56 :                     
    3612/    EF56 : =>TRUE               	IF RAM12K
    3613/    EF56 :                     ; stop watch timer
    3614/    EF56 :                     
    3615/    EF56 :                     c16b:	ds	2	; copy of TIMER0_CNT
    3616/    EF58 :                     secb:	ds	2	; copy of TIMER0_SCTT
    3617/    EF5A :                     msecb:	ds	2
    3618/    EF5C : [3612]               	ENDIF
    3619/    EF5C :                     
    3620/    EF5C :                     ; DIV 16 /16 buffer
    3621/    EF5C :                     DIV16_NA:	ds	2
    3622/    EF5E :                     DIV16_NB:	ds	2
    3623/    EF60 :                     DIV16_NC:	DS	2
    3624/    EF62 :                     DIV16_ND:	DS	2
    3625/    EF64 :                     
    3626/    EF64 :                     ; go command temp start address
    3627/    EF64 :                     goTmp:		ds	2
    3628/    EF66 :                     
    3629/    EF66 :                     ; trace mode switch
    3630/    EF66 :                     TP_mode:	ds	1	; N: display on, F: display off
    3631/    EF67 :                     TM_mode:	ds	1	; 'S':skip call, 'I':trace CALL IN
    3632/    EF68 :                     TC_cnt:		ds	2	; numbers of step
    3633/    EF6A :                     tmpT:		ds	2	; save temp buffer
    3634/    EF6C :                     fever_t:	ds	1	; flag trace forever
    3635/    EF6D :                     
    3636/    EF6D :                     ; break, trace point work area
    3637/    EF6D : =0EF6DH              dbg_wtop	equ	$
    3638/    EF6D :                     tpt1_f:		ds	1
    3639/    EF6E :                     tpt1_op:	ds	1	; save trace point1 opcode
    3640/    EF6F :                     tpt1_adr:	ds	2
    3641/    EF71 :                     tpt2_f:		ds	1
    3642/    EF72 :                     tpt2_op:	ds	1	; save trace point2 opcode (for branch)
    3643/    EF73 :                     tpt2_adr:	ds	2
    3644/    EF75 :                     
    3645/    EF75 :                     ; break point work area
    3646/    EF75 :                     bpt1_f:		ds	1
    3647/    EF76 :                     bpt1_op:	ds	1
    3648/    EF77 :                     bpt1_adr:	ds	2
    3649/    EF79 :                     bpt2_f:		ds	1
    3650/    EF7A :                     bpt2_op:	ds	1
    3651/    EF7B :                     bpt2_adr:	ds	2
    3652/    EF7D :                     
    3653/    EF7D :                     tmpb_f:		ds	1
    3654/    EF7E :                     tmpb_op:	ds	1
    3655/    EF7F :                     tmpb_adr:	ds	2
    3656/    EF81 : =0EF81H              dbg_wend	equ	$
    3657/    EF81 :                     
    3658/    EF81 :                     F_bit:		ds	F_bitSize+1
    3659/    EF8A :                     	END
 AS V1.42 Beta [Bld 227] - Source File emuz80mon_RevB01.asm - Page 2 - 10/4/2022 8:52:20


  Symbol Table (* = unused):
  --------------------------

 ADJ_TIM1 :                    0ED3 C |  APENDTBL :                     1C8 C |
 API00 :                       0D36 C |  API01 :                       0D39 C |
 API06 :                       0D7B C |  APITBL :                      0D0E C |
*ARCHITECTURE :                                        "i386-unknown-win32" - |
 BACKTOMON :                   0E3A C |  BASIC_CST :                   2000 - |
 BASIC_TOP :                   2000 - |  BASIC_WST :                   2003 - |
 BC_PLUS_DE :                   269 C |  BPT1_ADR :                   0EF77 C |
 BPT1_F :                     0EF75 C |  BPT1_OP :                    0EF76 C |
 BPT2_ADR :                   0EF7B C |  BPT2_F :                     0EF79 C |
 BPT2_OP :                    0EF7A C |  BP_CHK1 :                     0DFC C |
 BP_CHK_END :                  0E0B C |  BP_CLR :                       2EE C |
 BP_CLR1 :                      307 C |  BP_LOT :                       318 C |
 BP_MSG1 :                      32E C |  BP_MSG2 :                      332 C |
 BRK_CMD :                      291 C |  BS :                             8 - |
 BUFLEN :                        20 - |  B_ACLR :                       30C C |
 B_LIST :                       271 C |  B_LIST1 :                      27F C |
 B_MSG_OUT :                    335 C |  C16B :                       0EF56 C |
*CASESENSITIVE :                  0 - |  CHG_MSEC :                    0F14 C |
 CHKERR :                       2EC C |  CHK_BP :                      0DED C |
 CHK_FEVRE :                    44F C |  CHK_NTRACE :                  0E20 C |
 CLCC_TBLE :                    617 C |  CLCC_TBLS :                    60F C |
 CLR_CRT :                     0C46 C |  CLR_TIM :                     0EF5 C |
 CMD_HLP :                     0FEE C |  COMMAND_HLP :                  16F C |
*COMPMODE :                       0 - |  CONIN :                       1423 C |
 CONOUT :                      1434 C |  CONST :                       142E C |
*CONSTPI :        3.141592653589793 - |  CR :                            0D - |
 CRLF :                        0C3C C |  CSTART :                        7B C |
 D16_END :                     0F87 C |  D16_MINUS :                   0F7F C |
 D16_MINUS_AFTER :             0F83 C |  D16_MINUS_BEFORE :            0F7E C |
 D16_PLUS :                    0F73 C |  D16_PLUS_AFTER :              0F77 C |
*DATE :                 "10/4/2022" - |  DBG_WEND :                   0EF81 - |
 DBG_WINI :                     0E3 C |  DBG_WTOP :                   0EF6D - |
 DD_2NDTBL :                    6D2 C |  DD_2NDTBL_E :                  6DC C |
 DEADDR :                     0EF32 C |  DEC_STR :                     0F30 C |
 DEL :                           7F - |  DIP_TM :                       38C C |
*DIV16 :                       0F8A C |  DIV16_8 :                     0F66 C |
 DIV16_NA :                   0EF5C C |  DIV16_NB :                   0EF5E C |
 DIV16_NC :                   0EF60 C |  DIV16_ND :                   0EF62 C |
 DIV16_X0 :                    0FC7 C |  DIV16_X1 :                    0FD2 C |
 DIV16_X2 :                    0FA0 C |  DONOT_TRACE :                  855 C |
 DP0 :                          6F9 C |  DP1 :                          712 C |
 DPB :                          794 C |  DPB0 :                         7AB C |
 DPB1 :                         7BA C |  DPB2 :                         7BF C |
 DPL :                          75A C |  DPL0 :                         76B C |
 DPL1 :                         77B C |  DPL2 :                         78A C |
 DPL3 :                         78F C |  DPM :                          728 C |
 DPM0 :                         733 C |  DPM1 :                         751 C |
 DSADDR :                     0EF30 C |  DSEP0 :                       11F0 C |
 DSEP1 :                       11F3 C |  DSTATE :                     0EF34 C |
 DUMP :                         6DC C |  END_DEC :                     0F5F C |
 END_INS_TC :                   587 C |  ENTRY :                         40 - |
 ERR :                          167 C |  ERRMSG :                      11E8 C |
 ERR_TRACE_SEQ :                58A C |  ESC_CRT_CLR :                 0C4F C |
 EXP_MSB :                      5A9 C | *E_CSTART :                       0 C |
*E_WSTART :                       3 C | *FALSE :                          0 - |
 FEVER_T :                    0EF6C C |  FLG_LOOP :                    0BBD C |
 FLG_NXT :                     0BCC C |  FLG_OFF :                     0BC8 C |
*FULLPMMU :                       1 - |  F_BIT :                      0EF81 C |
 F_BITSIZE :                      8 - |  F_BIT_OFF :                   0BE8 C |
 F_BIT_ON :                    0BE0 C |  G0 :                           823 C |
 GADDR :                      0EF35 C |  GETLIN :                      0C58 C |
 GETLIN0 :                     0C53 C |  GET_BI :                       243 C |
 GET_NUM :                      222 C |  GET_NUM0 :                     225 C |
 GL0 :                         0C5E C |  GLB :                         0C88 C |
 GLE :                         0C9F C |  GO :                           7E0 C |
 GO1 :                          81D C |  GOSTMP :                       7F4 C |
 GOTMP :                      0EF64 C |  G_STPADR :                     7FE C |
*HAS64 :                          0 - | *HASFPU :                         0 - |
*HASPMMU :                        0 - |  HEXIN :                       0C15 C |
 HEXMOD :                     0EF39 C |  HEXOUT1 :                     0C07 C |
 HEXOUT2 :                     0BFE C |  HEXOUT4 :                     0BF9 C |
 HI0 :                         0C1D C |  HI1 :                         0C37 C |
 HIR :                         0C3A C |  IB1 :                          5BA C |
 IB2 :                          5B9 C |  IB3 :                          5B8 C |
 ICKA1 :                        5EF C |  ICKA_END :                     5F6 C |
 IHEMSG :                      11CE C |  IHEXER :                      11F7 C |
 INADR_CHK_AND_WRT :            5D8 C |  INBUF :                      0EF10 C |
*INIT :                        1422 C |  INS2 :                         61F C |
 INSBRK_1OP :                   5AB C |  INSBRK_2OP :                   5B0 C |
 INSBRK_3OP :                   5B5 C |  INSBRK_BRP :                   5BF C |
 INSBRK_SP :                    5CB C |  INSTC1 :                       4DB C |
*INSTC2 :                       469 C | *INSUPMODE :                      0 - |
 IO_B :                       0F000 - |  IR0 :                          0C0 C |
 IR00 :                         0D7 C |  JMP_RST :                       76 C |
 JPCC_TBLE :                    60F C |  JPCC_TBLS :                    607 C |
 JPHL :                         521 C |  JRCC_TBLE :                    607 C |
 JRCC_TBLS :                    602 C |  LANCH1 :                       1E8 C |
 LANCH10 :                      220 C |  LANCH11 :                      220 C |
 LANCH12 :                      220 C |  LANCH13 :                      220 C |
 LANCH14 :                      220 C |  LANCH15 :                      220 C |
 LANCH16 :                      220 C |  LANCH2 :                       204 C |
 LANCH3 :                       220 C |  LANCH4 :                       220 C |
 LANCH5 :                       220 C |  LANCH6 :                       220 C |
 LANCH7 :                       220 C |  LANCH8 :                       220 C |
 LANCH9 :                       220 C |  LAP_TIM :                     0EB7 C |
 LAUNCHER :                     177 C |  LF :                            0A - |
 LH0 :                          93D C | *LH1 :                          947 C |
 LH2 :                          94B C |  LH3 :                          953 C |
 LHI0 :                         958 C |  LHI1 :                         97B C |
 LHI2 :                         98D C |  LHI20 :                        98C C |
 LHI3 :                         98F C |  LHIE :                         99F C |
 LHS0 :                         9A8 C |  LHS1 :                         9C5 C |
 LHS2 :                         9D7 C |  LHS20 :                        9D8 C |
 LHS3 :                         9DA C |  LHSE :                         9F4 C |
 LHSR :                         9FA C | *LISTON :                         1 - |
 LOADH :                        920 C |  LOOP_DEC :                    0F46 C |
 LOOP_M8 :                     0FE1 C |  LST_END :                      1C5 C |
 LST_PRG :                      1AA C |  LST_PRG1 :                     1AD C |
 L_B2 :                         328 C | *MACEXP :                         7 - |
 MEET_DD :                      64A C |  MEET_ED :                      66C C |
 MEET_OP1 :                     688 C |  MEET_OP2 :                     693 C |
 MEET_OP3 :                     69E C |  MEET_OP4 :                     6A9 C |
*MOMCPU :                        80 - | *MOMCPUNAME :                 "Z80" - |
 MSECB :                      0EF5A C |  MUL_10 :                       252 C |
 MUL_8 :                       0FDC C | *NESTMAX :                      100 - |
 NEXT_BC1 :                     486 C |  NEXT_BC10 :                    560 C |
 NEXT_BC11 :                    56D C |  NEXT_BC111 :                   582 C |
 NEXT_BC2 :                     4A9 C |  NEXT_BC21 :                    4B7 C |
 NEXT_BC22 :                    4D2 C | *NEXT_BC221 :                   4D0 C |
 NEXT_BC222 :                   4CA C |  NEXT_BC3 :                     4EA C |
 NEXT_BC4 :                     4FF C |  NEXT_BC5 :                     516 C |
 NEXT_BC6 :                     50D C |  NEXT_BC7 :                     52A C |
 NEXT_BC8 :                     539 C |  NEXT_BC9 :                     54C C |
 NO_RAM_AREA :                  5F8 C |  NO_RST38_MSG :                0E12 C |
 OPNMSG :                      118E C | *PADDING :                        1 - |
 PCST1 :                       1435 C |  PROMPT :                      11CB C |
 RAM12K :                         1 - |  RAM4K :                          0 - |
 RAM8K :                          0 - |  RAM_B :                      0C000 - |
*RAM_E :                      0EFFF - |  RD0 :                         0B67 C |
 RD1 :                         0B9F C |  RD10 :                        0B8D C |
 RD101 :                       0B83 C |  RD20 :                        0BAC C |
 RDHEX :                       0CB9 C |  RDSA :                        1267 C |
 RDSAX :                       128C C |  RDSBC :                       126B C |
 RDSBCX :                      1292 C |  RDSDE :                       1271 C |
 RDSDEX :                      1298 C |  RDSF :                        127D C |
 RDSFX :                       12A4 C |  RDSFX_H :                       12 - |
 RDSFX_L :                      0A4 - |  RDSF_H :                        12 - |
 RDSF_L :                        7D - |  RDSHL :                       1277 C |
 RDSHLX :                      129E C |  RDSI :                        12B3 C |
 RDSIX :                       1282 C |  RDSIY :                       1287 C |
 RDSPC :                       12AE C |  RDSR :                        12B7 C |
 RDSSP :                       12A9 C |  RDTAB :                       1212 C |
 RDUMP :                       0B64 C |  RD_SEC :                      0ED8 C |
 RECTYP :                     0EF3A C |  REG :                         0AD8 C |
 REGAF :                      0EF3C C |  REGAFX :                     0EF44 C |
 REGBC :                      0EF3E C |  REGBCX :                     0EF46 C |
 REGDE :                      0EF40 C |  REGDEX :                     0EF48 C |
 REGHL :                      0EF42 C |  REGHLX :                     0EF4A C |
 REGI :                       0EF54 C |  REGIX :                      0EF4C C |
 REGIY :                      0EF4E C |  REGPC :                      0EF52 C |
 REGR :                       0EF55 C |  REGSP :                      0EF50 C |
 REG_B :                      0EF3C C |  REG_E :                      0EF56 C |
*RELAXED :                        0 - |  REL_ADR_C :                    59E C |
 REPEAT_TRACE :                0E5B C |  RETCC_TBLE :                   602 C |
 RETCC_TBLS :                   5FA C |  RG0 :                         0AE8 C |
 RG1 :                         0AEC C |  RG2 :                         0AFC C |
 RG3 :                         0B0E C |  RG4 :                         0B33 C |
 RG5 :                         0B3F C |  RG6 :                         0B5B C |
 RG7 :                         0B5E C |  RGE :                         0B61 C |
 RGR :                         0B5E C |  RH0 :                         0CBE C |
 RH1 :                         0CD4 C |  RHE :                         0CF2 C |
 RHE1 :                        0CFC C |  RNA :                         13D5 C |
 RNAX :                        13EE C |  RNB :                         13DA C |
 RNBC :                        13D7 C |  RNBCX :                       13F1 C |
 RNBX :                        13F5 C |  RNC :                         13DC C |
 RNCX :                        13F8 C |  RND :                         13E1 C |
 RNDE :                        13DE C |  RNDEX :                       13FB C |
 RNDX :                        13FF C |  RNE :                         13E3 C |
 RNEX :                        1402 C |  RNF :                         13EC C |
 RNFX :                        140F C |  RNH :                         13E8 C |
 RNHL :                        13E5 C |  RNHLX :                       1405 C |
 RNHX :                        1409 C |  RNI :                         141E C |
 RNIX :                        1412 C |  RNIY :                        1415 C |
 RNL :                         13EA C |  RNLX :                        140C C |
 RNPC :                        141B C |  RNR :                         1420 C |
 RNSP :                        1418 C |  RNTAB :                       12BB C |
 RNTABA :                      1305 C |  RNTABB :                      1313 C |
 RNTABBC :                     1327 C |  RNTABC :                      1335 C |
 RNTABD :                      1343 C |  RNTABDE :                     1357 C |
 RNTABE :                      1365 C |  RNTABF :                      1373 C |
 RNTABH :                      1381 C |  RNTABHL :                     1395 C |
 RNTABI :                      13B1 C |  RNTABL :                      13A3 C |
 RNTABP :                      13C5 C |  RNTABS :                      13CD C |
 ROM_B :                          0 - |  RST08H :                        40 C |
 RST10H :                        48 C |  RST18H :                        50 C |
 RST20H :                        58 C |  RST20H_IN :                     7A C |
 RST28H :                        60 C |  RST28H_IN :                     7A C |
 RST30H :                        68 C |  RST30H_IN :                   0CFE C |
 RST38H :                        70 C |  RST38H_IN :                   0D7D C |
 RST38MSG :                    0E77 C |  RSTR_BPT :                    0E70 C |
 RSTR_TPT :                    0E64 C |  RST_TBLE :                     61F C |
 RST_TBLS :                     617 C |  SADDR :                      0EF37 C |
 SAVEH :                        9FD C |  SAVE_HL :                    0EF0E C |
 SECB :                       0EF58 C |  SETBPADR :                     2D5 C |
 SETM :                         8AA C |  SET_BP :                       89B C |
 SET_BP1 :                      2B0 C |  SET_TM :                       3A3 C |
 SH0 :                         0A0A C |  SH1 :                         0A0E C |
 SH2 :                         0A36 C |  SH3 :                         0A3E C |
 SH4 :                         0A55 C |  SHE :                         0A33 C |
 SHEMSG :                      11DB C |  SHL0 :                        0A69 C |
 SHL00 :                       0A5E C |  SHLI0 :                       0A92 C |
 SHLS :                        0AA6 C |  SHLS0 :                       0AC5 C |
*SIZE :                       0EF3B C |  SKIPSP :                      0CA9 C |
 SKP_RMSG :                    0E2E C |  SKP_TBP :                      85E C |
 SM0 :                          8C4 C |  SM1 :                          8C5 C |
 SM2 :                          8EB C |  SM3 :                          8F6 C |
 SM4 :                          901 C |  SRECER :                      1205 C |
 STACK :                      0EEC0 - |  STACKM :                     0EF00 - |
*START :                          0 C |  START_TIM :                   0EA8 C |
 STEALRST08 :                 0EF00 C |  STEALRST10 :                 0EF02 C |
 STEALRST18 :                 0EF04 C |  STEALRST20 :                 0EF06 C |
 STEALRST28 :                 0EF08 C |  STEALRST30 :                 0EF0A C |
 STEALRST38 :                 0EF0C C |  STOPW :                       0E93 C |
 STOP_TIM :                    0EB1 C |  STPBRK_MSG :                  0E81 C |
 STP_CHK :                      432 C |  STROUT :                      0BF0 C |
 ST_MUL8 :                     0FE5 C |  TADR_CHK :                     421 C |
 TC_CNT :                     0EF68 C |  TERR_MSG :                     594 C |
 THREE_OPTBL :                  6CA C |  THREE_OPTBL_E :                6D2 C |
 TIM0_CTL0 :                  0F800 - | *TIM0_CTL1 :                  0F801 - |
*TIME :                   "8:52:20" - |  TIMER0_CNTH :                0F811 - |
 TIMER0_CNTL :                0F810 - |  TIMER0_INITC :                87E1 - |
 TIMER0_SCTH :                0F821 - |  TIMER0_SCTL :                0F820 - |
 TMPB_ADR :                   0EF7F C |  TMPB_F :                     0EF7D C |
 TMPB_OP :                    0EF7E C |  TMPT :                       0EF6A C |
 TM_MODE :                    0EF67 C |  TM_MSG_0 :                     3B4 C |
 TM_MSG_I :                     3C3 C |  TM_MSG_S :                     3C9 C |
 TPT1_ADR :                   0EF6F C |  TPT1_F :                     0EF6D C |
 TPT1_OP :                    0EF6E C |  TPT2_ADR :                   0EF73 C |
 TPT2_F :                     0EF71 C |  TPT2_OP :                    0EF72 C |
 TP_CHK1 :                     0DCF C |  TP_CHK2 :                     0DDE C |
 TP_CMD :                       3D1 C |  TP_MD_ON :                     3FB C |
 TP_MODE :                    0EF66 C |  TP_MSG_0 :                     40C C |
 TP_MSG_OFF :                   41B C |  TP_MSG_ON :                    416 C |
 TP_N1 :                        3E0 C |  TP_N2 :                        3EC C |
 TRACE_CMD :                    34F C |  TRACE_MSG :                   0E8A C |
*TRUE :                           1 - |  TWO_OPTBL :                    6B8 C |
 TWO_OPTBL_E :                  6CA C |  T_NO_KY :                     0E46 C |
 T_OP1 :                        44A C |  T_OP11 :                       444 C |
 T_OP_CHK :                     465 C |  UARTCR :                     0FF01 - |
 UARTDR :                     0FF00 - |  UPPER :                       0CB0 C |
 UP_BI :                        250 C |  U_0 :                         0F21 C |
 U_00 :                        0F1B C |  U_1 :                         0F25 C |
*VERSION :                     142F - |  WORK_B :                     0EF00 - |
 WSTART :                       124 C |  WS_CHK1 :                     0D48 C |
 WS_CHK2 :                     0D54 C |  WS_CHK3 :                     0D60 C |
 WS_CHK4 :                     0D6C C |  WS_CHK5 :                     0D78 C |

    491 symbols
     32 unused symbols

 AS V1.42 Beta [Bld 227] - Source File emuz80mon_RevB01.asm - Page 3 - 10/4/2022 8:52:20


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.04 seconds assembly time

   3660 lines source file
      2 passes
      0 errors
      0 warnings
